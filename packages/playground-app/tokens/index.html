<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Colores UBITS · Brand Colors</title>
    <link rel="stylesheet" href="../../tokens/dist/tokens.css" />
    <link rel="stylesheet" href="../../typography/fonts.css" />
    <link rel="stylesheet" href="../../typography/tokens-typography.css" />
    <link rel="stylesheet" href="../../../../template-ubits/fontawesome-icons.css" />
    <link rel="stylesheet" href="../../addons/sidebar/src/styles/sidebar.css" />
    <!-- Button Component CSS - COMPLETO INLINE (porque @import falla con file://) -->
    <style id="button-component-css">
      /* ========================================
         UBITS BUTTON COMPONENT
         Componente de botón con todas las variantes
         Usando tokens UBITS del nuevo playground
         ======================================== */

      /* BASE BUTTON STYLES */
      .ubits-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 16px;
        border: none;
        border-radius: 8px;
        font-family: var(--font-sans);
        font-weight: var(--weight-semibold);
        line-height: 1;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        user-select: none;
        white-space: nowrap;
        background: var(--ubits-button-primary-bg-default);
        color: var(--ubits-btn-primary-fg);
        border: 1px solid var(--ubits-button-primary-bg-default);
        height: 40px; /* Default MD size - will be overridden by size classes */
      }
      .ubits-button span {
        font-family: var(--font-sans);
        font-size: var(--font-body-md-size);
        font-weight: var(--weight-semibold);
        line-height: var(--font-body-md-line);
      }

      /* STATES */
      .ubits-button:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-hover);
        border-color: var(--ubits-button-primary-hover);
      }
      .ubits-button:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-pressed);
        border-color: var(--ubits-button-primary-pressed);
        transform: translateY(1px);
      }
      .ubits-button:focus-visible {
        outline: none;
        box-shadow: 0px 0px 0px 4px var(--ubits-button-focus-ring);
      }
      /* Disabled state - PERO NO cuando está en loading */
      .ubits-button:disabled:not(.ubits-button--loading),
      .ubits-button[aria-disabled="true"]:not(.ubits-button--loading) {
        background: var(--ubits-bg-disabled-button) !important;
        color: var(--ubits-fg-on-disabled-button) !important;
        border-color: var(--ubits-border-disabled-button) !important;
        cursor: not-allowed;
        pointer-events: none;
      }
      .ubits-button--primary:disabled:not(.ubits-button--loading),
      .ubits-button--secondary:disabled:not(.ubits-button--loading),
      .ubits-button--tertiary:disabled:not(.ubits-button--loading) {
        background: var(--ubits-bg-disabled-button) !important;
        color: var(--ubits-fg-on-disabled-button) !important;
        border-color: var(--ubits-border-disabled-button) !important;
        cursor: not-allowed;
        pointer-events: none;
      }
      
      /* Loading state - MANTENER estilos de variante */
      .ubits-button--primary.ubits-button--loading:disabled,
      .ubits-button--primary.ubits-button--loading[disabled] {
        background: var(--ubits-button-primary-bg-default) !important;
        color: var(--ubits-btn-primary-fg) !important;
        border-color: var(--ubits-button-primary-bg-default) !important;
      }
      .ubits-button--secondary.ubits-button--loading:disabled,
      .ubits-button--secondary.ubits-button--loading[disabled] {
        background: var(--ubits-btn-secondary-bg-default) !important;
        color: var(--ubits-btn-secondary-fg-default) !important;
        border-color: var(--ubits-btn-secondary-border) !important;
      }
      .ubits-button--tertiary.ubits-button--loading:disabled,
      .ubits-button--tertiary.ubits-button--loading[disabled] {
        background: transparent !important;
        color: var(--ubits-btn-tertiary-fg) !important;
        border-color: transparent !important;
      }
      .ubits-button:disabled:not(.ubits-button--loading)::before,
      .ubits-button[aria-disabled="true"]:not(.ubits-button--loading)::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border: 1px solid var(--ubits-border-disabled-button);
        border-radius: 8px;
        pointer-events: none;
      }

      /* LOADING STATE - Mantener todos los estilos del botón */
      .ubits-button--loading,
      .ubits-button[data-loading="true"] {
        cursor: wait !important;
        pointer-events: none;
        position: relative;
        /* NO cambiar opacity ni otros estilos - mantener apariencia completa */
        /* Los estilos de variante se mantienen con mayor especificidad */
      }

      /* Reducir opacidad del texto/icono original (mantener visible) */
      .ubits-button--loading .button-text,
      .ubits-button[data-loading="true"] .button-text {
        opacity: 0.6;
        transition: opacity 0.2s ease;
      }

      /* Ocultar iconos normales cuando hay spinner */
      .ubits-button--loading > i:not(.loading-spinner):not(.fa-spinner),
      .ubits-button[data-loading="true"] > i:not(.loading-spinner):not(.fa-spinner) {
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      /* Spinner de loading - visible y animado */
      .ubits-button--loading .loading-spinner,
      .ubits-button--loading .fa-spinner,
      .ubits-button[data-loading="true"] .loading-spinner,
      .ubits-button[data-loading="true"] .fa-spinner {
        animation: spin 1s linear infinite;
        opacity: 1 !important;
        display: inline-block;
        font-size: inherit;
      }

      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }

      /* VARIANTS */
      .ubits-button--primary {
        background: var(--ubits-button-primary-bg-default);
        color: var(--ubits-btn-primary-fg) !important;
        border: 1px solid var(--ubits-button-primary-bg-default);
      }
      /* Primary con loading - mantener estilos incluso cuando disabled */
      .ubits-button--primary.ubits-button--loading,
      .ubits-button--primary.ubits-button--loading:disabled,
      .ubits-button--primary.ubits-button--loading[disabled] {
        background: var(--ubits-button-primary-bg-default) !important;
        color: var(--ubits-btn-primary-fg) !important;
        border-color: var(--ubits-button-primary-bg-default) !important;
      }
      .ubits-button--primary:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-hover);
        border-color: var(--ubits-button-primary-hover);
      }
      .ubits-button--primary:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-pressed);
        border-color: var(--ubits-button-primary-pressed);
        transform: translateY(1px);
      }
      .ubits-button--active {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand);
        border: 1px solid var(--ubits-accent-brand);
      }
      .ubits-button--active:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand);
        border-color: var(--ubits-accent-brand);
      }
      .ubits-button--active:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand);
        border-color: var(--ubits-accent-brand);
      }
      .ubits-button--secondary {
        background: var(--ubits-btn-secondary-bg-default);
        color: var(--ubits-btn-secondary-fg-default);
        border: 1px solid var(--ubits-btn-secondary-border);
      }
      /* Secondary con loading - mantener estilos incluso cuando disabled */
      .ubits-button--secondary.ubits-button--loading,
      .ubits-button--secondary.ubits-button--loading:disabled,
      .ubits-button--secondary.ubits-button--loading[disabled] {
        background: var(--ubits-btn-secondary-bg-default) !important;
        color: var(--ubits-btn-secondary-fg-default) !important;
        border-color: var(--ubits-btn-secondary-border) !important;
      }
      .ubits-button--secondary:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-secondary-bg-hover);
        color: var(--ubits-btn-secondary-fg-default);
        border-color: var(--ubits-btn-secondary-border);
      }
      .ubits-button--secondary:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-secondary-bg-pressed);
        color: var(--ubits-btn-secondary-fg-default);
        border-color: var(--ubits-btn-secondary-border);
        transform: translateY(1px);
      }
      .ubits-button--secondary.ubits-button--active {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand);
        border: none;
      }
      .ubits-button--secondary.ubits-button--active:hover:not(:disabled):not(.ubits-button--loading),
      .ubits-button--secondary.ubits-button--active:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand);
        border: none;
      }
      .ubits-button--tertiary {
        background: transparent;
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
      }
      /* Tertiary con loading - mantener estilos incluso cuando disabled */
      .ubits-button--tertiary.ubits-button--loading,
      .ubits-button--tertiary.ubits-button--loading:disabled,
      .ubits-button--tertiary.ubits-button--loading[disabled] {
        background: transparent !important;
        color: var(--ubits-btn-tertiary-fg) !important;
        border-color: transparent !important;
      }
      .ubits-button--tertiary:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-tertiary-bg-hover);
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
      }
      .ubits-button--tertiary:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-tertiary-bg-pressed);
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
        transform: translateY(1px);
      }
      .ubits-button--tertiary.ubits-button--active {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand);
        border: 1px solid transparent;
      }
      .ubits-button--tertiary.ubits-button--active:hover:not(:disabled):not(.ubits-button--loading),
      .ubits-button--tertiary.ubits-button--active:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand);
        border: 1px solid transparent;
      }
      .ubits-button--tertiary:focus-visible {
        background: transparent;
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
        outline: none;
        box-shadow: 0px 0px 0px 4px var(--ubits-button-focus-ring);
      }

      /* SIZES */
      .ubits-button--xs {
        padding: 8px 12px !important;
        height: 28px !important;
        gap: 6px !important;
        min-height: 28px !important;
      }
      .ubits-button--xs span,
      .ubits-button.ubits-button--xs span {
        font-family: var(--font-sans) !important;
        font-size: var(--font-body-xs-size) !important;
        font-weight: var(--weight-semibold) !important;
        line-height: var(--font-body-xs-line) !important;
      }
      .ubits-button--xs.ubits-button--icon-only {
        padding: 8px !important;
        width: 28px !important;
        height: 28px !important;
        min-width: 28px !important;
        min-height: 28px !important;
      }
      .ubits-button--xs i,
      .ubits-button.ubits-button--xs i {
        font-size: 12px !important;
      }
      .ubits-button--sm {
        padding: 10px 14px !important;
        height: 32px !important;
        gap: 6px !important;
        min-height: 32px !important;
      }
      .ubits-button--sm span,
      .ubits-button.ubits-button--sm span {
        font-family: var(--font-sans) !important;
        font-size: var(--font-body-sm-size) !important;
        font-weight: var(--weight-semibold) !important;
        line-height: var(--font-body-sm-line) !important;
      }
      .ubits-button--sm.ubits-button--icon-only {
        padding: 10px !important;
        width: 32px !important;
        height: 32px !important;
        min-width: 32px !important;
        min-height: 32px !important;
      }
      .ubits-button--sm i,
      .ubits-button.ubits-button--sm i {
        font-size: 14px !important;
      }
      .ubits-button--md,
      .ubits-button {
        padding: 12px 16px;
        height: 40px;
        gap: 8px;
      }
      .ubits-button--md span,
      .ubits-button span {
        font-family: var(--font-sans);
        font-size: var(--font-body-md-size);
        font-weight: var(--weight-semibold);
        line-height: var(--font-body-md-line);
      }
      .ubits-button--md.ubits-button--icon-only,
      .ubits-button.ubits-button--icon-only {
        padding: 12px;
        width: 40px;
        height: 40px;
        min-width: 40px;
        min-height: 40px;
      }
      .ubits-button--md i,
      .ubits-button i {
        font-size: 16px;
      }
      .ubits-button--lg {
        padding: 14px 20px !important;
        height: 48px !important;
        gap: 10px !important;
        min-height: 48px !important;
      }
      .ubits-button--lg span {
        font-family: var(--font-sans);
        font-size: var(--font-body-lg-size);
        font-weight: var(--weight-semibold);
        line-height: var(--font-body-lg-line);
      }
      .ubits-button--lg.ubits-button--icon-only {
        padding: 14px 16px;
        width: 48px;
        height: 48px;
      }
      .ubits-button--lg i {
        font-size: 18px;
      }
      .ubits-button--xl {
        padding: 16px 24px;
        height: 56px;
        gap: 10px;
      }
      .ubits-button--xl span {
        font-family: var(--font-sans);
        font-size: 22px;
        font-weight: var(--weight-semibold);
        line-height: 33px;
      }
      .ubits-button--xl.ubits-button--icon-only {
        padding: 16px 20px;
        width: 56px;
        height: 56px;
      }
      .ubits-button--xl i {
        font-size: 20px;
      }

      /* BADGE */
      .ubits-button__badge {
        position: absolute;
        top: -2px;
        right: -3px;
        width: 10px;
        height: 10px;
        background: var(--ubits-button-badge);
        border-radius: 50%;
      }
      .ubits-button--icon-only .ubits-button__badge {
        top: -2px;
        right: -2px;
      }

      /* ICON ONLY */
      .ubits-button--icon-only {
        padding: 12px;
        min-width: 40px;
        min-height: 40px;
      }

      /* MODIFIERS */
      .ubits-button--full-width {
        width: 100%;
        display: flex;
      }
      .ubits-button--block {
        display: flex;
        width: 100%;
      }
      .ubits-button--icon-right {
        flex-direction: row-reverse;
      }

      /* PREVIEW CONTROL BUTTONS */
      .preview-control-btn.active {
        background: var(--ubits-accent-brand) !important;
        color: white !important;
        border-color: var(--ubits-accent-brand) !important;
      }
      .preview-control-btn.active span {
        color: white !important;
      }
    </style>
    <!-- Badge Component CSS -->
    <link rel="stylesheet" href="../../addons/badge/src/styles/badge.css" />
    <link rel="stylesheet" href="../../addons/alert/src/styles/alert.css" />
    <link rel="stylesheet" href="../../addons/toast/src/styles/toast.css" />
    <link rel="stylesheet" href="../../addons/input/src/styles/input.css" />
    <link rel="stylesheet" href="../../addons/list/src/styles/list.css" />
    <style>
      /* Asegurar que FontAwesome se cargue correctamente */
      /* Si las fuentes no cargan, las clases .fa-*::before mostrarán el contenido unicode */
      .fa, .far, .fas, i[class*="fa-"] {
        font-family: 'Font Awesome 6 Pro', var(--fa-style-family, 'Font Awesome 6 Pro');
        font-style: normal;
        font-weight: 400;
        display: inline-block;
        line-height: 1;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
      }
      .fas, i[class*="fas"] {
        font-weight: 900;
      }
      /* Fallback: Si las fuentes no cargan, mostrar unicode directamente */
      /* Estos códigos vienen del CSS de FontAwesome */
      .fa-plus::before { content: '\2b'; }
      .fa-check::before { content: '\f00c'; }
      .fa-trash::before { content: '\f1f8'; }
      .fa-edit::before { content: '\f044'; }
      .fa-user::before { content: '\f007'; }
      .fa-globe::before { content: '\f0ac'; }
      .fa-print::before { content: '\f02f'; }
      .fa-bars::before { content: '\f0c9'; }
      .fa-truck::before { content: '\f0d1'; }
      .fa-ghost::before { content: '\f6e2'; }
    </style>
    <style>
      body{font-family:ui-sans-serif, system-ui, -apple-system; margin:16px; background:#ffffff; color:#1a1a1a}
      /* Layout centrado */
      #sections-host{ max-width: 1120px; margin: 0 auto; padding: 12px 8px }
      .container{ max-width: 1120px; margin: 0 auto; width: 100%; padding: 0 8px }
      h1{margin:0 0 8px 0}
      .subtitle{margin:0 0 24px 0; color:#555}
      .columns{display:grid; grid-template-columns: 1fr 1fr; gap:16px}
      .columns + .columns{margin-top:24px}
      .panel{border:1px solid #e5e7eb; border-radius:10px; padding:16px}
      .panel.dark{background:#0E1825; color:#edeeef; border-color:#0E1825}
      .section-title{font-weight:700; margin:0 0 12px 0}
      .grid{display:grid; grid-template-columns: 240px 1fr; gap:8px; align-items:center}
      .row{display:contents}
      .token-name{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
      .swatch{height:28px; border:1px solid #ddd; border-radius:6px; margin-bottom:4px}
      code{font-size:12px; color:inherit; opacity:.85}
      .copyable{cursor:pointer}
      .copied{outline:2px solid #86efac; outline-offset:2px}
      .icon-card.copyable:hover{
        border-color: var(--ubits-accent-brand) !important;
        background: var(--ubits-bg-active) !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      .letter-section{
        margin-bottom: 32px;
      }
      .letter-grid{
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
      }
      .toast{position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
        background:#111827; color:#fff; padding:10px 14px; border-radius:8px;
        box-shadow:0 10px 15px rgba(0,0,0,.15); font-size:12px; opacity:0; pointer-events:none;
        transition:opacity .2s ease, transform .2s ease}
      .toast.show{opacity:1; transform:translateX(-50%) translateY(-4px)}
      .navbar{display:flex; gap:20px; align-items:center; padding:10px 0; border-bottom:1px solid #e5e7eb; position:sticky; top:0; background:#fff; z-index:20}
      .nav-link{display:inline-flex; align-items:center; gap:8px; padding:8px 2px; color:#6b7280; text-decoration:none; font-weight:600; line-height:1; border-bottom:2px solid transparent}
      .nav-link:hover{color:#111827}
      .nav-link.active{color:#2563eb; border-bottom-color:#2563eb}
      .tabs-wrap{position:sticky; top:0; z-index:20; margin-bottom:12px; background:#fff}
      .layout-colors{display:flex; gap:16px; align-items:flex-start}
      .sidebar{width:320px}
      .sidebox{position:sticky; top:56px; border:1px solid var(--ubits-border-1); border-radius:12px; padding:8px; background:var(--ubits-bg-1)}
      .side-title{font-size:12px; color:var(--ubits-fg-1-medium); padding:8px 10px; font-weight:600; text-transform:uppercase; letter-spacing:0.5px}
      .side{display:flex; flex-direction:column; gap:6px; max-height:calc(100vh - 140px); overflow-y:auto; padding-right:4px}
      .side-link{padding:8px 10px; border-radius:8px; color:var(--ubits-fg-1-medium); text-decoration:none; font-weight:500; white-space:nowrap; transition:background 0.2s ease, color 0.2s ease}
      .side-link:hover{background:var(--ubits-bg-2); color:var(--ubits-fg-1-high)}
      .side-link.active{background:var(--ubits-bg-2); color:var(--ubits-accent-brand); font-weight:600}
      .content{flex:1; display:block; width:100%; margin:0; padding:0}
      #section-colores .columns{width:100%}
      #section-colores .cat-section{margin:0; padding:0}
      #section-colores .cat-section > .columns{margin-top:0}
      .section{display:none}
      .section.active{display:block}
      .kcard{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px}
      .kstack{display:grid;gap:12px}
      .searchbar{margin:8px 0 16px; display:flex; justify-content:flex-end}
      .searchbar input{width:360px; padding:10px 12px; border:1px solid #e5e7eb; border-radius:8px}
      /* Tipografía vive en #section-texto */
      /* Nuevo menú (usa tokens) */
      #navbar2{ background: var(--ubits-bg-1); border-bottom:1px solid var(--ubits-border-1) }
      #navbar2 .nav2-link{ color: var(--ubits-fg-1-medium); text-decoration:none; padding:10px 4px; border-bottom:2px solid transparent; transition:color .15s ease }
      #navbar2 .nav2-link:hover{ color: var(--ubits-fg-2-high); }
      #navbar2 .nav2-link.active2{ color: var(--ubits-accent-brand); border-bottom-color: var(--ubits-accent-brand) }
      /* Unificar ancho en la sección Colores para evitar cambios de tamaño al navegar */
      #section-colores > h1,
      #section-colores > p.subtitle,
      #section-colores > .searchbar,
      #section-colores > .layout-colors,
      #section-iconos > h1,
      #section-iconos > p.subtitle,
      #section-iconos > .searchbar,
      #section-iconos > div[style*="display: flex"],
      #section-componentes > h1,
      #section-componentes > p.subtitle,
      #section-componentes > div[style*="display: flex"]{ max-width:1120px; margin-left:auto; margin-right:auto; padding-left:8px; padding-right:8px }
    </style>
  </head>
  <body>
    <!-- Nuevo menú interno, independiente del menú anterior -->
    <nav id="navbar2" style="display:block; position:sticky; top:0; z-index:30">
      <div class="container" style="display:flex; gap:20px; align-items:center; padding:10px 0">
        <a href="#" class="nav2-link" data-target="section-template">Template</a>
        <a href="#" class="nav2-link" data-target="section-colores">Colores</a>
        <a href="#" class="nav2-link" data-target="section-texto">Tipografía</a>
        <a href="#" class="nav2-link" data-target="section-iconos">Iconos</a>
        <a href="#" class="nav2-link" data-target="section-componentes">Componentes</a>
      </div>
    </nav>
    <main id="sections-host" style="position:relative; z-index:1"></main>
    <div class="tabs-wrap" style="display:none">
      <nav class="navbar" aria-label="Navegación principal">
        <a class="nav-link" href="#template" data-tab="template">Template</a>
        <a class="nav-link active" href="#colores" data-tab="colores">Colores</a>
        <a class="nav-link" href="typo.html" data-tab="texto">Tipografía</a>
        <a class="nav-link" href="#iconos" data-tab="iconos">Iconos</a>
        <a class="nav-link" href="#componentes" data-tab="componentes">Componentes</a>
        <a class="nav-link" href="#guia" data-tab="guia">Guía de prompts</a>
      </nav>
    </div>
    
    <div id="section-template" class="section">
      <h1>Template · Arquitectura</h1>
      <div class="kstack">
        <div class="kcard">
          <h3>Monorepo (pnpm workspaces)</h3>
          <ul>
            <li><code>packages/tokens</code>: tokens y build (Style Dictionary)</li>
            <li><code>packages/ui</code>: componentes (Web Components/Vue SFC)</li>
            <li><code>packages/core</code>: runtime, event bus, AppContext</li>
            <li><code>packages/addons</code>: plugins desacoplados</li>
            <li><code>packages/playground-app</code>: shell de demo</li>
            <li><code>docs-site</code>: Storybook + VitePress</li>
          </ul>
        </div>
        <div class="kcard">
          <h3>Tecnologías</h3>
          <ul>
            <li>TypeScript, Vite</li>
            <li>Biome (lint + format + typecheck)</li>
            <li>Style Dictionary (fuente única <code>tokens.json</code>)</li>
            <li>Storybook, Playwright (tests E2E/componente)</li>
          </ul>
        </div>
        <div class="kcard">
          <h3>Funcionamiento</h3>
          <ul>
            <li>CSS variables por tema: <code>:root</code> y <code>[data-theme="dark"]</code></li>
            <li>Loader de plugins por manifiesto y dynamic import</li>
            <li>Event bus namespaced para comunicación entre add-ons</li>
          </ul>
        </div>
        <div class="kcard">
          <h3>Flujo de trabajo</h3>
          <ul>
            <li>Conventional Commits + ramas por feature</li>
            <li>CI/CD con checks (lint, build, tests)</li>
            <li>Previews automáticas (Netlify/Vercel) opcional</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="section-colores" class="section active">
      <h1>Colores UBITS</h1>
      <p class="subtitle">Explora los tokens por categoría (menú lateral) y en Light/Dark.</p>
      <div class="searchbar">
        <input id="tokens-search" type="search" placeholder="Buscar por nombre o valor (hex/rgba)" aria-label="Buscar tokens" />
      </div>
      <div class="layout-colors">
        <aside class="sidebar">
          <div class="sidebox">
            <div class="side-title">Categorías</div>
            <nav class="side" role="tablist" aria-label="Categorías de colores">
              <a class="side-link active" href="#colores/brand" data-cat="brand" role="tab">Brand</a>
              <a class="side-link" href="#colores/button" data-cat="button" role="tab">Button</a>
              <a class="side-link" href="#colores/foreground" data-cat="foreground" role="tab">Foreground</a>
              <a class="side-link" href="#colores/blue" data-cat="blue" role="tab">Blue Foregrounds</a>
              <a class="side-link" href="#colores/gray" data-cat="gray" role="tab">Gray Foregrounds</a>
              <a class="side-link" href="#colores/green" data-cat="green" role="tab">Green Foregrounds</a>
              <a class="side-link" href="#colores/teal" data-cat="teal" role="tab">Teal Foregrounds</a>
              <a class="side-link" href="#colores/purple" data-cat="purple" role="tab">Purple Foregrounds</a>
              <a class="side-link" href="#colores/yellow" data-cat="yellow" role="tab">Yellow Foregrounds</a>
              <a class="side-link" href="#colores/background" data-cat="background" role="tab">Background Colors</a>
              <a class="side-link" href="#colores/borders-main" data-cat="borders-main" role="tab">Border Colors - Main</a>
              <a class="side-link" href="#colores/borders-colored" data-cat="borders-colored" role="tab">Border Colors - Colored</a>
              <a class="side-link" href="#colores/borders-inverted" data-cat="borders-inverted" role="tab">Border Colors - Inverted</a>
              <a class="side-link" href="#colores/borders-static" data-cat="borders-static" role="tab">Border Colors - Static</a>
              <a class="side-link" href="#colores/borders-static-inverted" data-cat="borders-static-inverted" role="tab">Border Colors - Static Inverted</a>
              <a class="side-link" href="#colores/sidebar" data-cat="sidebar" role="tab">Sidebar Colors</a>
              <a class="side-link" href="#colores/feedback-success" data-cat="feedback-success" role="tab">Feedback · Success</a>
              <a class="side-link" href="#colores/feedback-info" data-cat="feedback-info" role="tab">Feedback · Info</a>
              <a class="side-link" href="#colores/feedback-warning" data-cat="feedback-warning" role="tab">Feedback · Warning</a>
              <a class="side-link" href="#colores/feedback-error" data-cat="feedback-error" role="tab">Feedback · Error</a>
              <a class="side-link" href="#colores/feedback-borders" data-cat="feedback-borders" role="tab">Feedback · Borders</a>
              <a class="side-link" href="#colores/chart" data-cat="chart" role="tab">Chart Colors</a>
              <a class="side-link" href="#colores/toast" data-cat="toast" role="tab">Toast Colors</a>
              <a class="side-link" href="#colores/bottom-nav" data-cat="bottom-nav" role="tab">Bottom Nav Colors</a>
              <a class="side-link" href="#colores/pink" data-cat="pink" role="tab">Pink Foregrounds</a>
              <a class="side-link" href="#colores/rose" data-cat="rose" role="tab">Rose Foregrounds</a>
            </nav>
          </div>
        </aside>
        <div class="content">
    
      <div id="cat-brand" class="cat-section">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE · BRAND COLORS</div>
          <div class="grid" id="grid-light">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE · BRAND COLORS</div>
          <div class="grid" id="grid-dark">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        </div>
      </div>

      <div id="cat-background" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · BACKGROUND COLORS</div>
            <div class="grid" id="grid-light-bg">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · BACKGROUND COLORS</div>
            <div class="grid" id="grid-dark-bg">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>
      <div id="cat-button" class="cat-section" style="display:none">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE · BUTTON COLORS</div>
          <div class="grid" id="grid-light-button">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE · BUTTON COLORS</div>
          <div class="grid" id="grid-dark-button">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
      </div>
      </div>

      <div id="cat-foreground" class="cat-section" style="display:none">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE · FOREGROUND COLORS</div>
          <div class="grid" id="grid-light-fg">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE · FOREGROUND COLORS</div>
          <div class="grid" id="grid-dark-fg">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
      </div>
      </div>
      <div id="cat-blue" class="cat-section" style="display:none">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE · BLUE FOREGROUNDS</div>
          <div class="grid" id="grid-light-fg-blue">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE · BLUE FOREGROUNDS</div>
          <div class="grid" id="grid-dark-fg-blue">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
      </div>
      </div>

      <div id="cat-gray" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · GRAY FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-gray">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · GRAY FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-gray">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-yellow" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · YELLOW FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-yellow">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · YELLOW FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-yellow">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-green" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · GREEN FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-green">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · GREEN FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-green">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-teal" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · TEAL FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-teal">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · TEAL FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-teal">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-purple" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · PURPLE FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-purple">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · PURPLE FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-purple">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-pink" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · PINK FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-pink">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · PINK FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-pink">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-rose" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · ROSE FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-rose">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · ROSE FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-rose">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-main" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · BORDER COLORS - MAIN</div>
            <div class="grid" id="grid-light-border-main">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · BORDER COLORS - MAIN</div>
            <div class="grid" id="grid-dark-border-main">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-colored" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · BORDER COLORS - COLORED</div>
            <div class="grid" id="grid-light-border-colored">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · BORDER COLORS - COLORED</div>
            <div class="grid" id="grid-dark-border-colored">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-inverted" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · BORDER COLORS - INVERTED</div>
            <div class="grid" id="grid-light-border-inverted">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · BORDER COLORS - INVERTED</div>
            <div class="grid" id="grid-dark-border-inverted">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-static" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · BORDER COLORS - STATIC</div>
            <div class="grid" id="grid-light-border-static">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · BORDER COLORS - STATIC</div>
            <div class="grid" id="grid-dark-border-static">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-static-inverted" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · BORDER COLORS - STATIC INVERTED</div>
            <div class="grid" id="grid-light-border-static-inv">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · BORDER COLORS - STATIC INVERTED</div>
            <div class="grid" id="grid-dark-border-static-inv">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-sidebar" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · SIDEBAR COLORS</div>
            <div class="grid" id="grid-light-sidebar">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · SIDEBAR COLORS</div>
            <div class="grid" id="grid-dark-sidebar">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-success" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · FEEDBACK SUCCESS</div>
            <div class="grid" id="grid-light-feedback-success">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · FEEDBACK SUCCESS</div>
            <div class="grid" id="grid-dark-feedback-success">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-info" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · FEEDBACK INFO</div>
            <div class="grid" id="grid-light-feedback-info">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · FEEDBACK INFO</div>
            <div class="grid" id="grid-dark-feedback-info">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-warning" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · FEEDBACK WARNING</div>
            <div class="grid" id="grid-light-feedback-warning">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · FEEDBACK WARNING</div>
            <div class="grid" id="grid-dark-feedback-warning">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-error" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · FEEDBACK ERROR</div>
            <div class="grid" id="grid-light-feedback-error">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · FEEDBACK ERROR</div>
            <div class="grid" id="grid-dark-feedback-error">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-borders" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · FEEDBACK BORDERS</div>
            <div class="grid" id="grid-light-feedback-borders">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · FEEDBACK BORDERS</div>
            <div class="grid" id="grid-dark-feedback-borders">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-chart" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · CHART COLORS</div>
            <div class="grid" id="grid-light-chart">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · CHART COLORS</div>
            <div class="grid" id="grid-dark-chart">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-toast" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · TOAST COLORS</div>
            <div class="grid" id="grid-light-toast">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · TOAST COLORS</div>
            <div class="grid" id="grid-dark-toast">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-bottom-nav" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE · BOTTOM NAV COLORS</div>
            <div class="grid" id="grid-light-bottom-nav">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE · BOTTOM NAV COLORS</div>
            <div class="grid" id="grid-dark-bottom-nav">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>

    <div id="section-tipografia" class="section" style="display:none">
      <h1>Tipografía UBITS</h1>
      <p class="subtitle">Escala alineada al playground anterior. Haz clic para copiar variables o CSS.</p>
      <div class="kstack">
        <div class="kcard">
          <h3>Display</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D1</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:700">Display 1 · 48 / 57.6</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D2</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:700">Display 2 · 40 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D3</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:700">Display 3 · 32 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D4</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:700">Display 4 · 28 / 42</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Headings</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H1 · Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:600">Heading 1 · 20 / 30</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H2 · Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:600">Heading 2 · 18 / 27</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Body</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>Body LG · 600</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:600">Cuerpo grande · 20 / 30 · Semibold</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body MD · 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:400">Cuerpo mediano · 16 / 24 · Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body SM · 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:400">Cuerpo pequeño · 13 / 19.5 · Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body XS · 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:400">Cuerpo extra pequeño · 11 / 16.5 · Regular</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Notas</h3>
          <ul>
            <li>Familia por defecto: <code>var(--font-sans)</code></li>
            <li>Pesos: <code>--weight-regular</code>, <code>--weight-semibold</code>, <code>--weight-bold</code></li>
            <li>Click en una fila copia una regla CSS con variables.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="section-texto" class="section" style="display:block">
      <h1>Tipografía UBITS</h1>
      <p class="subtitle">Escala alineada al playground anterior. Haz clic para copiar variables o CSS.</p>
      <div class="kstack">
        <div class="kcard">
          <h3>Display</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D1</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:700">Display 1 · 48 / 57.6</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D2</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:700">Display 2 · 40 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D3</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:700">Display 3 · 32 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D4</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:700">Display 4 · 28 / 42</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Headings</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H1 · Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:600">Heading 1 · 20 / 30</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H2 · Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:600">Heading 2 · 18 / 27</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Body</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>Body LG · 600</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:600">Cuerpo grande · 20 / 30 · Semibold</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body MD · 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:400">Cuerpo mediano · 16 / 24 · Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body SM · 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:400">Cuerpo pequeño · 13 / 19.5 · Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body XS · 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:400">Cuerpo extra pequeño · 11 / 16.5 · Regular</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Notas</h3>
          <ul>
            <li>Familia por defecto: <code>var(--font-sans)</code></li>
            <li>Pesos: <code>--weight-regular</code>, <code>--weight-semibold</code>, <code>--weight-bold</code></li>
            <li>Click en una fila copia una regla CSS con variables.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="section-iconos" class="section" style="display:none">
      <h1>Iconos UBITS</h1>
      <p class="subtitle">Explora los iconos FontAwesome disponibles. Busca, filtra por letra y haz clic para copiar el código.</p>
      
      <!-- Barra de búsqueda -->
      <div class="searchbar" style="margin-bottom: 20px;">
        <div style="position: relative; width: 100%; max-width: 500px;">
          <i class="far fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none;"></i>
          <input id="icons-search-input" type="search" placeholder="Buscar iconos por nombre..." style="width: 100%; padding: 10px 12px 10px 36px; border: 1px solid var(--ubits-border-1); border-radius: 8px; font-size: 14px;" aria-label="Buscar iconos" />
          <button id="icons-clear-search" style="display: none; position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--ubits-fg-1-medium); cursor: pointer; padding: 4px;">
            <i class="far fa-times"></i>
          </button>
        </div>
        <div id="icons-count" style="margin-left: 16px; color: var(--ubits-fg-1-medium); font-size: 14px; align-self: center;">Cargando...</div>
      </div>

      <div style="display: flex; gap: 20px; align-items: flex-start;">
        <!-- Sidebar de navegación por categorías -->
        <aside class="sidebar" style="width: 280px; flex-shrink: 0;">
          <div class="sidebox">
            <div class="side-title">Categorías</div>
            <nav class="side" id="icons-category-nav" role="tablist" aria-label="Navegación por categorías de iconos">
              <!-- Se generará dinámicamente -->
            </nav>
          </div>
        </aside>

        <!-- Contenedor principal de iconos -->
        <div style="flex: 1; min-width: 0;">
          <div id="icons-empty-state" style="display: none; text-align: center; padding: 60px 20px;">
            <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;">
              <i class="far fa-search"></i>
            </div>
            <h3 style="color: var(--ubits-fg-1-high); margin-bottom: 8px;">Sin resultados</h3>
            <p style="color: var(--ubits-fg-1-medium);">Intenta con otro término de búsqueda.</p>
          </div>
          <div id="icons-container" class="kstack">
            <!-- Los iconos se cargarán aquí dinámicamente -->
          </div>
        </div>
      </div>
      
      <div class="kstack" style="margin-top: 24px;">
        <div class="kcard">
          <h3>Uso</h3>
          <ul>
            <li>Estos iconos provienen de <strong>FontAwesome Pro 6.1.1</strong></li>
            <li>Usa la clase <code>far</code> para estilo regular (outline)</li>
            <li>Usa la clase <code>fas</code> para estilo solid (filled)</li>
            <li>Haz clic en cualquier icono para copiar el código HTML</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- SECCIÓN COMPONENTES -->
    <div id="section-componentes" class="section" style="display:none">
      <h1>Componentes UBITS</h1>
      <p class="subtitle">Inventario completo de todos los componentes disponibles en el playground anterior</p>

      <div style="display: flex; gap: 20px; align-items: flex-start; margin-top: 24px;">
        <!-- Sidebar de navegación de componentes -->
        <aside class="sidebar" style="width: 280px; flex-shrink: 0;">
          <div class="sidebox">
            <div class="side-title">Componentes</div>
            <nav class="side" id="components-nav" role="navigation" aria-label="Navegación de componentes">
              <!-- Se generará dinámicamente -->
            </nav>
          </div>
        </aside>

        <!-- Contenedor principal de componentes -->
        <div style="flex: 1; min-width: 0;">
          <div id="components-container" class="kstack">
            <!-- Los componentes se cargarán aquí dinámicamente -->
          </div>
        </div>
      </div>
    </div>

    <div id="toast" class="toast" aria-live="polite" aria-atomic="true"></div>

    <script>
      // Asegurar que las secciones vivan dentro de #sections-host para evitar colapsos
      (function ensureHost(){
        const host = document.getElementById('sections-host') || (function(){
          const m = document.createElement('main');
          m.id = 'sections-host';
          m.style.position = 'relative';
          m.style.zIndex = '1';
          document.body.insertBefore(m, document.querySelector('.tabs-wrap'));
          return m;
        })();
        ['section-template','section-colores','section-texto','section-iconos','section-componentes'].forEach(id=>{
          const el = document.getElementById(id);
          if (el && el.parentElement !== host) host.appendChild(el);
        });
      })();

      const root = document.documentElement;
      const html = document.documentElement;

      const TOKENS = [
        '--ubits-accent-brand',
        '--ubits-accent-brand-inverted',
        '--ubits-accent-brand-static',
        '--ubits-accent-brand-static-inverted',
        '--ubits-logo',
        '--ubits-logo-inverted',
        '--ubits-logo-static',
        '--ubits-logo-static-inverted'
      ];

      function showToast(message){
        const el = document.getElementById('toast');
        if(!el) return;
        el.textContent = message;
        el.classList.add('show');
        clearTimeout(showToast._t);
        showToast._t = setTimeout(()=> el.classList.remove('show'), 1200);
      }

      // Tabs por hash (#template, #colores)
      function activateTab(tab){
        const tabs = document.querySelectorAll('.nav-link');
        tabs.forEach(t => t.classList.toggle('active', t.getAttribute('data-tab')===tab));
        const sections = document.querySelectorAll('.section');
        sections.forEach(s => { s.classList.remove('active'); s.style.display = 'none'; });
        const section = document.getElementById(`section-${tab}`);
        if(section) {
          section.classList.add('active');
          section.style.display = '';
          console.log('[tabs] activateTab ->', tab, 'section found:', section.id);
        } else {
          console.warn('[tabs] activateTab -> section not found for tab:', tab);
        }
      }

      function syncFromHash(){
        const raw = (location.hash||'#colores').replace('#','');
        const parts = raw.split('/');
        const tab = parts[0];
        const sub = parts[1];
        console.log('[hash] raw:', raw, 'tab:', tab, 'sub:', sub);
        activateTab(tab);
        if(tab==='colores') activateSubtab(sub||'brand');
        debugLayout(sub||'brand');
        if (tab === 'colores') {
          // aplicar filtro tras activar la categoría
          if (typeof applySearchFilter === 'function') {
            applySearchFilter();
          }
        } else if (tab === 'tipografia') {
          const tipSec = document.getElementById('section-tipografia');
            console.log('[hash] tipografia visible?', !!tipSec, 'display:', tipSec?.style.display, 'classList:', tipSec?.className);
            if (tipSec) {
              // Evitar que reglas .section afecten
              if (tipSec.classList.contains('section')) {
                tipSec.classList.remove('section');
              }
              // Asegurar jerarquía visible
              document.documentElement.style.minHeight = '100%';
              document.body.style.minHeight = '100%';
              document.body.style.display = 'block';
              tipSec.style.display = 'block';
              tipSec.classList.add('active');
              tipSec.style.outline = '2px dashed #f59e0b';
              tipSec.style.minHeight = '400px';
              const cs = window.getComputedStyle(tipSec);
              const rect = tipSec.getBoundingClientRect();
              console.log('[hash] tipografia size:', tipSec.offsetWidth, tipSec.offsetHeight, 'rect:', rect.width, rect.height, 'cs.display:', cs.display, 'children:', tipSec.children.length);
              // Pintar el header para verificar render
              const h1 = tipSec.querySelector('h1');
              if (h1) { h1.style.background = '#fde68a'; h1.style.padding = '8px'; }
              console.log('[hash] tipografia innerHTML length:', tipSec.innerHTML.length);
              setTimeout(()=>{ if(tipSec) tipSec.style.outline = ''; }, 800);
              // Traer a vista
              tipSec.scrollIntoView({ behavior:'auto', block:'start' });
            }
        } else if (tab === 'texto') {
          const textSec = document.getElementById('section-texto');
          if (textSec) {
            textSec.style.display = 'block';
            textSec.classList.add('active');
            console.log('[hash] texto size:', textSec.offsetWidth, textSec.offsetHeight, 'children:', textSec.children.length);
          }
        }
      }

      // Desactivamos hashchange para evitar que sobreescriba el menú nuevo
      // window.addEventListener('hashchange', syncFromHash);

      // Subtabs (categorías dentro de Colores)
      function activateSubtab(cat){
        const subTabs = document.querySelectorAll('.side-link');
        subTabs.forEach(t=> t.classList.toggle('active', t.getAttribute('data-cat')===cat));
        document.querySelectorAll('#section-colores .cat-section').forEach(s=> s.style.display='none');
        const el = document.getElementById(`cat-${cat}`);
        if(el) el.style.display = '';
        // sincronizar hash
        const base = 'colores';
        history.replaceState(null,'',`#${base}/${cat}`);
        debugLayout(cat);
        if (typeof applySearchFilter === 'function') {
          applySearchFilter();
        }
      }

      // Buscador de tokens por nombre o valor en la categoría activa
      function applySearchFilter(){
        const input = document.getElementById('tokens-search');
        const q = (input && input.value ? input.value : '').trim().toLowerCase();
        const sectionColores = document.getElementById('section-colores');
        if(!sectionColores) return;
        // detectar sección activa visible (sin display:none)
        const activeSection = Array.from(sectionColores.querySelectorAll('.cat-section')).find(s => s.style.display === '' || s.style.display === 'block' || (!s.hasAttribute('style')));
        if(!activeSection) return;
        const grids = activeSection.querySelectorAll('.grid');
        grids.forEach(grid => {
          const children = Array.from(grid.children);
          for(let i=0;i<children.length;i+=2){
            const nameEl = children[i];
            const valEl = children[i+1];
            if(!nameEl || !valEl) continue;
            const txt = (nameEl.textContent + ' ' + valEl.textContent).toLowerCase();
            const match = q === '' || txt.includes(q);
            nameEl.style.display = match ? '' : 'none';
            valEl.style.display = match ? '' : 'none';
          }
        });
      }

      (function initSearch(){
        const input = document.getElementById('tokens-search');
        if(input){
          input.addEventListener('input', applySearchFilter);
        }
        // Nuevo menú controlador simple
        const nav2 = document.getElementById('navbar2');
        if (nav2) {
          nav2.addEventListener('click', (e)=>{
            const a = e.target instanceof Element ? e.target.closest('a[data-target]') : null;
            if(!a) return;
            e.preventDefault();
            const targetId = a.getAttribute('data-target');
            const all = Array.from(document.querySelectorAll('#section-template, #section-colores, #section-texto, #section-iconos, #section-componentes'));
            all.forEach(x=> x && (x.style.display = (x.id===targetId)? 'block' : 'none'));
            // estado visual activo (sin scroll automático para evitar saltos)
            document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
            const link = document.querySelector(`#navbar2 .nav2-link[data-target="${targetId}"]`);
            if (link) link.classList.add('active2');
            console.log('[nav2] switch ->', targetId,
              'states:', all.map(x=> x.id+':'+getComputedStyle(x).display).join(', ')
            );
          });
          // Mostrar Tipografía por defecto
          const all = Array.from(document.querySelectorAll('#section-template, #section-colores, #section-texto, #section-iconos, #section-componentes'));
          all.forEach(x=> x && (x.style.display = (x.id==='section-texto')? 'block' : 'none'));
          console.log('[nav2] default -> section-texto',
            'states:', all.map(x=> x.id+':'+getComputedStyle(x).display).join(', ')
          );
        }
        // Desactivar fallback del navbar viejo (evitamos reconstrucción)

        // Fallback: si sección #section-texto no existe, crear mínima para render
        if (!document.getElementById('section-texto')) {
          const sec = document.createElement('div');
          sec.id = 'section-texto';
          sec.className = 'section';
          sec.style.display = 'none';
          sec.innerHTML = `
            <h1>Tipografía UBITS</h1>
            <div class="kcard"><h3>Display</h3>
              <div class="typo-sample">
                <div class="typo-box"><code>D1</code></div>
                <div style="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:700">Display 1</div>
              </div>
            </div>`;
          document.body.appendChild(sec);
          console.warn('[fallback] sección #section-texto creada (mínima)');
        }
        // Manejo robusto de clicks en el menú lateral (evita estados de hash inconsistentes)
        const side = document.querySelector('#section-colores .side');
        if(side){
          side.addEventListener('click', (ev)=>{
            const a = ev.target.closest('a.side-link');
            if(!a) return;
            const cat = a.getAttribute('data-cat');
            if(!cat) return;
            ev.preventDefault();
            activateSubtab(cat);
          });
        }
      })();

      // Ajuste: detección más robusta de sección activa visible
      function getActiveCategorySection(){
        const all = Array.from(document.querySelectorAll('#section-colores .cat-section'));
        // sección sin display:none (inline style)
        const visible = all.find(s => s.style.display !== 'none');
        return visible || all.find(s => !s.hasAttribute('style')) || null;
      }
      function getActiveCatId(){
        const a = document.querySelector('#section-colores .side a.side-link.active');
        return a ? a.getAttribute('data-cat') : 'brand';
      }
      function showOnlyActive(){
        const active = getActiveCatId();
        document.querySelectorAll('#section-colores .cat-section').forEach(sec => {
          sec.style.display = (sec.id === `cat-${active}`) ? '' : 'none';
        });
      }

      // Reescribir applySearchFilter para usar búsqueda global por todas las categorías
      function applySearchFilter(){
        const input = document.getElementById('tokens-search');
        const q = (input && input.value ? input.value : '').trim().toLowerCase();
        const sections = Array.from(document.querySelectorAll('#section-colores .cat-section'));
        if(q === ''){
          // restaurar visibilidad de pares en todas las secciones y mostrar solo la activa
          sections.forEach(sec => {
            sec.querySelectorAll('.grid').forEach(grid => {
              const children = Array.from(grid.children);
              for(let i=0;i<children.length;i+=2){
                if(children[i]) children[i].style.display = '';
                if(children[i+1]) children[i+1].style.display = '';
              }
            });
          });
          showOnlyActive();
          return;
        }
        // Mostrar todas las secciones y filtrar cada una; ocultar las que no tengan matches
        sections.forEach(sec => {
          sec.style.display = '';
          let hasVisible = false;
          sec.querySelectorAll('.grid').forEach(grid => {
            const children = Array.from(grid.children);
            for(let i=0;i<children.length;i+=2){
              const nameEl = children[i];
              const valEl = children[i+1];
              if(!nameEl || !valEl) continue;
              const txt = (nameEl.textContent + ' ' + valEl.textContent).toLowerCase();
              const match = txt.includes(q);
              nameEl.style.display = match ? '' : 'none';
              valEl.style.display = match ? '' : 'none';
              if(match) hasVisible = true;
            }
          });
          // Ocultar sección si no hay ningún par visible
          sec.style.display = hasVisible ? '' : 'none';
        });
      }

      function copyToClipboard(text){
        if (navigator.clipboard && navigator.clipboard.writeText) {
          return navigator.clipboard.writeText(text);
        }
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.focus(); ta.select();
        try { document.execCommand('copy'); } catch(e) {}
        document.body.removeChild(ta);
        return Promise.resolve();
      }

      // No-op de diagnóstico para evitar errores en consola
      function debugLayout(){ /* noop */ }

      // Copiado de reglas CSS en Tipografía
      document.addEventListener('click', async (ev)=>{
        const el = (ev.target instanceof Element) ? ev.target.closest('.typo-sample.copyable') : null;
        if(!el) return;
        const css = el.getAttribute('data-css');
        if(!css) return;
        ev.preventDefault();
        await copyToClipboard(css);
        showToast('Regla CSS copiada');
      });

      // Copiado de código HTML de iconos
      document.addEventListener('click', async (ev)=>{
        const iconCard = (ev.target instanceof Element) ? ev.target.closest('.icon-card.copyable') : null;
        if(!iconCard) return;
        const code = iconCard.getAttribute('data-code');
        if(!code) return;
        ev.preventDefault();
        const htmlCode = `<i class="${code}"></i>`;
        await copyToClipboard(htmlCode);
        iconCard.classList.add('copied');
        showToast(`Código copiado: ${htmlCode}`);
        setTimeout(() => {
          iconCard.classList.remove('copied');
        }, 900);
      });

      function cell(name, theme){
        html.setAttribute('data-theme', theme);
        const value = getComputedStyle(root).getPropertyValue(name).trim();
        const wrap = document.createElement('div');
        wrap.className = 'copyable';
        wrap.title = `Click para copiar: ${name} = ${value}`;
        const vLower = value.toLowerCase();
        const isWhite = vLower === '#fff' || vLower === '#ffffff' || vLower === 'rgb(255, 255, 255)';
        const swatchStyle = isWhite
          ? 'background:repeating-conic-gradient(#eee 0% 25%, #fff 0% 50%) 50%/12px 12px; border:1px solid #9ca3af'
          : `background:${value}`;
        wrap.innerHTML = `<div class="swatch" style="${swatchStyle}"></div><code>${value}</code>`;
        wrap.addEventListener('click', async () => {
          await copyToClipboard(`${name}: ${value}`);
          showToast(`Token copiado: ${name} = ${value}`);
          wrap.classList.add('copied');
          const prev = wrap.querySelector('code')?.textContent;
          const codeEl = wrap.querySelector('code');
          if (codeEl) codeEl.textContent = 'copiado';
          setTimeout(() => {
            wrap.classList.remove('copied');
            if (codeEl && prev) codeEl.textContent = prev;
          }, 900);
        });
        return wrap;
      }

      function addRow(token){
        const gridL = document.getElementById('grid-light');
        const gridD = document.getElementById('grid-dark');
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridL.appendChild(nameL);
        gridL.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridD.appendChild(nameD);
        gridD.appendChild(cell(token,'dark'));
      }

      TOKENS.forEach(addRow);
      
      // BUTTON COLORS
      const BTN = [
        '--ubits-button-primary-bg-default',
        '--ubits-button-primary-hover',
        '--ubits-button-primary-pressed',
        '--ubits-button-active-bg',
        '--ubits-button-focus-ring',
        '--ubits-button-badge',
        '--ubits-btn-primary-fg',
        '--ubits-bg-disabled-button',
        '--ubits-border-disabled-button',
        '--ubits-fg-on-disabled-button',
        '--ubits-btn-secondary-bg-default',
        '--ubits-btn-secondary-bg-hover',
        '--ubits-btn-secondary-bg-pressed',
        '--ubits-btn-secondary-fg-default',
        '--ubits-btn-secondary-border',
        '--ubits-btn-tertiary-fg',
        '--ubits-btn-tertiary-bg-hover',
        '--ubits-btn-tertiary-bg-pressed'
      ];
      const gridLB = document.getElementById('grid-light-button');
      const gridDB = document.getElementById('grid-dark-button');
      function addRowBtn(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLB.appendChild(nameL);
        gridLB.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDB.appendChild(nameD);
        gridDB.appendChild(cell(token,'dark'));
      }
      BTN.forEach(addRowBtn);

      // FOREGROUND COLORS
      const FG = [
        '--ubits-fg-1-high','--ubits-fg-1-high-inverted','--ubits-fg-1-high-static','--ubits-fg-1-high-static-inverted',
        '--ubits-fg-1-medium','--ubits-fg-1-medium-inverted','--ubits-fg-1-medium-static','--ubits-fg-1-medium-static-inverted',
        '--ubits-fg-2-high','--ubits-fg-2-high-inverted','--ubits-fg-2-high-static','--ubits-fg-2-high-static-inverted',
        '--ubits-fg-2-medium','--ubits-fg-2-medium-inverted','--ubits-fg-2-medium-static','--ubits-fg-2-medium-static-inverted',
        '--ubits-fg-disabled','--ubits-fg-disabled-inverted','--ubits-fg-disabled-static','--ubits-fg-disabled-static-inverted',
        '--ubits-fg-on-disabled','--ubits-fg-on-disabled-inverted','--ubits-fg-on-disabled-static','--ubits-fg-on-disabled-static-inverted',
        '--ubits-fg-bold'
      ];
      const gridLFG = document.getElementById('grid-light-fg');
      const gridDFG = document.getElementById('grid-dark-fg');
      function addRowFg(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFG.appendChild(nameL);
        gridLFG.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFG.appendChild(nameD);
        gridDFG.appendChild(cell(token,'dark'));
      }
      FG.forEach(addRowFg);

      // BLUE FOREGROUNDS
      const BLUE_FG = [
        '--ubits-fg-blue-subtle',
        '--ubits-fg-blue-subtle-inverted',
        '--ubits-fg-blue-subtle-hover',
        '--ubits-fg-blue-subtle-inverted-hover',
        '--ubits-fg-blue-subtle-static',
        '--ubits-fg-blue-subtle-static-inverted',
        '--ubits-fg-blue-subtle-static-hover',
        '--ubits-fg-blue-subtle-static-inverted-hover'
      ];
      const gridLBlue = document.getElementById('grid-light-fg-blue');
      const gridDBlue = document.getElementById('grid-dark-fg-blue');
      function addRowBlue(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBlue.appendChild(nameL);
        gridLBlue.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBlue.appendChild(nameD);
        gridDBlue.appendChild(cell(token,'dark'));
      }
      BLUE_FG.forEach(addRowBlue);

      // GRAY FOREGROUNDS
      const GRAY_FG = [
        '--ubits-fg-gray-subtle',
        '--ubits-fg-gray-subtle-inverted',
        '--ubits-fg-gray-subtle-hover',
        '--ubits-fg-gray-subtle-inverted-hover',
        '--ubits-fg-gray-subtle-static',
        '--ubits-fg-gray-subtle-static-inverted',
        '--ubits-fg-gray-subtle-static-hover',
        '--ubits-fg-gray-subtle-static-inverted-hover'
      ];
      const gridLGray = document.getElementById('grid-light-fg-gray');
      const gridDGray = document.getElementById('grid-dark-fg-gray');
      function addRowGray(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLGray.appendChild(nameL);
        gridLGray.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDGray.appendChild(nameD);
        gridDGray.appendChild(cell(token,'dark'));
      }
      GRAY_FG.forEach(addRowGray);

      // GREEN FOREGROUNDS
      const GREEN_FG = [
        '--ubits-fg-green-subtle',
        '--ubits-fg-green-subtle-inverted',
        '--ubits-fg-green-subtle-hover',
        '--ubits-fg-green-subtle-inverted-hover',
        '--ubits-fg-green-subtle-static',
        '--ubits-fg-green-subtle-static-inverted',
        '--ubits-fg-green-subtle-static-hover',
        '--ubits-fg-green-subtle-static-inverted-hover'
      ];
      const gridLGreen = document.getElementById('grid-light-fg-green');
      const gridDGreen = document.getElementById('grid-dark-fg-green');
      function addRowGreen(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLGreen.appendChild(nameL);
        gridLGreen.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDGreen.appendChild(nameD);
        gridDGreen.appendChild(cell(token,'dark'));
      }
      GREEN_FG.forEach(addRowGreen);

      // TEAL FOREGROUNDS
      const TEAL_FG = [
        '--ubits-fg-teal-subtle',
        '--ubits-fg-teal-subtle-inverted',
        '--ubits-fg-teal-subtle-hover',
        '--ubits-fg-teal-subtle-inverted-hover',
        '--ubits-fg-teal-subtle-static',
        '--ubits-fg-teal-subtle-static-inverted',
        '--ubits-fg-teal-subtle-static-hover',
        '--ubits-fg-teal-subtle-static-inverted-hover'
      ];
      const gridLTeal = document.getElementById('grid-light-fg-teal');
      const gridDTeal = document.getElementById('grid-dark-fg-teal');
      function addRowTeal(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLTeal.appendChild(nameL);
        gridLTeal.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDTeal.appendChild(nameD);
        gridDTeal.appendChild(cell(token,'dark'));
      }
      TEAL_FG.forEach(addRowTeal);

      // PURPLE FOREGROUNDS
      const PURPLE_FG = [
        '--ubits-fg-purple-subtle',
        '--ubits-fg-purple-subtle-inverted',
        '--ubits-fg-purple-subtle-hover',
        '--ubits-fg-purple-subtle-inverted-hover',
        '--ubits-fg-purple-subtle-static',
        '--ubits-fg-purple-subtle-static-inverted',
        '--ubits-fg-purple-subtle-static-hover',
        '--ubits-fg-purple-subtle-static-inverted-hover'
      ];
      const gridLPurple = document.getElementById('grid-light-fg-purple');
      const gridDPurple = document.getElementById('grid-dark-fg-purple');
      function addRowPurple(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLPurple.appendChild(nameL);
        gridLPurple.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDPurple.appendChild(nameD);
        gridDPurple.appendChild(cell(token,'dark'));
      }
      PURPLE_FG.forEach(addRowPurple);

      // PINK FOREGROUNDS
      const PINK_FG = [
        '--ubits-fg-pink-subtle',
        '--ubits-fg-pink-subtle-inverted',
        '--ubits-fg-pink-subtle-hover',
        '--ubits-fg-pink-subtle-inverted-hover',
        '--ubits-fg-pink-subtle-static',
        '--ubits-fg-pink-subtle-static-inverted',
        '--ubits-fg-pink-subtle-static-hover',
        '--ubits-fg-pink-subtle-static-inverted-hover'
      ];
      const gridLPink = document.getElementById('grid-light-fg-pink');
      const gridDPink = document.getElementById('grid-dark-fg-pink');
      function addRowPink(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLPink.appendChild(nameL);
        gridLPink.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDPink.appendChild(nameD);
        gridDPink.appendChild(cell(token,'dark'));
      }
      PINK_FG.forEach(addRowPink);

      // ROSE FOREGROUNDS
      const ROSE_FG = [
        '--ubits-fg-rose-subtle',
        '--ubits-fg-rose-subtle-inverted',
        '--ubits-fg-rose-subtle-hover',
        '--ubits-fg-rose-subtle-inverted-hover',
        '--ubits-fg-rose-subtle-static',
        '--ubits-fg-rose-subtle-static-inverted',
        '--ubits-fg-rose-subtle-static-hover',
        '--ubits-fg-rose-subtle-static-inverted-hover'
      ];
      const gridLRose = document.getElementById('grid-light-fg-rose');
      const gridDRose = document.getElementById('grid-dark-fg-rose');
      function addRowRose(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLRose.appendChild(nameL);
        gridLRose.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDRose.appendChild(nameD);
        gridDRose.appendChild(cell(token,'dark'));
      }
      ROSE_FG.forEach(addRowRose);

      // BACKGROUND COLORS
      const BG = [
        '--ubits-bg-active','--ubits-bg-1','--ubits-bg-2','--ubits-bg-3','--ubits-bg-4','--ubits-bg-5','--ubits-bg-dim','--ubits-bg-disabled'
      ];
      const gridLBG = document.getElementById('grid-light-bg');
      const gridDBG = document.getElementById('grid-dark-bg');
      function addRowBg(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBG.appendChild(nameL);
        gridLBG.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBG.appendChild(nameD);
        gridDBG.appendChild(cell(token,'dark'));
      }
      BG.forEach(addRowBg);

      // BORDER COLORS - MAIN
      const BORDERS_MAIN = [
        '--ubits-border-1','--ubits-border-2','--ubits-border-disabled'
      ];
      const gridLBM = document.getElementById('grid-light-border-main');
      const gridDBM = document.getElementById('grid-dark-border-main');
      function addRowBM(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBM.appendChild(nameL);
        gridLBM.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBM.appendChild(nameD);
        gridDBM.appendChild(cell(token,'dark'));
      }
      BORDERS_MAIN.forEach(addRowBM);

      // BORDER COLORS - COLORED
      const BORDERS_COLORED = [
        '--ubits-border-blue','--ubits-border-gray','--ubits-border-green','--ubits-border-teal','--ubits-border-indigo','--ubits-border-purple','--ubits-border-pink','--ubits-border-yellow','--ubits-border-rose'
      ];
      const gridLBC = document.getElementById('grid-light-border-colored');
      const gridDBC = document.getElementById('grid-dark-border-colored');
      function addRowBC(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBC.appendChild(nameL);
        gridLBC.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBC.appendChild(nameD);
        gridDBC.appendChild(cell(token,'dark'));
      }
      BORDERS_COLORED.forEach(addRowBC);

      // BORDER COLORS - INVERTED
      const BORDERS_INVERTED = [
        '--ubits-border-1-inverted','--ubits-border-2-inverted','--ubits-border-disabled-inverted',
        '--ubits-border-blue-inverted','--ubits-border-gray-inverted','--ubits-border-green-inverted','--ubits-border-teal-inverted','--ubits-border-indigo-inverted','--ubits-border-purple-inverted','--ubits-border-pink-inverted','--ubits-border-yellow-inverted','--ubits-border-rose-inverted'
      ];
      const gridLBI = document.getElementById('grid-light-border-inverted');
      const gridDBI = document.getElementById('grid-dark-border-inverted');
      function addRowBI(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBI.appendChild(nameL);
        gridLBI.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBI.appendChild(nameD);
        gridDBI.appendChild(cell(token,'dark'));
      }
      BORDERS_INVERTED.forEach(addRowBI);

      // BORDER COLORS - STATIC
      const BORDERS_STATIC = [
        '--ubits-border-1-static','--ubits-border-2-static','--ubits-border-disabled-static',
        '--ubits-border-blue-static','--ubits-border-gray-static','--ubits-border-green-static','--ubits-border-teal-static','--ubits-border-indigo-static','--ubits-border-purple-static','--ubits-border-pink-static','--ubits-border-yellow-static','--ubits-border-rose-static'
      ];
      const gridLBS = document.getElementById('grid-light-border-static');
      const gridDBS = document.getElementById('grid-dark-border-static');
      function addRowBS(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBS.appendChild(nameL);
        gridLBS.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBS.appendChild(nameD);
        gridDBS.appendChild(cell(token,'dark'));
      }
      BORDERS_STATIC.forEach(addRowBS);

      // BORDER COLORS - STATIC INVERTED
      const BORDERS_STATIC_INV = [
        '--ubits-border-1-static-inverted','--ubits-border-2-static-inverted','--ubits-border-disabled-static-inverted',
        '--ubits-border-blue-static-inverted','--ubits-border-gray-static-inverted','--ubits-border-green-static-inverted','--ubits-border-teal-static-inverted','--ubits-border-indigo-static-inverted','--ubits-border-purple-static-inverted','--ubits-border-pink-static-inverted','--ubits-border-yellow-static-inverted','--ubits-border-rose-static-inverted'
      ];
      const gridLBSI = document.getElementById('grid-light-border-static-inv');
      const gridDBSI = document.getElementById('grid-dark-border-static-inv');
      function addRowBSI(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBSI.appendChild(nameL);
        gridLBSI.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBSI.appendChild(nameD);
        gridDBSI.appendChild(cell(token,'dark'));
      }
      BORDERS_STATIC_INV.forEach(addRowBSI);

      // SIDEBAR COLORS
      const SIDEBAR = [
        '--ubits-sidebar-bg','--ubits-sidebar-logo','--ubits-sidebar-button-bg-pressed','--ubits-sidebar-button-bg-disabled','--ubits-sidebar-button-bg-active','--ubits-sidebar-button-fg-default','--ubits-sidebar-button-fg-hover','--ubits-sidebar-button-fg-pressed','--ubits-sidebar-button-fg-active','--ubits-sidebar-button-fg-disabled'
      ];
      const gridLSide = document.getElementById('grid-light-sidebar');
      const gridDSide = document.getElementById('grid-dark-sidebar');
      function addRowSide(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLSide.appendChild(nameL);
        gridLSide.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDSide.appendChild(nameD);
        gridDSide.appendChild(cell(token,'dark'));
      }
      SIDEBAR.forEach(addRowSide);

      // FEEDBACK SUCCESS
      const FEEDBACK_SUCCESS = [
        '--ubits-feedback-bg-success-subtle',
        '--ubits-feedback-fg-success-subtle',
        '--ubits-feedback-accent-success',
        '--ubits-feedback-accent-success-inverted',
        '--ubits-feedback-accent-success-static',
        '--ubits-feedback-accent-success-static-inverted',
        '--ubits-feedback-fg-success-subtle-alt',
        '--ubits-feedback-fg-success-subtle-inverted',
        '--ubits-feedback-fg-success-subtle-hover',
        '--ubits-feedback-fg-success-subtle-inverted-hover',
        '--ubits-feedback-fg-success-subtle-static',
        '--ubits-feedback-fg-success-subtle-static-inverted',
        '--ubits-feedback-fg-success-subtle-static-hover',
        '--ubits-feedback-fg-success-subtle-static-inverted-hover'
      ];
      const gridLFS = document.getElementById('grid-light-feedback-success');
      const gridDFS = document.getElementById('grid-dark-feedback-success');
      function addRowFS(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFS.appendChild(nameL);
        gridLFS.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFS.appendChild(nameD);
        gridDFS.appendChild(cell(token,'dark'));
      }
      FEEDBACK_SUCCESS.forEach(addRowFS);

      // FEEDBACK INFO
      const FEEDBACK_INFO = [
        '--ubits-feedback-bg-info-subtle',
        '--ubits-feedback-fg-info-subtle',
        '--ubits-feedback-accent-info',
        '--ubits-feedback-accent-info-inverted',
        '--ubits-feedback-accent-info-static',
        '--ubits-feedback-accent-info-static-inverted',
        '--ubits-feedback-fg-info-subtle-alt',
        '--ubits-feedback-fg-info-subtle-inverted',
        '--ubits-feedback-fg-info-subtle-hover',
        '--ubits-feedback-fg-info-subtle-inverted-hover',
        '--ubits-feedback-fg-info-subtle-static',
        '--ubits-feedback-fg-info-subtle-static-inverted',
        '--ubits-feedback-fg-info-subtle-static-hover',
        '--ubits-feedback-fg-info-subtle-static-inverted-hover'
      ];
      const gridLFI = document.getElementById('grid-light-feedback-info');
      const gridDFI = document.getElementById('grid-dark-feedback-info');
      function addRowFI(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFI.appendChild(nameL);
        gridLFI.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFI.appendChild(nameD);
        gridDFI.appendChild(cell(token,'dark'));
      }
      FEEDBACK_INFO.forEach(addRowFI);

      // FEEDBACK WARNING
      const FEEDBACK_WARNING = [
        '--ubits-feedback-bg-warning-subtle',
        '--ubits-feedback-fg-warning-subtle',
        '--ubits-feedback-accent-warning',
        '--ubits-feedback-accent-warning-inverted',
        '--ubits-feedback-fg-warning-subtle-alt',
        '--ubits-feedback-fg-warning-subtle-inverted',
        '--ubits-feedback-fg-warning-subtle-hover',
        '--ubits-feedback-fg-warning-subtle-inverted-hover',
        '--ubits-feedback-fg-warning-bold',
        '--ubits-feedback-fg-warning-bold-inverted',
        '--ubits-feedback-fg-warning-bold-hover',
        '--ubits-feedback-fg-warning-bold-inverted-hover',
        '--ubits-feedback-fg-warning-subtle-static',
        '--ubits-feedback-fg-warning-subtle-static-inverted',
        '--ubits-feedback-fg-warning-subtle-static-hover',
        '--ubits-feedback-fg-warning-subtle-static-inverted-hover'
      ];
      const gridLFW = document.getElementById('grid-light-feedback-warning');
      const gridDFW = document.getElementById('grid-dark-feedback-warning');
      function addRowFW(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFW.appendChild(nameL);
        gridLFW.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFW.appendChild(nameD);
        gridDFW.appendChild(cell(token,'dark'));
      }
      FEEDBACK_WARNING.forEach(addRowFW);

      // FEEDBACK ERROR
      const FEEDBACK_ERROR = [
        '--ubits-feedback-bg-error-subtle',
        '--ubits-feedback-fg-error-subtle',
        '--ubits-feedback-accent-error',
        '--ubits-feedback-accent-error-inverted',
        '--ubits-feedback-accent-error-static',
        '--ubits-feedback-accent-error-static-inverted',
        '--ubits-feedback-fg-error-subtle-alt',
        '--ubits-feedback-fg-error-subtle-inverted',
        '--ubits-feedback-fg-error-subtle-hover',
        '--ubits-feedback-fg-error-subtle-inverted-hover',
        '--ubits-feedback-fg-error-subtle-static',
        '--ubits-feedback-fg-error-subtle-static-inverted',
        '--ubits-feedback-fg-error-subtle-static-hover',
        '--ubits-feedback-fg-error-subtle-static-inverted-hover'
      ];
      const gridLFE = document.getElementById('grid-light-feedback-error');
      const gridDFE = document.getElementById('grid-dark-feedback-error');
      function addRowFE(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFE.appendChild(nameL);
        gridLFE.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFE.appendChild(nameD);
        gridDFE.appendChild(cell(token,'dark'));
      }
      FEEDBACK_ERROR.forEach(addRowFE);

      // FEEDBACK BORDERS
      const FEEDBACK_BORDERS = [
        '--ubits-feedback-border-success','--ubits-feedback-border-info','--ubits-feedback-border-warning','--ubits-feedback-border-error',
        '--ubits-feedback-border-success-inverted','--ubits-feedback-border-info-inverted','--ubits-feedback-border-warning-inverted','--ubits-feedback-border-error-inverted',
        '--ubits-feedback-border-success-static','--ubits-feedback-border-info-static','--ubits-feedback-border-warning-static','--ubits-feedback-border-error-static',
        '--ubits-feedback-border-success-static-inverted','--ubits-feedback-border-info-static-inverted','--ubits-feedback-border-warning-static-inverted','--ubits-feedback-border-error-static-inverted'
      ];
      const gridLFB = document.getElementById('grid-light-feedback-borders');
      const gridDFB = document.getElementById('grid-dark-feedback-borders');
      function addRowFB(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFB.appendChild(nameL);
        gridLFB.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFB.appendChild(nameD);
        gridDFB.appendChild(cell(token,'dark'));
      }
      FEEDBACK_BORDERS.forEach(addRowFB);

      // CHART COLORS
      const CHART = [
        '--ubits-chart-bg-level-1'
      ];
      const gridLChart = document.getElementById('grid-light-chart');
      const gridDChart = document.getElementById('grid-dark-chart');
      function addRowChart(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLChart.appendChild(nameL);
        gridLChart.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDChart.appendChild(nameD);
        gridDChart.appendChild(cell(token,'dark'));
      }
      CHART.forEach(addRowChart);

      // TOAST COLORS
      const TOAST = [
        '--ubits-toast-feedback-bg'
      ];
      const gridLToast = document.getElementById('grid-light-toast');
      const gridDToast = document.getElementById('grid-dark-toast');
      function addRowToast(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLToast.appendChild(nameL);
        gridLToast.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDToast.appendChild(nameD);
        gridDToast.appendChild(cell(token,'dark'));
      }
      TOAST.forEach(addRowToast);

      // BOTTOM NAV COLORS
      const BOTTOM_NAV = [
        '--ubits-bottom-nav-shadow-opacity'
      ];
      const gridLBN = document.getElementById('grid-light-bottom-nav');
      const gridDBN = document.getElementById('grid-dark-bottom-nav');
      function addRowBN(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBN.appendChild(nameL);
        gridLBN.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBN.appendChild(nameD);
        gridDBN.appendChild(cell(token,'dark'));
      }
      BOTTOM_NAV.forEach(addRowBN);

      // YELLOW FOREGROUNDS
      const YELLOW_FG = [
        '--ubits-fg-yellow-subtle','--ubits-fg-yellow-subtle-inverted','--ubits-fg-yellow-subtle-hover','--ubits-fg-yellow-subtle-inverted-hover',
        '--ubits-fg-yellow-bold','--ubits-fg-yellow-bold-inverted','--ubits-fg-yellow-bold-hover','--ubits-fg-yellow-bold-inverted-hover',
        '--ubits-fg-yellow-subtle-static','--ubits-fg-yellow-subtle-static-inverted','--ubits-fg-yellow-bold-static','--ubits-fg-yellow-bold-static-inverted',
        '--ubits-fg-yellow-subtle-static-hover','--ubits-fg-yellow-subtle-static-inverted-hover','--ubits-fg-yellow-bold-static-hover','--ubits-fg-yellow-bold-static-inverted-hover'
      ];
      const gridLYellow = document.getElementById('grid-light-fg-yellow');
      const gridDYellow = document.getElementById('grid-dark-fg-yellow');
      function addRowYellow(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLYellow.appendChild(nameL);
        gridLYellow.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDYellow.appendChild(nameD);
        gridDYellow.appendChild(cell(token,'dark'));
      }
      YELLOW_FG.forEach(addRowYellow);

      // restaurar estado por defecto de cálculo si fuese necesario
      html.setAttribute('data-theme','light');
      // Evitar que el hash fuerce Colores. Mostramos sección-texto por defecto con nav2 si existe
      (function ensureTextoDefault(){
        const texto = document.getElementById('section-texto');
        const colores = document.getElementById('section-colores');
        const template = document.getElementById('section-template');
        const iconos = document.getElementById('section-iconos');
        if(texto && colores && template && iconos){
          texto.style.display = 'block';
          colores.style.display = 'none';
          template.style.display = 'none';
          iconos.style.display = 'none';
          console.log('[startup] forced default -> section-texto');
        } else {
          console.warn('[startup] sections missing', !!texto, !!colores, !!template, !!iconos);
        }
      })();

      // ========================================
      // SISTEMA DE ICONOS COMPLETO - POR CATEGORÍAS
      // ========================================
      (function initIconsSystem() {
        let allIcons = [];
        let filteredIcons = [];
        const iconsContainer = document.getElementById('icons-container');
        const iconsSearchInput = document.getElementById('icons-search-input');
        const iconsClearSearch = document.getElementById('icons-clear-search');
        const iconsCount = document.getElementById('icons-count');
        const iconsEmptyState = document.getElementById('icons-empty-state');
        const iconsCategoryNav = document.getElementById('icons-category-nav');

        // Validar que los elementos existan
        if (!iconsContainer || !iconsCount || !iconsCategoryNav) {
          console.error('❌ Elementos DOM faltantes para sistema de iconos');
          return;
        }

        // Sistema de categorías basado en palabras clave - EXPANDIDO
        const iconCategories = {
          'Interfaz': {
            keywords: ['menu', 'bars', 'hamburger', 'nav', 'sidebar', 'list', 'grid', 'layout', 'view', 'display', 'show', 'hide', 'eye', 'eye-slash', 'toggle', 'switch', 'window', 'maximize', 'minimize', 'restore', 'mobile', 'desktop', 'tablet', 'screen', 'panel', 'dashboard'],
            label: 'Interfaz'
          },
          'Acciones': {
            keywords: ['add', 'plus', 'create', 'new', 'save', 'delete', 'trash', 'remove', 'edit', 'update', 'modify', 'change', 'copy', 'cut', 'paste', 'duplicate', 'clone', 'undo', 'redo', 'refresh', 'reload', 'recycle', 'repeat', 'rotate', 'shuffle', 'sort', 'swap'],
            label: 'Acciones'
          },
          'Comunicación': {
            keywords: ['message', 'chat', 'comment', 'reply', 'mail', 'email', 'envelope', 'send', 'receive', 'notification', 'bell', 'alert', 'inbox', 'outbox', 'phone', 'call', 'microphone', 'headset', 'headphone', 'speaker', 'bullhorn', 'announcement', 'megaphone', 'voicemail', 'video', 'camera', 'facetime'],
            label: 'Comunicación'
          },
          'Navegación': {
            keywords: ['arrow', 'chevron', 'caret', 'direction', 'up', 'down', 'left', 'right', 'back', 'forward', 'next', 'previous', 'first', 'last', 'step', 'move', 'navigate', 'route', 'path', 'direction', 'turn', 'angle'],
            label: 'Navegación'
          },
          'Usuario': {
            keywords: ['user', 'person', 'people', 'account', 'profile', 'avatar', 'login', 'logout', 'sign', 'member', 'team', 'group', 'crowd', 'users', 'human', 'personnel', 'staff', 'employee', 'customer', 'client'],
            label: 'Usuario'
          },
          'Archivos': {
            keywords: ['file', 'folder', 'document', 'paper', 'archive', 'directory', 'download', 'upload', 'export', 'import', 'attachment', 'clipboard', 'documentation', 'spreadsheet', 'presentation', 'pdf', 'excel', 'word', 'zip', 'rar', 'code', 'script'],
            label: 'Archivos'
          },
          'Búsqueda': {
            keywords: ['search', 'find', 'filter', 'magnify', 'lookup', 'query', 'scan', 'discover', 'explore', 'investigate', 'hunt'],
            label: 'Búsqueda'
          },
          'Edición': {
            keywords: ['edit', 'pencil', 'pen', 'write', 'draw', 'paint', 'brush', 'eraser', 'highlight', 'marker', 'ink', 'sketch', 'draft', 'note', 'annotate'],
            label: 'Edición'
          },
          'Validación': {
            keywords: ['check', 'ok', 'success', 'done', 'complete', 'verify', 'confirm', 'approve', 'accept', 'times', 'close', 'cancel', 'error', 'warning', 'exclamation', 'circle', 'badge', 'certificate', 'validation', 'approved', 'rejected', 'denied', 'blocked'],
            label: 'Validación'
          },
          'Configuración': {
            keywords: ['settings', 'config', 'gear', 'cog', 'preferences', 'option', 'setup', 'admin', 'control', 'manage', 'wrench', 'tools', 'screwdriver', 'adjust', 'tune', 'calibrate', 'configure'],
            label: 'Configuración'
          },
          'Gráficos y Diagramas': {
            keywords: ['chart', 'graph', 'diagram', 'analytics', 'statistics', 'data', 'metric', 'bar', 'line', 'pie', 'area', 'column', 'trend', 'gantt', 'tree', 'flow', 'sitemap', 'network', 'node', 'connection', 'map', 'visualization', 'dashboard', 'report', 'insight'],
            label: 'Gráficos y Diagramas'
          },
          'Música y Media': {
            keywords: ['music', 'audio', 'video', 'play', 'pause', 'stop', 'record', 'volume', 'sound', 'film', 'movie', 'camera', 'photo', 'image', 'picture', 'media', 'multimedia', 'album', 'cd', 'vinyl', 'radio', 'podcast', 'stream', 'broadcast'],
            label: 'Música y Media'
          },
          'Negocio': {
            keywords: ['business', 'money', 'dollar', 'euro', 'currency', 'payment', 'credit', 'card', 'wallet', 'shopping', 'cart', 'store', 'shop', 'market', 'sales', 'revenue', 'profit', 'loss', 'invoice', 'bill', 'receipt', 'transaction', 'bank', 'finance', 'investment', 'stock', 'trade'],
            label: 'Negocio'
          },
          'Educación': {
            keywords: ['education', 'learning', 'course', 'training', 'graduate', 'diploma', 'degree', 'certificate', 'school', 'university', 'college', 'student', 'teacher', 'book', 'textbook', 'notebook', 'study', 'exam', 'test', 'quiz', 'assignment', 'homework', 'lesson', 'class', 'lecture'],
            label: 'Educación'
          },
          'Transporte': {
            keywords: ['car', 'truck', 'bus', 'plane', 'train', 'bike', 'ship', 'transport', 'delivery', 'shipping', 'vehicle', 'automobile', 'motorcycle', 'scooter', 'taxi', 'van', 'trailer', 'cargo', 'freight', 'logistics'],
            label: 'Transporte'
          },
          'Tiempo': {
            keywords: ['time', 'clock', 'watch', 'calendar', 'date', 'schedule', 'deadline', 'timer', 'alarm', 'hourglass', 'stopwatch', 'chronometer', 'calendar', 'event', 'appointment', 'meeting', 'reminder', 'notification', 'past', 'future', 'history', 'timeline'],
            label: 'Tiempo'
          },
          'Ubicación': {
            keywords: ['location', 'map', 'pin', 'marker', 'address', 'place', 'position', 'gps', 'navigation', 'route', 'destination', 'origin', 'compass', 'direction', 'latitude', 'longitude', 'coordinates', 'geography', 'country', 'city', 'landmark'],
            label: 'Ubicación'
          },
          'Seguridad': {
            keywords: ['lock', 'unlock', 'key', 'shield', 'secure', 'privacy', 'protect', 'safe', 'guard', 'security', 'encryption', 'password', 'access', 'permission', 'authorization', 'firewall', 'vault', 'safety', 'protection', 'defense'],
            label: 'Seguridad'
          },
          'Internet': {
            keywords: ['network', 'wifi', 'connection', 'link', 'chain', 'url', 'web', 'internet', 'browser', 'globe', 'world', 'cloud', 'server', 'database', 'api', 'connectivity', 'signal', 'online', 'offline', 'sync', 'share', 'upload', 'download', 'stream'],
            label: 'Internet'
          },
          'Diseño': {
            keywords: ['design', 'paint', 'brush', 'palette', 'color', 'swatch', 'art', 'creative', 'sketch', 'drawing', 'illustration', 'graphic', 'visual', 'style', 'theme', 'template', 'layout', 'typography', 'font', 'text', 'heading', 'paragraph'],
            label: 'Diseño'
          },
          'Utilidades': {
            keywords: ['tool', 'utility', 'helper', 'assistant', 'robot', 'automation', 'puzzle', 'piece', 'keyboard', 'mouse', 'device', 'gadget', 'machine', 'equipment', 'instrument', 'accessibility', 'universal', 'support', 'help', 'question', 'info'],
            label: 'Utilidades'
          },
          'Otros': {
            keywords: [],
            label: 'Otros'
          }
        };

        // Cargar catálogo de iconos
        async function loadIconsCatalog() {
          if (!iconsContainer || !iconsCount) {
            console.error('Elementos del DOM no encontrados');
            return;
          }

          try {
            iconsCount.textContent = 'Cargando iconos...';
            const response = await fetch('icons-catalog.json');
            
            if (!response.ok) {
              throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            console.log('📦 Datos recibidos:', Object.keys(data), 'regular:', data.regular?.length, 'solid:', data.solid?.length);
            
            // Combinar regular y solid, eliminar duplicados
            const iconMap = new Map();
            [...(data.regular || []), ...(data.solid || [])].forEach(icon => {
              if (icon && icon.name && icon.className) {
                // Filtrar iconos numéricos y otros que no sean útiles
                const name = icon.name;
                // Ignorar iconos que son solo números o muy cortos
                if (!/^\d+$/.test(name) && name.length > 1) {
                  if (!iconMap.has(icon.name)) {
                    iconMap.set(icon.name, icon);
                  }
                }
              }
            });
            
            allIcons = Array.from(iconMap.values());
            filteredIcons = [...allIcons];
            
            // Ordenar alfabéticamente
            allIcons.sort((a, b) => a.name.localeCompare(b.name));
            filteredIcons.sort((a, b) => a.name.localeCompare(b.name));
            
            console.log(`✅ Cargados ${allIcons.length} iconos`);
            
            if (allIcons.length === 0) {
              throw new Error('Catálogo vacío o sin iconos válidos');
            }
            
            renderIcons();
            generateCategoryNav();
            updateCount();
          } catch (error) {
            console.error('❌ Error cargando catálogo de iconos:', error);
            console.log('Intentando cargar muestra de iconos directamente...');
            
            // Fallback: Cargar muestra de iconos directamente desde el CSS parseado
            loadSampleIcons();
          }
        }

        // Fallback: Cargar TODOS los 237 iconos del playground anterior
        function loadSampleIcons() {
          // Lista completa de los 237 iconos del playground anterior
          const sampleIcons = [
            'award', 'album-collection', 'badge-check', 'arrow-down', 'arrow-down-arrow-up', 'arrow-down-to-line',
            'arrow-left', 'arrow-left-to-line', 'arrow-right', 'arrow-right-to-line', 'arrow-trend-down', 'arrow-trend-up',
            'arrow-up', 'arrow-up-from-bracket', 'arrow-up-right-from-square', 'arrows-left-right', 'arrows-left-right-to-line',
            'arrows-rotate', 'chevron-down', 'chevron-left', 'chevron-right', 'chevron-up', 'chevrons-left', 'chevrons-right',
            'alarm-clock', 'analytics', 'angle-down', 'angle-left', 'angle-right', 'angle-up', 'bars', 'bars-progress',
            'bed', 'bell', 'bell-on', 'bell-slash', 'birthday-cake', 'bolt', 'book', 'bookmark', 'book-open', 'books',
            'brain', 'briefcase', 'brush', 'bug', 'building', 'building-columns', 'bullseye', 'bullseye-arrow',
            'bullseye-pointer', 'bus', 'calendar', 'calendar-check', 'calendar-arrow-down', 'calendar-days', 'caret-down',
            'caret-left', 'caret-right', 'caret-up', 'camera', 'car', 'cube', 'chart-line', 'chart-mixed', 'chart-pie',
            'chart-tree-map', 'chart-column', 'check', 'check-circle', 'circle-down', 'circle-chevron-down',
            'circle-chevron-left', 'circle-chevron-right', 'circle-chevron-up', 'circle-dot', 'clock', 'clock-rotate-left',
            'clone', 'closed-captioning', 'cloud', 'cloud-arrow-down', 'coin-vertical', 'cog', 'cogs', 'comment',
            'comment-lines', 'comments', 'copy', 'clipboard', 'clipboard-list-check', 'credit-card', 'database', 'desktop',
            'diploma', 'display-arrow-down', 'download', 'down-to-line', 'edit', 'ellipsis-vertical', 'envelope',
            'envelope-open-dollar', 'envelope-open-text', 'exclamation-triangle', 'eye', 'eye-dropper-full', 'eye-slash',
            'file', 'file-alt', 'file-arrow-down', 'file-arrow-up', 'file-audio', 'file-certificate', 'file-check',
            'file-circle-check', 'file-excel', 'file-exclamation', 'file-export', 'file-lock', 'file-magnifying-glass',
            'file-minus', 'file-music', 'file-plus', 'file-video', 'file-word', 'file-zipper', 'file-chart-column',
            'file-chart-pie', 'file-invoice-dollar', 'file-signature', 'file-waveform', 'film', 'filter', 'filter-circle-xmark',
            'filter-list', 'filter-slash', 'filters', 'fire', 'face-frown-slight', 'face-laugh-beam', 'face-meh', 'face-tired',
            'flag', 'flag-pennant', 'floppy-disk', 'folder', 'folder-arrow-down', 'folder-open', 'globe', 'gauge',
            'gauge-max', 'gauge-min', 'graduation-cap', 'grid-2', 'hand', 'hand-holding-heart', 'hand-point-up', 'handshake',
            'headphones', 'heading', 'heart', 'home', 'image', 'icons', 'info-circle', 'key', 'layer-group', 'lightbulb',
            'link', 'link-slash', 'list', 'location-dot', 'lock', 'map', 'map-location-dot', 'microphone', 'message-lines',
            'mobile', 'money-bill', 'moon', 'moon-stars', 'music', 'paint-brush', 'paint-roller', 'palette', 'paper-plane',
            'paperclip', 'paragraph', 'pause', 'pen-to-square', 'play', 'play-circle', 'plus', 'power-off', 'print',
            'question', 'question-circle', 'refresh', 'repeat', 'rotate-right', 'route', 'rocket', 'search', 'share',
            'sitemap', 'skull-crossbones', 'sliders', 'sliders-simple', 'sliders-up', 'slider', 'sparkles', 'store',
            'shield', 'shield-check', 'star', 'stop', 'sun', 'sun-bright', 'subtitles', 'tablet', 'tag', 'text-size',
            'text-slash', 'th-large', 'thumbs-up', 'thumbs-down', 'times', 'trash', 'trophy', 'upload', 'user', 'users',
            'video', 'volume-up', 'wifi', 'wand-magic-sparkles', 'wrench'
          ];

          allIcons = sampleIcons.map(name => ({
            name: name,
            className: `fa-${name}`,
            keywords: [name],
            styles: ['regular', 'solid']
          }));

          filteredIcons = [...allIcons];
          allIcons.sort((a, b) => a.name.localeCompare(b.name));
          filteredIcons.sort((a, b) => a.name.localeCompare(b.name));

          console.log(`✅ Cargados ${allIcons.length} iconos del playground anterior`);

          if (iconsCount) {
            iconsCount.textContent = `${allIcons.length} iconos (del playground anterior - usa servidor HTTP para catálogo completo)`;
          }

          renderIcons();
          generateCategoryNav();
          updateCount();
        }

        // Asignar icono a categoría basándose en keywords
        function assignIconToCategory(icon) {
          if (!icon || !icon.name) return 'Otros';
          
          const iconName = icon.name.toLowerCase();
          const iconKeywords = (icon.keywords || []).map(kw => kw.toLowerCase());
          
          // Buscar en cada categoría
          for (const [categoryKey, category] of Object.entries(iconCategories)) {
            if (categoryKey === 'Otros') continue;
            
            // Verificar si el nombre del icono o keywords coinciden
            const matches = category.keywords.some(keyword => 
              iconName.includes(keyword.toLowerCase()) || 
              iconKeywords.some(kw => kw.includes(keyword.toLowerCase()))
            );
            
            if (matches) {
              return categoryKey;
            }
          }
          
          return 'Otros';
        }

        // Generar navegación por categorías
        function generateCategoryNav() {
          if (!iconsCategoryNav || allIcons.length === 0) {
            console.warn('No se puede generar navegación: elementos faltantes o sin iconos');
            return;
          }

          // Asignar categorías a los iconos
          const iconsByCategory = {};
          Object.keys(iconCategories).forEach(category => {
            iconsByCategory[category] = [];
          });

          filteredIcons.forEach(icon => {
            const category = assignIconToCategory(icon);
            if (!iconsByCategory[category]) {
              iconsByCategory[category] = [];
            }
            iconsByCategory[category].push(icon);
          });

          // Filtrar categorías vacías y ordenar
          const categoriesWithIcons = Object.keys(iconsByCategory)
            .filter(category => iconsByCategory[category].length > 0)
            .sort();

          if (categoriesWithIcons.length === 0) {
            iconsCategoryNav.innerHTML = '<div style="padding: 8px 10px; color: var(--ubits-fg-1-medium); font-size: 12px;">Sin iconos</div>';
            return;
          }

          iconsCategoryNav.innerHTML = categoriesWithIcons.map(category => `
            <a href="#category-${category}" class="side-link" data-category="${category}" style="cursor: pointer; text-decoration: none;">
              ${iconCategories[category].label} <span style="color: var(--ubits-fg-1-medium); font-size: 12px;">(${iconsByCategory[category].length})</span>
            </a>
          `).join('');

          console.log(`✅ Navegación por categorías generada: ${categoriesWithIcons.length} categorías`);

          // Agregar event listeners a los links
          iconsCategoryNav.querySelectorAll('.side-link[data-category]').forEach(link => {
            link.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              const category = link.getAttribute('data-category');
              console.log('🔗 Click en categoría:', category);
              if (category) {
                scrollToCategory(category);
              }
            });
          });
        }

        // Renderizar iconos por categoría
        function renderIcons() {
          if (!iconsContainer) {
            console.error('iconsContainer no encontrado');
            return;
          }

          if (filteredIcons.length === 0) {
            iconsContainer.innerHTML = '';
            if (iconsEmptyState) iconsEmptyState.style.display = 'block';
            return;
          }

          if (iconsEmptyState) iconsEmptyState.style.display = 'none';

          // Agrupar por categoría
          const iconsByCategory = {};
          Object.keys(iconCategories).forEach(category => {
            iconsByCategory[category] = [];
          });

          filteredIcons.forEach(icon => {
            const category = assignIconToCategory(icon);
            if (!iconsByCategory[category]) {
              iconsByCategory[category] = [];
            }
            iconsByCategory[category].push(icon);
          });

          // Ordenar iconos dentro de cada categoría
          Object.keys(iconsByCategory).forEach(category => {
            iconsByCategory[category].sort((a, b) => a.name.localeCompare(b.name));
          });

          // Filtrar categorías vacías y ordenar
          const categoriesWithIcons = Object.keys(iconsByCategory)
            .filter(category => iconsByCategory[category].length > 0)
            .sort();

          // Renderizar secciones por categoría
          iconsContainer.innerHTML = categoriesWithIcons.map(category => `
              <div class="kcard" style="margin-bottom: 24px;">
                <h3 id="category-${category}" style="margin-bottom: 16px; color: var(--ubits-fg-1-high); font-size: 18px; font-weight: 600;">
                  ${iconCategories[category].label} <span style="color: var(--ubits-fg-1-medium); font-weight: 400; font-size: 14px;">(${iconsByCategory[category].length})</span>
                </h3>
                <div class="icons-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px;">
                  ${iconsByCategory[category].map(icon => {
                    // Determinar si usar far o fas (por defecto far para outline)
                    const style = icon.styles && icon.styles.includes('regular') ? 'far' : 'fas';
                    const code = `${style} ${icon.className}`;
                    return `
                      <div class="icon-card copyable" data-icon="${icon.name}" data-code="${code}" style="border: 1px solid var(--ubits-border-1); border-radius: 8px; padding: 16px; text-align: center; cursor: pointer; transition: all 0.2s ease; background: var(--ubits-bg-1);">
                        <div style="font-size: 24px; margin-bottom: 8px; color: var(--ubits-accent-brand);">
                          <i class="${code}"></i>
                        </div>
                        <div style="font-weight: 500; font-size: 12px; color: var(--ubits-fg-1-high); word-break: break-word; line-height: 1.3;">
                          ${icon.name}
                        </div>
                      </div>
                    `;
                  }).join('')}
                </div>
              </div>
            `).join('');
        }

        // Filtrar iconos
        function filterIcons(searchTerm) {
          if (!searchTerm) {
            filteredIcons = [...allIcons];
          } else {
            const term = searchTerm.trim().toLowerCase();
            if (!term) {
              filteredIcons = [...allIcons];
            } else {
              filteredIcons = allIcons.filter(icon => 
                icon && icon.name &&
                (icon.name.toLowerCase().includes(term) ||
                 (icon.className && icon.className.toLowerCase().includes(term)) ||
                 (icon.keywords && icon.keywords.some(kw => kw && kw.toLowerCase().includes(term))))
              );
            }
          }
          filteredIcons.sort((a, b) => a.name.localeCompare(b.name));
          renderIcons();
          updateCount();
        }

        // Actualizar contador
        function updateCount() {
          const total = allIcons.length;
          const showing = filteredIcons.length;
          if (showing === total) {
            iconsCount.textContent = `${total} iconos`;
          } else {
            iconsCount.textContent = `${showing} de ${total} iconos`;
          }
        }

        // Scroll a categoría
        function scrollToCategory(category) {
          if (!category) return;
          
          const element = document.getElementById(`category-${category}`);
          if (element) {
            // Scroll con offset para el header sticky
            const offset = 80;
            const elementPosition = element.getBoundingClientRect().top + window.pageYOffset;
            const offsetPosition = elementPosition - offset;

            window.scrollTo({
              top: offsetPosition,
              behavior: 'smooth'
            });

            // Actualizar estado activo en navegación
            if (iconsCategoryNav) {
              iconsCategoryNav.querySelectorAll('.side-link').forEach(link => {
                link.classList.toggle('active', link.getAttribute('data-category') === category);
              });
            }
          } else {
            console.warn(`No se encontró sección para la categoría: ${category}`);
          }
        }

        // Event listeners
        if (iconsSearchInput) {
          iconsSearchInput.addEventListener('input', (e) => {
            filterIcons(e.target.value);
            iconsClearSearch.style.display = e.target.value ? 'block' : 'none';
          });
        }

        if (iconsClearSearch) {
          iconsClearSearch.addEventListener('click', () => {
            iconsSearchInput.value = '';
            filterIcons('');
            iconsClearSearch.style.display = 'none';
            iconsSearchInput.focus();
          });
        }

        // Inicializar cuando se muestre la sección
        const iconosSection = document.getElementById('section-iconos');
        if (iconosSection) {
          // Cargar inmediatamente si ya está visible
          if (iconosSection.style.display !== 'none') {
            console.log('🔄 Sección iconos visible, cargando catálogo...');
            loadIconsCatalog();
          }

          // Observer para cuando se muestre la sección
          const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
              if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const isVisible = iconosSection.style.display !== 'none';
                if (isVisible && allIcons.length === 0) {
                  console.log('🔄 Sección iconos ahora visible, cargando catálogo...');
                  loadIconsCatalog();
                }
              }
            });
          });
          observer.observe(iconosSection, { attributes: true, attributeFilter: ['style'] });
        } else {
          console.error('❌ section-iconos no encontrada en el DOM');
        }

        // También intentar cargar cuando se hace click en el menú
        document.addEventListener('click', (e) => {
          const link = e.target.closest('a[data-target="section-iconos"]');
          if (link && allIcons.length === 0) {
            setTimeout(() => {
              console.log('🔄 Click en iconos detectado, cargando catálogo...');
              loadIconsCatalog();
            }, 100);
          }
        });
      })();

      // ========================================
      // SISTEMA DE INVENTARIO DE COMPONENTES
      // ========================================
      (function initComponentsInventory() {
        const componentsContainer = document.getElementById('components-container');
        const componentsNav = document.getElementById('components-nav');
        
        if (!componentsContainer) {
          console.error('❌ components-container no encontrado');
          return;
        }
        
        if (!componentsNav) {
          console.error('❌ components-nav no encontrado');
          return;
        }

        // Inventario simplificado: Solo Button y Badge
        const componentsInventory = {
          'UI': [
            {
              name: 'Button',
              description: 'Componente de botón con múltiples variantes, tamaños y estados. Incluye preview interactivo.',
              files: {
                css: 'addons/button/src/styles/button.css',
                ts: 'addons/button/src/ButtonComponent.ts'
              },
              variants: ['primary', 'secondary', 'tertiary'],
              sizes: ['xs', 'sm', 'md', 'lg', 'xl'],
              states: ['default', 'hover', 'active', 'focus', 'disabled', 'loading'],
              modifiers: ['icon-only', 'full-width', 'block', 'icon-right'],
              features: ['5 variantes', '5 tamaños', '6 estados', 'Badge opcional', 'Loading spinner'],
              class: 'ubits-button ubits-button--{variant} ubits-button--{size}',
              example: '<button class="ubits-button ubits-button--primary ubits-button--md">\n  <i class="far fa-check"></i>\n  <span>Texto</span>\n</button>',
              hasPreview: true // Flag para identificar que tiene preview interactivo
            },
            {
              name: 'Badge',
              description: 'Componente de badge para mostrar notificaciones, contadores o indicadores. Puede usarse standalone o dentro de botones.',
              files: {
                css: 'addons/badge/src/styles/badge.css',
                ts: 'addons/badge/src/index.ts'
              },
              variants: ['primary', 'secondary', 'success', 'warning', 'error', 'info'],
              sizes: ['xs', 'sm', 'md', 'lg'],
              features: ['Badge standalone', 'Badge en botones', 'Badge con contenido', 'Solo bolita (dot)', 'Con números', 'Posición absoluta'],
              class: 'ubits-badge ubits-badge--{size} ubits-badge--{variant}',
              example: '<!-- Standalone con número -->\n<span class="ubits-badge ubits-badge--md">5</span>\n\n<!-- Solo bolita -->\n<span class="ubits-badge ubits-badge--dot"></span>\n\n<!-- En botón -->\n<button class="ubits-button ubits-button--primary">\n  <span>Notificaciones</span>\n  <span class="ubits-button__badge"></span>\n</button>',
              hasPreview: true // Flag para identificar que tiene preview interactivo
            },
            {
              name: 'Alert',
              description: 'Componente de alert para mostrar notificaciones del sistema con diferentes variantes (success, info, warning, error).',
              files: {
                css: 'addons/alert/src/styles/alert.css',
                ts: 'addons/alert/src/AlertComponent.ts'
              },
              variants: ['success', 'info', 'warning', 'error'],
              sizes: [],
              states: ['default', 'closing'],
              features: ['4 variantes', 'Botón cerrar opcional', 'Cierre automático', 'Animaciones', 'Responsive'],
              class: 'ubits-alert ubits-alert--{type}',
              example: '<div class="ubits-alert ubits-alert--success">\n  <div class="ubits-alert__icon">\n    <i class="far fa-check-circle"></i>\n  </div>\n  <div class="ubits-alert__content">\n    <div class="ubits-alert__text">Mensaje del alert</div>\n  </div>\n  <button class="ubits-alert__close">\n    <i class="far fa-times"></i>\n  </button>\n</div>',
              hasPreview: true // Flag para identificar que tiene preview interactivo
            },
            {
              name: 'Toast',
              description: 'Notificaciones flotantes que aparecen arriba al centro. Auto-cierre con duraciones por tipo, pausa en hover, apilado inteligente.',
              files: {
                css: 'addons/toast/src/styles/toast.css',
                ts: 'addons/toast/src/ToastProvider.ts'
              },
              variants: ['success', 'info', 'warning', 'error'],
              sizes: [],
              states: ['default', 'enter', 'exit'],
              features: ['4 variantes', 'Auto-cierre por tipo (3.5s-6.5s)', 'Pausa en hover/focus', 'Apilado (max 3)', 'Botón acción opcional', 'Timer inteligente'],
              class: 'ubits-toast ubits-toast--{type}',
              example: 'showToast(\'success\', \'¡Operación exitosa!\');',
              hasPreview: true // Flag para identificar que tiene preview interactivo
            },
            {
              name: 'Input',
              description: 'Componente de input con 11 tipos, 4 tamaños, 6 estados y funcionalidades especiales. Incluye password toggle, search clear, autocomplete, select scroll infinito y calendar picker.',
              files: {
                css: 'addons/input/src/styles/input.css',
                ts: 'addons/input/src/InputComponent.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: ['default', 'hover', 'focus', 'active', 'invalid', 'disabled'],
              types: ['text', 'email', 'password', 'number', 'tel', 'url', 'select', 'textarea', 'search', 'autocomplete', 'calendar'],
              features: ['11 tipos de input', '4 tamaños', '6 estados', 'Iconos izquierdo/derecho', 'Helper text y contador', 'Mandatory/optional', 'Password toggle', 'Search clear', 'Autocomplete', 'Select scroll infinito', 'Calendar picker'],
              class: 'ubits-input ubits-input--{size} ubits-input--{state}',
              example: '<div id="input-container">\n  <label class="ubits-input-label">Label</label>\n  <div style="position: relative;">\n    <input type="text" class="ubits-input ubits-input--md" placeholder="Placeholder" />\n  </div>\n  <div class="ubits-input-helper">\n    <span>Helper text</span>\n    <span class="ubits-input-counter">0/50</span>\n  </div>\n</div>',
              hasPreview: true
            },
            {
              name: 'List',
              description: 'Componente de lista con estados (default, hover, active, disabled). Soporta scrollbar, navegación por teclado y selección simple o múltiple.',
              files: {
                css: 'addons/list/src/styles/list.css',
                ts: 'addons/list/src/ListComponent.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['4 tamaños (xs, sm, md, lg)', '4 estados', 'Scrollbar personalizado', 'Navegación por teclado', 'Selección simple/múltiple', 'Accesibilidad completa (ARIA)', 'Modo oscuro'],
              class: 'ubits-list ubits-list-item ubits-list-item--{state}',
              example: '<div class="ubits-list" role="list">\n  <div class="ubits-list-item" role="listitem">Label</div>\n  <div class="ubits-list-item ubits-list-item--active" role="listitem">Label</div>\n  <div class="ubits-list-item ubits-list-item--disabled" role="listitem">Label</div>\n</div>',
              hasPreview: true
            },
            {
              name: 'Sidebar',
              description: 'Componente de navegación lateral con 2 variantes (default/colaborador y admin). Incluye tooltips, menú de perfil, dark mode toggle y ajuste dinámico de altura.',
              files: {
                css: 'addons/sidebar/src/styles/sidebar.css',
                ts: 'addons/sidebar/src/SidebarProvider.ts'
              },
              variants: ['default', 'admin'],
              sizes: [],
              states: ['default', 'hover', 'active', 'pressed', 'disabled', 'focus'],
              features: ['2 variantes (default/admin)', '8 botones body (default) / 6 botones body (admin)', 'Tooltips dinámicos', 'Menú de perfil con hover', 'Dark mode toggle con animación', 'Altura dinámica', 'Avatar de usuario', '6 estados por botón', 'Ancho fijo 96px', 'Colores fijos (no cambian con tema)'],
              class: 'ubits-sidebar ubits-sidebar-nav-button ubits-sidebar-nav-button--active',
              example: 'createSidebar({\n  containerId: \'sidebar-container\',\n  variant: \'default\',\n  bodyButtons: [...],\n  footerButtons: [...],\n  profileMenuItems: [...]\n})',
              hasPreview: true
            }
          ]
        };
        
        // Componente activo actualmente
        let activeComponent = null;

        // Generar navegación lateral de componentes (REESCRITO COMPLETAMENTE)
        function generateComponentsNav() {
          console.log('🔄 generateComponentsNav llamado');
          
          // Re-obtener el elemento por si cambió
          const nav = document.getElementById('components-nav');
          if (!nav) {
            console.error('❌ components-nav NO encontrado en DOM');
            return false;
          }

          console.log('✅ components-nav encontrado, generando navegación...');

          const categories = Object.keys(componentsInventory);
          let navHTML = '';

          categories.forEach((category, catIndex) => {
            const components = componentsInventory[category];
            
            // Agregar título de categoría (siempre al inicio de cada categoría)
            navHTML += `<div class="side-title" style="margin-top: ${catIndex > 0 ? '16px' : '0'}; margin-bottom: 8px;">${category}</div>`;
            
            // Generar los links para cada componente
            components.forEach((component) => {
              const componentId = component.name.toLowerCase().replace(/\s+/g, '-');
              
              navHTML += `
                <a href="#component-${componentId}" 
                   class="side-link" 
                   data-component="${componentId}"
                   onclick="handleComponentNavClick(event, '${componentId}')">
                  ${component.name}
                </a>
              `;
            });
          });

          nav.innerHTML = navHTML;
          const linkCount = nav.querySelectorAll('.side-link').length;
          console.log(`✅ Navegación generada: ${linkCount} links creados`);

          // Agregar event listeners con delegación de eventos (más robusto)
          nav.addEventListener('click', function(e) {
            const link = e.target.closest('.side-link');
            if (link) {
              e.preventDefault();
              e.stopPropagation();
              const componentId = link.getAttribute('data-component');
              console.log('🔗 Click detectado en componente:', componentId);
              if (componentId) {
                handleComponentNavClick(e, componentId);
              }
            }
          });

          return true;
        }
        
        // Función global para manejar clicks en navegación (más robusta)
        // Función para cargar dinámicamente un componente (como los colores)
        function loadComponent(componentId) {
          console.log('📦 Cargando componente:', componentId);
          
          // Ocultar todos los componentes
          document.querySelectorAll('[id^="component-"]').forEach(el => {
            el.style.display = 'none';
          });
          
          // Buscar y mostrar el componente solicitado
          const component = Object.values(componentsInventory).flat().find(c => {
            const id = c.name.toLowerCase().replace(/\s+/g, '-');
            return id === componentId;
          });
          
          if (component) {
            const componentElement = document.getElementById(`component-${componentId}`);
            if (componentElement) {
              componentElement.style.display = '';
              
              // Si tiene preview, inicializarlo
              if (component.hasPreview) {
                setTimeout(() => {
                  if (componentId === 'button' && typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  } else if (componentId === 'badge' && typeof window.updateBadgePreview === 'function') {
                    window.updateBadgePreview('badge');
                  } else if (componentId === 'alert' && typeof window.updateAlertPreview === 'function') {
                    window.updateAlertPreview('alert');
                    initializeAlertPreview('alert');
                  } else if (componentId === 'toast') {
                    // Toast se inicializa automáticamente cuando se hace clic en los botones
                    ensureToastContainer();
                  } else if (componentId === 'input' && typeof window.updateInputPreview === 'function') {
                    window.updateInputPreview('input');
                  } else if (componentId === 'list' && typeof window.updateListPreview === 'function') {
                    window.updateListPreview('list');
                  } else if (componentId === 'sidebar' && typeof window.updateSidebarPreview === 'function') {
                    window.updateSidebarPreview('sidebar');
                  }
                }, 100);
              }
              
              // Scroll al componente
              setTimeout(() => {
                componentElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
              }, 50);
              
              activeComponent = componentId;
              return true;
            } else {
              console.error('❌ Elemento del componente no encontrado:', `component-${componentId}`);
              return false;
            }
          } else {
            console.error('❌ Componente no encontrado en inventario:', componentId);
            return false;
          }
        }
        
        window.handleComponentNavClick = function(event, componentId) {
          console.log('🎯 handleComponentNavClick llamado con:', componentId);
          
          if (!componentId) {
            console.error('❌ componentId no proporcionado');
            return;
          }
          
          // Prevenir comportamiento por defecto del link
          if (event) {
            event.preventDefault();
          }
          
          // Actualizar links activos
          document.querySelectorAll('.side-link').forEach(link => {
            link.classList.remove('active');
          });
          
          const clickedLink = event?.target?.closest('.side-link');
          if (clickedLink) {
            clickedLink.classList.add('active');
          }
          
          // Cargar el componente dinámicamente (como los colores)
          loadComponent(componentId);
        }

        // Scroll a componente (mantenido por compatibilidad)
        function scrollToComponent(componentId) {
          console.log('📜 scrollToComponent llamado para:', componentId);
          
          if (!componentId) {
            console.error('❌ componentId no proporcionado');
            return;
          }
          
          const elementId = `component-${componentId}`;
          console.log('🔍 Buscando elemento:', elementId);
          
          let element = document.getElementById(elementId);
          
          // Si no se encuentra, intentar después de un pequeño delay (por si aún se está renderizando)
          if (!element) {
            console.warn('⚠️ Elemento no encontrado inmediatamente, esperando 100ms...');
            setTimeout(() => {
              element = document.getElementById(elementId);
              if (element) {
                performScroll(element, componentId);
              } else {
                console.error(`❌ No se encontró elemento: ${elementId}`);
                console.log('📋 Elementos disponibles:', Array.from(document.querySelectorAll('[id^="component-"]')).map(el => el.id));
              }
            }, 100);
            return;
          }
          
          performScroll(element, componentId);
        }
        
        // Función auxiliar para realizar el scroll
        function performScroll(element, componentId) {
          console.log('📍 Realizando scroll a:', element.id);
          
          // Scroll con offset para el header sticky
          const offset = 100;
          const rect = element.getBoundingClientRect();
          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
          const elementPosition = rect.top + scrollTop;
          const offsetPosition = elementPosition - offset;

          // Múltiples métodos de scroll para máxima compatibilidad
          try {
            window.scrollTo({
              top: offsetPosition,
              behavior: 'smooth'
            });
          } catch (e) {
            window.scrollTo(0, offsetPosition);
          }
          
          // Fallback adicional
          setTimeout(() => {
            element.scrollIntoView({ 
              behavior: 'smooth', 
              block: 'start', 
              inline: 'nearest' 
            });
          }, 50);
          
          // Resaltar el elemento (opcional, ayuda visual)
          element.style.transition = 'box-shadow 0.3s ease';
          element.style.boxShadow = '0 0 0 3px rgba(37, 99, 235, 0.3)';
          setTimeout(() => {
            element.style.boxShadow = '';
          }, 1000);
          
          // Si es Button, inicializar el preview después del scroll
          if (componentId === 'button') {
            console.log('🎯 Componente Button detectado, inicializando preview...');
            setTimeout(() => {
              const buttonPreview = document.getElementById('button-preview-button');
              console.log('🔍 Preview encontrado después de scroll:', buttonPreview ? '✅' : '❌');
              
              if (buttonPreview) {
                const hasContent = buttonPreview.innerHTML.trim() !== '' && buttonPreview.querySelector('.ubits-button');
                console.log('📋 Preview tiene contenido:', hasContent);
                
                if (!hasContent) {
                  console.log('🔄 Inicializando preview de Button después de scroll...');
                  if (typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  } else {
                    console.error('❌ window.updateButtonPreview no está disponible');
                  }
                } else {
                  console.log('✅ Preview ya tiene contenido');
                }
              } else {
                console.warn('⚠️ Preview no encontrado, reintentando...');
                setTimeout(() => {
                  const retry = document.getElementById('button-preview-button');
                  if (retry && retry.innerHTML.trim() === '') {
                    if (typeof window.updateButtonPreview === 'function') {
                      window.updateButtonPreview('button');
                    }
                  }
                }, 300);
              }
            }, 600);
          }
        }

        // Renderizar inventario de componentes
        function renderComponents() {
          if (!componentsContainer) {
            console.error('❌ components-container no encontrado en renderComponents');
            return;
          }
          
          console.log('🎨 ========== INICIANDO RENDERIZADO DE COMPONENTES ==========');
          console.log('📦 Contenedor:', componentsContainer);
          console.log('📦 Contenedor ID:', componentsContainer.id);
          console.log('📦 Contenedor padre:', componentsContainer.parentElement?.id || 'N/A');

          const categories = Object.keys(componentsInventory);
          console.log('📊 Categorías encontradas:', categories);
          console.log('📊 Inventario completo:', componentsInventory);
          
          const htmlString = categories.map(category => {
            const components = componentsInventory[category];
            return `
              <div class="kcard" style="margin-bottom: 32px;">
                <h2 style="margin-bottom: 24px; color: var(--ubits-fg-1-high); font-size: 24px; font-weight: 600; border-bottom: 2px solid var(--ubits-border-1); padding-bottom: 12px;">
                  ${category}
                </h2>
                <div class="kstack" style="gap: 24px;">
                  ${components.map(component => {
                    const componentId = component.name.toLowerCase().replace(/\s+/g, '-');
                    const hasPreview = component.hasPreview === true;
                    return `
                    <div id="component-${componentId}" style="border: 1px solid var(--ubits-border-1); border-radius: 12px; padding: 24px; background: var(--ubits-bg-1); scroll-margin-top: 80px;">
                      <div style="display: flex; align-items: start; justify-content: space-between; margin-bottom: 16px;">
                        <div>
                          <h3 style="margin: 0 0 8px 0; color: var(--ubits-fg-1-high); font-size: 20px; font-weight: 600;">
                            ${component.name}
                          </h3>
                          <p style="margin: 0; color: var(--ubits-fg-1-medium); font-size: 14px; line-height: 1.5;">
                            ${component.description}
                          </p>
                        </div>
                      </div>
                      
                      ${hasPreview && component.name === 'Button' ? `
                        <!-- Preview Section for Button - REDISEÑADO -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="primary" onclick="setButtonControl('variant', 'primary', '${componentId}')">
                                    <span>Primario</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="secondary" onclick="setButtonControl('variant', 'secondary', '${componentId}')">
                                    <span>Secundario</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="tertiary" onclick="setButtonControl('variant', 'tertiary', '${componentId}')">
                                    <span>Terciario</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Tamaño -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tamaño</label>
                                <select id="size-select-${componentId}" onchange="setButtonControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer;">
                                  <option value="xs">XS (24px)</option>
                                  <option value="sm">SM (32px)</option>
                                  <option value="md" selected>MD (40px)</option>
                                  <option value="lg">LG (48px)</option>
                                </select>
                              </div>
                              
                              <!-- Icono -->
                              <div style="flex: 1 1 auto; min-width: 280px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="icon" data-value="left" onclick="setButtonControl('icon', 'left', '${componentId}')">
                                    <i class="far fa-align-left" style="font-size: 12px;"></i>
                                    <span>Izquierda</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="icon" data-value="right" onclick="setButtonControl('icon', 'right', '${componentId}')">
                                    <i class="far fa-align-right" style="font-size: 12px;"></i>
                                    <span>Derecha</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="icon" data-value="only" onclick="setButtonControl('icon', 'only', '${componentId}')">
                                    <i class="far fa-circle" style="font-size: 12px;"></i>
                                    <span>Solo Icono</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="icon" data-value="none" onclick="setButtonControl('icon', 'none', '${componentId}')">
                                    <span>Sin Icono</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Badge -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Badge</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="switch" style="position: relative; display: inline-block; width: 48px; height: 26px;">
                                    <input type="checkbox" id="badge-toggle-${componentId}" onchange="setButtonControl('badge', this.checked ? 'yes' : 'no', '${componentId}')" style="opacity: 0; width: 0; height: 0;">
                                    <span class="slider" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--ubits-border-1); transition: .4s; border-radius: 26px;">
                                      <span style="position: absolute; content: ''; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.1);"></span>
                                    </span>
                                  </label>
                                  <span id="badge-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Loading -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Cargando</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="switch" style="position: relative; display: inline-block; width: 48px; height: 26px;">
                                    <input type="checkbox" id="loading-toggle-${componentId}" onchange="setButtonControl('loading', this.checked ? 'yes' : 'no', '${componentId}')" style="opacity: 0; width: 0; height: 0;">
                                    <span class="slider" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--ubits-border-1); transition: .4s; border-radius: 26px;">
                                      <span style="position: absolute; content: ''; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.1);"></span>
                                    </span>
                                  </label>
                                  <span id="loading-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Dropdown -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Dropdown</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="switch" style="position: relative; display: inline-block; width: 48px; height: 26px;">
                                    <input type="checkbox" id="dropdown-toggle-${componentId}" onchange="setButtonControl('dropdown', this.checked ? 'yes' : 'no', '${componentId}')" style="opacity: 0; width: 0; height: 0;">
                                    <span class="slider" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--ubits-border-1); transition: .4s; border-radius: 26px;">
                                      <span style="position: absolute; content: ''; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.1);"></span>
                                    </span>
                                  </label>
                                  <span id="dropdown-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="button-preview-${componentId}">
                              <!-- Se generará dinámicamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Badge' ? `
                        <!-- Preview Section for Badge -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Tipo (Dot vs Number) -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tipo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="type" data-value="number" onclick="setBadgeControl('type', 'number', '${componentId}')">
                                    <span>Con Número</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="dot" onclick="setBadgeControl('type', 'dot', '${componentId}')">
                                    <span>Solo Bolita</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="primary" onclick="setBadgeControl('variant', 'primary', '${componentId}')">
                                    <span>Primario</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="success" onclick="setBadgeControl('variant', 'success', '${componentId}')">
                                    <span>Éxito</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="warning" onclick="setBadgeControl('variant', 'warning', '${componentId}')">
                                    <span>Advertencia</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="error" onclick="setBadgeControl('variant', 'error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="info" onclick="setBadgeControl('variant', 'info', '${componentId}')">
                                    <span>Info</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Tamaño -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tamaño</label>
                                <select id="badge-size-select-${componentId}" onchange="setBadgeControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- Contenido (solo si es tipo number) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Contenido</label>
                                <input type="text" id="badge-content-input-${componentId}" value="5" onchange="setBadgeControl('content', this.value, '${componentId}')" placeholder="5" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="badge-preview-${componentId}">
                              <!-- Se generará dinámicamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Alert' ? `
                        <!-- Preview Section for Alert -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Tipo (Success, Info, Warning, Error) -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tipo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="type" data-value="success" onclick="setAlertControl('type', 'success', '${componentId}')">
                                    <span>Success</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="info" onclick="setAlertControl('type', 'info', '${componentId}')">
                                    <span>Info</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="warning" onclick="setAlertControl('type', 'warning', '${componentId}')">
                                    <span>Warning</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="error" onclick="setAlertControl('type', 'error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Mensaje -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mensaje</label>
                                <input type="text" id="alert-message-input-${componentId}" value="Los cambios se han guardado correctamente." onchange="setAlertControl('message', this.value, '${componentId}')" placeholder="Mensaje del alert" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                              
                              <!-- Closable -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Botón Cerrar</label>
                                <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" id="alert-closable-toggle-${componentId}" checked onchange="setAlertControl('closable', this.checked, '${componentId}')">
                                  <span class="slider"></span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px; min-height: 120px;">
                            <div id="alert-preview-${componentId}">
                              <!-- Se generará dinámicamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Toast' ? `
                        <!-- Preview Section for Toast -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Tipo (Success, Info, Warning, Error) -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tipo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="type" data-value="success" onclick="showToastPreview('success', '${componentId}')">
                                    <span>Success</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="info" onclick="showToastPreview('info', '${componentId}')">
                                    <span>Info</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="warning" onclick="showToastPreview('warning', '${componentId}')">
                                    <span>Warning</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="error" onclick="showToastPreview('error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Mensaje -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mensaje</label>
                                <input type="text" id="toast-message-input-${componentId}" value="¡Operación exitosa!" onchange="setToastMessage(this.value, '${componentId}')" placeholder="Mensaje del toast" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                              
                              <!-- Botón de Acción -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Botón Acción</label>
                                <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" id="toast-action-toggle-${componentId}" onchange="setToastControl('action', this.checked, '${componentId}')">
                                  <span class="slider"></span>
                                  <span id="toast-action-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px; min-height: 120px; position: relative;">
                            <p style="text-align: center; color: var(--ubits-fg-1-medium); margin: 0; font-size: 14px;">
                              Haz clic en los botones de tipo arriba para mostrar toasts en tiempo real. Los toasts aparecerán arriba al centro de la pantalla.
                            </p>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Input' ? `
                        <!-- Preview Section for Input -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: start;">
                              <!-- Columna Izquierda -->
                              <div style="display: flex; flex-direction: column; gap: 20px; align-items: stretch;">
                                <!-- Label -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Label</label>
                                  <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" id="input-label-toggle-${componentId}" checked onchange="setInputControl('showLabel', this.checked, '${componentId}')">
                                    <span class="slider"></span>
                                    <span id="input-label-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-label-input-${componentId}" value="Label" onchange="setInputControl('label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Helper Text -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Helper Text</label>
                                  <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" id="input-helper-toggle-${componentId}" checked onchange="setInputControl('showHelper', this.checked, '${componentId}')">
                                    <span class="slider"></span>
                                    <span id="input-helper-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-helper-input-${componentId}" value="Helper text" onchange="setInputControl('helperText', this.value, '${componentId}')" placeholder="Helper text" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Left Icon -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Left Icon</label>
                                  <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" id="input-lefticon-toggle-${componentId}" checked onchange="setInputControl('leftIcon', this.checked ? 'user' : '', '${componentId}')">
                                    <span class="slider"></span>
                                    <span id="input-lefticon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-lefticon-input-${componentId}" value="user" onchange="setInputControl('leftIcon', this.value, '${componentId}')" placeholder="fa-user" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Size -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Size</label>
                                  <select id="input-size-select-${componentId}" onchange="setInputControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                    <option value="xs">XS (28px)</option>
                                    <option value="sm">SM (32px)</option>
                                    <option value="md" selected>MD (40px)</option>
                                    <option value="lg">LG (48px)</option>
                                  </select>
                                </div>
                                
                                <!-- Type -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Type</label>
                                  <select id="input-type-select-${componentId}" onchange="setInputControl('type', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                    <option value="text" selected>Text</option>
                                    <option value="email">Email</option>
                                    <option value="password">Password</option>
                                    <option value="number">Number</option>
                                    <option value="tel">Tel</option>
                                    <option value="url">URL</option>
                                    <option value="select">Select</option>
                                    <option value="textarea">Textarea</option>
                                    <option value="search">Search</option>
                                    <option value="autocomplete">Autocomplete</option>
                                    <option value="calendar">Calendar</option>
                                  </select>
                                </div>
                              </div>
                              
                              <!-- Columna Derecha -->
                              <div style="display: flex; flex-direction: column; gap: 20px; align-items: stretch;">
                                <!-- Mandatory/Optional -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Mandatory/Optional</label>
                                  <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" id="input-mandatory-toggle-${componentId}" onchange="setInputControl('mandatory', this.checked, '${componentId}')">
                                    <span class="slider"></span>
                                    <span id="input-mandatory-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                  </label>
                                  <select id="input-mandatory-type-select-${componentId}" onchange="setInputControl('mandatoryType', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                    <option value="obligatorio">Obligatorio</option>
                                    <option value="opcional" selected>Opcional</option>
                                  </select>
                                </div>
                                
                                <!-- Character Counter -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Character Counter</label>
                                  <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" id="input-counter-toggle-${componentId}" checked onchange="setInputControl('showCounter', this.checked, '${componentId}')">
                                    <span class="slider"></span>
                                    <span id="input-counter-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="number" id="input-maxlength-input-${componentId}" value="50" onchange="setInputControl('maxLength', parseInt(this.value), '${componentId}')" placeholder="50" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Right Icon -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Right Icon</label>
                                  <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" id="input-righticon-toggle-${componentId}" checked onchange="setInputControl('rightIcon', this.checked ? 'check' : '', '${componentId}')">
                                    <span class="slider"></span>
                                    <span id="input-righticon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-righticon-input-${componentId}" value="check" onchange="setInputControl('rightIcon', this.value, '${componentId}')" placeholder="fa-check" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- State -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">State</label>
                                  <select id="input-state-select-${componentId}" onchange="setInputControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                    <option value="default" selected>Default</option>
                                    <option value="hover">Hover</option>
                                    <option value="focus">Focus</option>
                                    <option value="active">Active</option>
                                    <option value="invalid">Invalid</option>
                                    <option value="disabled">Disabled</option>
                                  </select>
                                </div>
                                
                                <!-- Placeholder -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Placeholder</label>
                                  <label class="switch" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" id="input-placeholder-toggle-${componentId}" checked onchange="setInputControl('placeholder', this.checked ? 'Placeholder text' : '', '${componentId}')">
                                    <span class="slider"></span>
                                    <span id="input-placeholder-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-placeholder-input-${componentId}" value="Placeholder text" onchange="setInputControl('placeholder', this.value, '${componentId}')" placeholder="Placeholder text" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px; min-height: 200px;">
                            <div id="input-preview-${componentId}">
                              <!-- Se generará dinámicamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'List' ? `
                        <!-- Preview Section for List -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Size -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Tamaño</label>
                                <select id="list-size-select-${componentId}" onchange="setListControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                  <option value="xs">XS (28px)</option>
                                  <option value="sm">SM (32px)</option>
                                  <option value="md" selected>MD (40px)</option>
                                  <option value="lg">LG (48px)</option>
                                </select>
                              </div>
                              
                              <!-- Item 1 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 1 Estado</label>
                                <select id="list-item1-state-select-${componentId}" onchange="setListControl('item1State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Item 2 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 2 Estado</label>
                                <select id="list-item2-state-select-${componentId}" onchange="setListControl('item2State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                  <option value="default">Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active" selected>Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Item 3 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 3 Estado</label>
                                <select id="list-item3-state-select-${componentId}" onchange="setListControl('item3State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                  <option value="default">Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled" selected>Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Item 4 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 4 Estado</label>
                                <select id="list-item4-state-select-${componentId}" onchange="setListControl('item4State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Max Height -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Altura Máxima</label>
                                <input type="text" id="list-maxheight-input-${componentId}" value="400px" onchange="setListControl('maxHeight', this.value, '${componentId}')" placeholder="400px" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 300px;">
                            <div id="list-preview-${componentId}" style="width: 100%; max-width: 400px;">
                              <!-- Se generará dinámicamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Sidebar' ? `
                        <!-- Preview Section for Sidebar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Variante -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="default" onclick="setSidebarControl('variant', 'default', '${componentId}')">
                                    <span>Default</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="admin" onclick="setSidebarControl('variant', 'admin', '${componentId}')">
                                    <span>Admin</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Botón Activo (Default) -->
                              <div id="sidebar-active-default-${componentId}" style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Botón Activo</label>
                                <select id="sidebar-active-button-default-${componentId}" onchange="setSidebarControl('activeButton', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                  <option value="">Ninguno</option>
                                  <option value="admin">Administrador</option>
                                  <option value="aprendizaje">Aprendizaje</option>
                                  <option value="diagnóstico">Diagnóstico</option>
                                  <option value="desempeño">Desempeño</option>
                                  <option value="encuestas">Encuestas</option>
                                  <option value="reclutamiento">Reclutamiento</option>
                                  <option value="tareas">Tareas</option>
                                  <option value="ubits-ai">UBITS AI</option>
                                </select>
                              </div>
                              
                              <!-- Botón Activo (Admin) -->
                              <div id="sidebar-active-admin-${componentId}" style="display: none; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Botón Activo</label>
                                <select id="sidebar-active-button-admin-${componentId}" onchange="setSidebarControl('activeButton', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;">
                                  <option value="">Ninguno</option>
                                  <option value="inicio">Inicio</option>
                                  <option value="empresa">Empresa</option>
                                  <option value="aprendizaje">Aprendizaje</option>
                                  <option value="diagnóstico">Diagnóstico</option>
                                  <option value="desempeño">Desempeño</option>
                                  <option value="encuestas">Encuestas</option>
                                </select>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: 1px solid var(--ubits-border-1); margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 650px; position: relative;">
                            <div id="sidebar-preview-${componentId}" style="position: relative;">
                              <!-- Se generará dinámicamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      <!-- INFORMACIÓN DEL COMPONENTE -->
                      <div style="margin-top: 32px; padding-top: 32px; border-top: 2px solid var(--ubits-border-1);">
                        <h4 style="margin: 0 0 24px 0; color: var(--ubits-fg-1-high); font-size: 18px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                          <i class="far fa-info-circle" style="color: var(--ubits-accent-brand);"></i>
                          Información del Componente
                        </h4>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                          ${component.files ? `
                            <div style="background: var(--ubits-bg-2); padding: 20px; border-radius: 12px; border: 1px solid var(--ubits-border-1);">
                              <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; display: flex; align-items: center; gap: 6px;">
                                <i class="far fa-file-code" style="font-size: 14px;"></i>
                                Archivos
                              </div>
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                ${Object.entries(component.files).map(([type, path]) => `
                                  <div style="display: flex; align-items: start; gap: 8px; padding: 10px; background: var(--ubits-bg-1); border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                                    <span style="font-size: 11px; font-weight: 600; color: var(--ubits-accent-brand); text-transform: uppercase; min-width: 50px;">${type}</span>
                                    <code style="font-size: 13px; color: var(--ubits-fg-1-high); font-family: 'Monaco', 'Menlo', monospace; flex: 1; word-break: break-all;">${path}</code>
                                  </div>
                                `).join('')}
                              </div>
                            </div>
                          ` : ''}
                        </div>
                      </div>
                      
                      
                      ${component.competencies ? `
                          <div style="grid-column: 1 / -1;">
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Competencias (35)
                            </div>
                            <div style="font-size: 12px; color: var(--ubits-fg-1-high); max-height: 200px; overflow-y: auto; padding: 8px; background: var(--ubits-bg-2); border-radius: 6px; border: 1px solid var(--ubits-border-1); display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 4px;">
                              ${component.competencies.map(c => `<div style="padding: 2px 0;">• ${c}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.providers ? `
                          <div style="grid-column: 1 / -1;">
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Proveedores (18)
                            </div>
                            <div style="font-size: 12px; color: var(--ubits-fg-1-high); max-height: 150px; overflow-y: auto; padding: 8px; background: var(--ubits-bg-2); border-radius: 6px; border: 1px solid var(--ubits-border-1); display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 4px;">
                              ${component.providers.map(p => `<div style="padding: 2px 0;">• ${p}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.levels ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Niveles
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.levels.map(l => `<div style="padding: 4px 0;">• ${l}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.durations ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Duraciones
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.durations.map(d => `<div style="padding: 4px 0;">• ${d}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.languages ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Idiomas
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.languages.map(l => `<div style="padding: 4px 0;">• ${l}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.statuses ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Estados
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.statuses.map(s => `<div style="padding: 4px 0;">• ${s}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        </div>
                      </div>
                      
                    </div>
                  `;
                  }).join('')}
                </div>
              </div>
            `;
          }).join('');
          
          console.log('✅ HTML generado, longitud:', htmlString.length);
          
          // Verificar que el HTML contiene el componente Button ANTES de asignar
          const htmlContainsButton = htmlString.includes('component-button');
          console.log('🔍 HTML generado contiene component-button:', htmlContainsButton);
          
          if (!htmlContainsButton) {
            console.error('❌ ERROR CRÍTICO: El HTML generado NO contiene component-button');
            console.log('📋 Buscando "Button" en HTML:', htmlString.includes('Button'));
            console.log('📋 Primeras 1000 caracteres del HTML:', htmlString.substring(0, 1000));
          } else {
            console.log('✅ HTML contiene component-button, asignando al DOM...');
          }
          
          // ASIGNAR al contenedor
          componentsContainer.innerHTML = htmlString;
          console.log('✅ HTML asignado al contenedor, longitud del innerHTML:', componentsContainer.innerHTML.length);
          
          // Ocultar todos los componentes inicialmente
          document.querySelectorAll('[id^="component-"]').forEach(el => {
            el.style.display = 'none';
          });
          
          // Verificar en el DOM después de un momento
          setTimeout(() => {
            const buttonEl = document.getElementById('component-button');
            console.log('🔍 Verificación en DOM - component-button existe:', buttonEl !== null);
            if (buttonEl) {
              console.log('✅ Elemento Button encontrado en DOM:', {
                id: buttonEl.id,
                visible: buttonEl.offsetHeight > 0,
                parent: buttonEl.parentElement?.id || 'N/A'
              });
            } else {
              console.error('❌ Elemento component-button NO encontrado en el DOM después de renderizar');
              console.log('📋 Elementos con id que contienen "component":', 
                Array.from(document.querySelectorAll('[id*="component"]')).map(el => el.id));
            }
          }, 50);
          
          // Generar navegación después de renderizar
          generateComponentsNav();
          
          // Cargar Button por defecto al inicio
          setTimeout(() => {
            if (!activeComponent) {
              loadComponent('button');
            }
          }, 200);
          
          // Inicializar preview del Button INMEDIATAMENTE después de renderizar
          setTimeout(() => {
            const buttonComponent = document.getElementById('component-button');
            const buttonPreview = document.getElementById('button-preview-button');
            
            console.log('🔍 Buscando preview de Button...');
            console.log('  - component-button:', buttonComponent ? '✅ encontrado' : '❌ no encontrado');
            console.log('  - button-preview-button:', buttonPreview ? '✅ encontrado' : '❌ no encontrado');
            
            if (buttonPreview) {
              const hasContent = buttonPreview.innerHTML.trim() !== '' && buttonPreview.querySelector('.ubits-button');
              console.log('  - Preview tiene contenido:', hasContent);
              
              if (!hasContent) {
                console.log('✅ Inicializando preview de Button después de render...');
                if (typeof window.updateButtonPreview === 'function') {
                  window.updateButtonPreview('button');
                } else {
                  console.error('❌ updateButtonPreview no está disponible');
                }
              } else {
                console.log('✅ Preview ya tiene contenido');
              }
            } else {
              console.warn('⚠️ button-preview-button no encontrado después de render');
              // Intentar de nuevo después de más tiempo
              setTimeout(() => {
                const retryPreview = document.getElementById('button-preview-button');
                if (retryPreview && retryPreview.innerHTML.trim() === '') {
                  console.log('🔄 Reintentando inicialización de preview...');
                  if (typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  }
                }
              }, 500);
            }
          }, 300);
        }

        // Función para copiar código de componente
        window.copyComponentCode = function(element) {
          const code = decodeURIComponent(element.getAttribute('data-code'));
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(code).then(() => {
              showToast('Código copiado al portapapeles');
            });
          } else {
            const textArea = document.createElement('textarea');
            textArea.value = code;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            showToast('Código copiado al portapapeles');
          }
        };

        // Función para inicializar completamente (REESCRITO)
        function initializeComponentsSection() {
          console.log('🚀 ========== INICIALIZANDO SECCIÓN COMPONENTES ==========');
          
          // Re-obtener referencias por si cambió el DOM
          const container = document.getElementById('components-container');
          const nav = document.getElementById('components-nav');
          
          console.log('📦 components-container:', container ? '✅ encontrado' : '❌ NO encontrado');
          console.log('📦 components-nav:', nav ? '✅ encontrado' : '❌ NO encontrado');
          
          if (!container) {
            console.error('❌ No se puede inicializar: components-container no existe');
            return;
          }
          
          if (!nav) {
            console.error('❌ No se puede inicializar: components-nav no existe');
            return;
          }
          
          // 1. Verificar si los componentes están realmente renderizados
          const buttonElement = document.getElementById('component-button');
          const containerHTML = container.innerHTML.trim();
          
          console.log('📊 Estado del contenedor:', {
            tieneHTML: containerHTML.length > 0,
            tieneButtonElement: buttonElement !== null,
            longitudHTML: containerHTML.length
          });
          
          // Si no existe el elemento button, forzar renderizado
          if (!buttonElement || containerHTML.length === 0) {
            console.log('🔄 Forzando renderizado de componentes (elemento no encontrado o contenedor vacío)...');
            renderComponents();
            
            // Verificar después del render
            setTimeout(() => {
              const verifyButton = document.getElementById('component-button');
              if (verifyButton) {
                console.log('✅ Componente Button renderizado correctamente');
              } else {
                console.error('❌ ERROR: Componente Button NO se renderizó después de llamar renderComponents()');
              }
            }, 100);
          } else {
            console.log('✅ Contenedor ya tiene contenido válido');
          }
          
          // 2. Generar navegación (después de render, para que los elementos existan)
          if (nav.innerHTML.trim() === '' || nav.querySelectorAll('.side-link').length === 0) {
            console.log('📝 Generando navegación lateral...');
            const navGenerated = generateComponentsNav();
            if (navGenerated) {
              console.log('✅ Navegación generada exitosamente');
            } else {
              console.error('❌ Error al generar navegación');
            }
          } else {
            console.log('📝 Navegación ya existe, re-agregando listeners...');
            // Re-agregar listeners por si acaso
            nav.addEventListener('click', function(e) {
              const link = e.target.closest('.side-link');
              if (link) {
                e.preventDefault();
                const componentId = link.getAttribute('data-component');
                if (componentId) {
                  handleComponentNavClick(e, componentId);
                }
              }
            });
          }
          
          // 3. Inicializar preview del Button si existe y es visible
          setTimeout(() => {
            const buttonComponent = document.getElementById('component-button');
            const buttonPreview = document.getElementById('button-preview-button');
            
            if (buttonComponent && buttonPreview && buttonPreview.innerHTML.trim() === '') {
              console.log('🎯 Inicializando preview de Button después de inicialización...');
              if (typeof window.updateButtonPreview === 'function') {
                window.updateButtonPreview('button');
              } else {
                console.warn('⚠️ updateButtonPreview no disponible todavía, reintentando...');
                setTimeout(() => {
                  if (typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  }
                }, 500);
              }
            }
          }, 500);
          
          console.log('✅ ========== INICIALIZACIÓN COMPLETA ==========');
        }

        // Inicializar cuando se muestre la sección
        const componentesSection = document.getElementById('section-componentes');
        if (componentesSection) {
          const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
              if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const isVisible = componentesSection.style.display !== 'none';
                if (isVisible) {
                  console.log('🔄 Sección componentes visible, inicializando...');
                  setTimeout(() => initializeComponentsSection(), 50);
                }
              }
            });
          });
          observer.observe(componentesSection, { attributes: true, attributeFilter: ['style'] });

          // Inicializar inmediatamente si ya está visible
          if (componentesSection.style.display !== 'none') {
            setTimeout(() => initializeComponentsSection(), 50);
          }
        }

        // También cargar cuando se hace click en el menú
        document.addEventListener('click', (e) => {
          const link = e.target.closest('a[data-target="section-componentes"]');
          if (link) {
            setTimeout(() => {
              console.log('🔄 Click en componentes detectado, inicializando...');
              initializeComponentsSection();
            }, 150);
          }
        });
      })();
      
      // ========================================
      // BUTTON PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Button
      const buttonPreviewState = {};
      
      // Inicializar estado por componente
      function initButtonPreviewState(componentId) {
        if (!buttonPreviewState[componentId]) {
          buttonPreviewState[componentId] = {
            variant: 'primary',
            size: 'md',
            iconPosition: 'left',
            showBadge: false,
            isLoading: false,
            text: 'Botón de ejemplo',
            dropdown: false,
            dropdownOptions: [
              { label: 'Opción 1', value: 'opt1' },
              { label: 'Opción 2', value: 'opt2' },
              { label: 'Opción 3', value: 'opt3' }
            ]
          };
        }
        return buttonPreviewState[componentId];
      }
      
      // Función auxiliar para generar HTML de botón (UN SOLO BOTÓN)
      function generateButtonHTML(state, componentId) {
        const { variant, size, iconPosition, showBadge, isLoading, text, dropdown } = state;
        
        const badgeHTML = showBadge ? `<span class="ubits-button__badge"></span>` : '';
        let iconHTML = `<i class="far fa-check"></i>`;
        let spinnerHTML = `<i class="far fa-spinner loading-spinner"></i>`;
        const chevronHTML = `<i class="far fa-chevron-down"></i>`;
        
        // Determinar contenido según posición del icono
        let content = '';
        let classes = `ubits-button ubits-button--${variant} ubits-button--${size}`;
        
        // Agregar clase de loading si está activo
        if (isLoading) {
          classes += ' ubits-button--loading';
        }
        
        // Agregar clase de dropdown si está activo
        if (dropdown) {
          classes += ' ubits-button--dropdown';
        }
        
        if (iconPosition === 'only') {
          // En modo icon-only, si está loading, mostrar solo spinner
          content = isLoading ? spinnerHTML : iconHTML;
          // Si dropdown está activo, agregar chevron
          if (dropdown && !isLoading) {
            content = `${iconHTML}${chevronHTML}`;
          }
          classes += ' ubits-button--icon-only';
        } else if (iconPosition === 'none') {
          // Sin icono: mostrar texto normal, y si está loading, agregar spinner después del texto
          if (isLoading) {
            content = `<span class="button-text">${text}</span>${spinnerHTML}`;
          } else if (dropdown) {
            // Si dropdown, agregar chevron a la derecha
            content = `<span>${text}</span>${chevronHTML}`;
          } else {
            content = `<span>${text}</span>`;
          }
        } else if (iconPosition === 'right') {
          // Icono a la derecha: poner el texto primero, luego el icono/spinner
          // La clase ubits-button--icon-right aplicará flex-direction: row-reverse
          if (isLoading) {
            content = `<span class="button-text">${text}</span>${spinnerHTML}`;
          } else if (dropdown) {
            // Si dropdown, icono personalizado + texto + chevron
            content = `<span>${text}</span>${iconHTML}${chevronHTML}`;
          } else {
            content = `<span>${text}</span>${iconHTML}`;
          }
          classes += ' ubits-button--icon-right';
        } else { // left (default)
          // Icono a la izquierda: poner spinner/icono primero, luego el texto
          if (isLoading) {
            content = `${spinnerHTML}<span class="button-text">${text}</span>`;
          } else if (dropdown) {
            // Si dropdown, icono izquierdo + texto + chevron derecho
            content = `${iconHTML}<span>${text}</span>${chevronHTML}`;
          } else {
            content = `${iconHTML}<span>${text}</span>`;
          }
        }
        
        return `<button class="${classes}" ${isLoading ? 'disabled' : ''}>
          ${content}
          ${badgeHTML}
        </button>`;
      }
      
      // Función para actualizar el preview del botón (UN SOLO BOTÓN)
      window.updateButtonPreview = function(componentId) {
        const state = initButtonPreviewState(componentId);
        const preview = document.getElementById(`button-preview-${componentId}`);
        
        if (!preview) {
          console.error('❌ Preview no encontrado:', `button-preview-${componentId}`);
          return;
        }
        
        // Si dropdown está activo, usar createButton para inicializar funcionalidad
        if (state.dropdown && state.dropdownOptions && state.dropdownOptions.length > 0) {
          // Limpiar preview y crear wrapper
          preview.innerHTML = '';
          const wrapper = document.createElement('div');
          wrapper.style.position = 'relative';
          wrapper.style.display = 'inline-block';
          preview.appendChild(wrapper);
          
          // Preparar opciones para createButton
          const buttonOptions = {
            variant: state.variant,
            size: state.size,
            text: state.text,
            icon: state.iconPosition !== 'none' && state.iconPosition !== 'only' ? 'check' : undefined,
            iconStyle: 'regular',
            iconPosition: state.iconPosition === 'right' ? 'right' : 'left',
            iconOnly: state.iconPosition === 'only',
            disabled: false,
            loading: state.isLoading,
            badge: state.showBadge,
            dropdown: state.dropdown,
            dropdownOptions: state.dropdownOptions.map(opt => ({
              label: opt.label,
              value: opt.value || opt.label,
              onClick: (e, item) => {
                console.log('Dropdown option clicked:', item);
              }
            }))
          };
          
          // Usar requestAnimationFrame para asegurar que el DOM esté listo
          requestAnimationFrame(() => {
            requestAnimationFrame(() => {
              try {
                // Intentar usar createButton si está disponible
                if (typeof window.createButtonHelper === 'function') {
                  window.createButtonHelper(buttonOptions, wrapper);
                } else {
                  // Fallback: usar generateButtonHTML
                  const buttonHTML = generateButtonHTML(state, componentId);
                  wrapper.innerHTML = buttonHTML;
                }
              } catch (error) {
                console.warn('Error creating button with dropdown, using fallback:', error);
                const buttonHTML = generateButtonHTML(state, componentId);
                wrapper.innerHTML = buttonHTML;
              }
            });
          });
        } else {
          // Sin dropdown, generar HTML normalmente
          const buttonHTML = generateButtonHTML(state, componentId);
          preview.innerHTML = buttonHTML;
        }
        
        // Log para debug
        console.log('✅ Preview actualizado:', {
          size: state.size,
          variant: state.variant,
          dropdown: state.dropdown,
          classes: preview.querySelector('.ubits-button')?.className
        });
      };
      
      // Helper para crear botón con dropdown usando createButton
      window.createButtonHelper = function(options, container) {
        // Importar createButton dinámicamente o usar la implementación inline
        // Por ahora, implementamos la funcionalidad inline
        const buttonHTML = generateButtonHTML({
          variant: options.variant,
          size: options.size,
          text: options.text,
          iconPosition: options.iconOnly ? 'only' : (options.iconPosition || 'left'),
          showBadge: options.badge,
          isLoading: options.loading,
          dropdown: options.dropdown
        }, 'button');
        
        container.innerHTML = buttonHTML;
        const button = container.querySelector('button');
        
        if (!button) return;
        
        // Si dropdown está activo, crear el dropdown
        if (options.dropdown && options.dropdownOptions && options.dropdownOptions.length > 0) {
          const dropdownContainer = document.createElement('div');
          dropdownContainer.className = 'ubits-button-dropdown-container';
          dropdownContainer.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            z-index: 1000;
            margin-top: 4px;
            display: none;
            min-width: 100%;
          `;
          container.appendChild(dropdownContainer);
          
          // Mapear tamaño del botón al tamaño del List
          const listSize = options.size === 'xs' ? 'xs' : options.size === 'sm' ? 'sm' : options.size === 'md' ? 'md' : 'lg';
          
          // Convertir dropdownOptions a ListItems
          const listItems = options.dropdownOptions.map(option => ({
            label: option.label,
            state: 'default',
            value: option.value || option.label,
            selected: false
          }));
          
          let isOpen = false;
          
          const toggleDropdown = () => {
            if (isOpen) {
              dropdownContainer.style.display = 'none';
              isOpen = false;
              return;
            }
            
            // Crear o actualizar la lista usando el componente List
            const listId = `button-dropdown-${Math.random().toString(36).substr(2, 9)}`;
            dropdownContainer.id = listId;
            dropdownContainer.innerHTML = '';
            
            // Generar HTML del List manualmente
            let listHTML = `<div class="ubits-list" role="list" style="max-height: 200px;">`;
            listItems.forEach((item) => {
              listHTML += `
                <div class="ubits-list-item ubits-list-item--${listSize}" role="listitem" tabindex="0" data-value="${item.value}">
                  ${item.label}
                </div>
              `;
            });
            listHTML += '</div>';
            
            dropdownContainer.innerHTML = listHTML;
            
            // Agregar event listeners a los items
            const listItemsElements = dropdownContainer.querySelectorAll('.ubits-list-item');
            listItemsElements.forEach((itemEl, idx) => {
              const item = listItems[idx];
              if (item) {
                itemEl.addEventListener('click', () => {
                  if (options.dropdownOptions && options.dropdownOptions[idx] && options.dropdownOptions[idx].onClick) {
                    options.dropdownOptions[idx].onClick(new MouseEvent('click'), { label: item.label, value: item.value });
                  }
                  dropdownContainer.style.display = 'none';
                  isOpen = false;
                });
              }
            });
            
            dropdownContainer.style.display = 'block';
            isOpen = true;
          };
          
          button.addEventListener('click', (e) => {
            e.stopPropagation();
            if (!options.disabled && !options.loading) {
              toggleDropdown();
            }
          });
          
          // Cerrar dropdown al hacer click fuera
          document.addEventListener('click', (e) => {
            if (!container.contains(e.target)) {
              dropdownContainer.style.display = 'none';
              isOpen = false;
            }
          });
        }
      };
      
      // Nueva función unificada para todos los controles
      window.setButtonControl = function(option, value, componentId) {
        const state = initButtonPreviewState(componentId);
        
        // Actualizar estado según la opción
        if (option === 'variant') {
          state.variant = value;
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'icon') {
          state.iconPosition = value;
          // Actualizar botones activos de icono
          document.querySelectorAll(`[data-component="${componentId}"][data-option="icon"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'badge') {
          state.showBadge = value === 'yes';
          const toggle = document.getElementById(`badge-toggle-${componentId}`);
          if (toggle) toggle.checked = state.showBadge;
          
          // Actualizar texto del estado del badge
          const badgeStatus = document.getElementById(`badge-status-${componentId}`);
          if (badgeStatus) {
            badgeStatus.textContent = state.showBadge ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'loading') {
          state.isLoading = value === 'yes';
          const toggle = document.getElementById(`loading-toggle-${componentId}`);
          if (toggle) toggle.checked = state.isLoading;
          
          // Actualizar texto del estado del loading
          const loadingStatus = document.getElementById(`loading-status-${componentId}`);
          if (loadingStatus) {
            loadingStatus.textContent = state.isLoading ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'dropdown') {
          state.dropdown = value === 'yes';
          const toggle = document.getElementById(`dropdown-toggle-${componentId}`);
          if (toggle) toggle.checked = state.dropdown;
          
          // Actualizar texto del estado del dropdown
          const dropdownStatus = document.getElementById(`dropdown-status-${componentId}`);
          if (dropdownStatus) {
            dropdownStatus.textContent = state.dropdown ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        updateButtonPreview(componentId);
      };
      
      // Función para cambiar el preview del botón
      window.setButtonPreviewOption = function(option, componentId) {
        // Remover clase active de todos los botones de control de este componente
        document.querySelectorAll(`[data-component="${componentId}"].preview-control-btn`).forEach(btn => {
          btn.classList.remove('active');
        });
        
        // Agregar clase active al botón clickeado
        event.target.closest('.preview-control-btn').classList.add('active');
        
        // Deshabilitar badge toggle si está en modo disabled
        const badgeToggle = document.getElementById(`badge-toggle-${componentId}`);
        if (option === 'disabled') {
          if (badgeToggle) {
            badgeToggle.disabled = true;
            badgeToggle.checked = false;
          }
        } else {
          if (badgeToggle) badgeToggle.disabled = false;
        }
        
        // Actualizar el preview
        updateButtonPreview(option, componentId);
      };
      
      // Función para toggle de iconos
      window.toggleButtonIcons = function(componentId) {
        const activeButton = document.querySelector(`[data-component="${componentId}"].preview-control-btn.active`);
        if (activeButton) {
          const option = activeButton.textContent.trim().toLowerCase();
          if (option === 'primario') {
            updateButtonPreview(componentId);
          } else if (option === 'secundario') {
            updateButtonPreview(componentId);
          } else if (option === 'terciario') {
            updateButtonPreview(componentId);
          } else if (option === 'disabled') {
            updateButtonPreview(componentId);
          }
        }
      };
      
      // ========================================
      // BADGE PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Badge
      const badgePreviewState = {};
      
      // Inicializar estado del Badge
      function initBadgePreviewState(componentId) {
        if (!badgePreviewState[componentId]) {
          badgePreviewState[componentId] = {
            type: 'number',
            variant: 'primary',
            size: 'md',
            content: '5'
          };
        }
        return badgePreviewState[componentId];
      }
      
      // Función para generar HTML del badge
      function generateBadgeHTML(state, componentId) {
        const { type, variant, size, content } = state;
        
        const classes = [
          'ubits-badge',
          `ubits-badge--${size}`,
          `ubits-badge--${type}`,
          `ubits-badge--${variant}` // Siempre agregar la clase de variante
        ].filter(Boolean).join(' ');
        
        const badgeContent = type === 'number' && content ? String(content) : '';
        
        return `<span class="${classes}">${badgeContent}</span>`;
      }
      
      // Función para actualizar el preview del badge
      window.updateBadgePreview = function(componentId) {
        const state = initBadgePreviewState(componentId);
        const preview = document.getElementById(`badge-preview-${componentId}`);
        
        if (!preview) {
          console.error('❌ Preview de Badge no encontrado:', `badge-preview-${componentId}`);
          return;
        }
        
        const badgeHTML = generateBadgeHTML(state, componentId);
        preview.innerHTML = badgeHTML;
        
        console.log('✅ Badge preview actualizado:', {
          type: state.type,
          variant: state.variant,
          size: state.size,
          content: state.content
        });
      };
      
      // Función unificada para controles del Badge
      window.setBadgeControl = function(option, value, componentId) {
        const state = initBadgePreviewState(componentId);
        
        if (option === 'type') {
          state.type = value;
          // Actualizar botones activos de tipo
          document.querySelectorAll(`[data-component="${componentId}"][data-option="type"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          // Mostrar/ocultar input de contenido según tipo
          const contentInput = document.getElementById(`badge-content-input-${componentId}`);
          if (contentInput) {
            contentInput.style.display = value === 'number' ? 'block' : 'none';
          }
        } else if (option === 'variant') {
          state.variant = value;
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`badge-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'content') {
          state.content = value || '5';
          const input = document.getElementById(`badge-content-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        }
        
        // Actualizar preview
        updateBadgePreview(componentId);
      };
      
      // Función para toggle de badge
      window.toggleButtonBadge = function(componentId) {
        console.log('🏷️ toggleButtonBadge llamado para:', componentId);
        
        const activeButton = document.querySelector(`[data-component="${componentId}"].preview-control-btn.active`);
        const badgeToggle = document.getElementById(`badge-toggle-${componentId}`);
        
        console.log('📋 Estado del toggle badge:', {
          activeButton: activeButton ? activeButton.textContent.trim() : 'no encontrado',
          badgeToggleChecked: badgeToggle ? badgeToggle.checked : 'no encontrado'
        });
        
        if (activeButton) {
          const option = activeButton.textContent.trim().toLowerCase();
          console.log('🎯 Opción detectada:', option);
          
          // Determinar la opción correcta basada en el texto del botón activo
          let previewOption = 'primary';
          if (option === 'primario') {
            previewOption = 'primary';
          } else if (option === 'secundario') {
            previewOption = 'secondary';
          } else if (option === 'terciario') {
            previewOption = 'tertiary';
          } else if (option === 'disabled' || option === 'deshabilitado') {
            previewOption = 'disabled';
          }
          
          console.log('🔄 Actualizando preview con opción:', previewOption);
          updateButtonPreview(previewOption, componentId);
        } else {
          console.warn('⚠️ No se encontró botón activo para el componente:', componentId);
        }
      };
      
      // ========================================
      // ALERT PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Alert
      const alertPreviewState = {};
      
      // Mapeo de iconos por tipo
      const alertIconMap = {
        success: 'fa-check-circle',
        info: 'fa-info-circle',
        warning: 'fa-exclamation-triangle',
        error: 'fa-times-circle'
      };
      
      // Mensajes por defecto por tipo
      const alertMessages = {
        success: 'Los cambios se han guardado correctamente.',
        info: 'Esta es una notificación informativa del sistema.',
        warning: 'Por favor, revisa los datos antes de continuar.',
        error: 'Ha ocurrido un error al procesar la solicitud.'
      };
      
      // Inicializar estado del Alert
      function initAlertPreviewState(componentId) {
        if (!alertPreviewState[componentId]) {
          alertPreviewState[componentId] = {
            type: 'success',
            message: alertMessages.success,
            closable: true
          };
        }
        return alertPreviewState[componentId];
      }
      
      // Función para generar HTML del alert
      function generateAlertHTML(state, componentId) {
        const { type, message, closable } = state;
        
        const iconClass = alertIconMap[type] || alertIconMap.success;
        const classes = [
          'ubits-alert',
          `ubits-alert--${type}`,
          !closable && 'ubits-alert--no-close'
        ].filter(Boolean).join(' ');
        
        return `
          <div class="${classes}" role="alert" aria-live="polite">
            <div class="ubits-alert__icon">
              <i class="far ${iconClass}"></i>
            </div>
            <div class="ubits-alert__content">
              <div class="ubits-alert__text">${message}</div>
            </div>
            ${closable ? `
              <button class="ubits-alert__close" aria-label="Cerrar alerta" onclick="this.closest('.ubits-alert').classList.add('ubits-alert--closing'); setTimeout(() => this.closest('.ubits-alert')?.remove(), 300);">
                <i class="far fa-times"></i>
              </button>
            ` : ''}
          </div>
        `.trim();
      }
      
      // Función para actualizar el preview del alert
      window.updateAlertPreview = function(componentId) {
        const state = initAlertPreviewState(componentId);
        const preview = document.getElementById(`alert-preview-${componentId}`);
        
        if (!preview) {
          console.error('❌ Preview de Alert no encontrado:', `alert-preview-${componentId}`);
          return;
        }
        
        const alertHTML = generateAlertHTML(state, componentId);
        preview.innerHTML = alertHTML;
        
        console.log('✅ Alert preview actualizado:', {
          type: state.type,
          message: state.message,
          closable: state.closable
        });
      };
      
      // Función unificada para controles del Alert
      window.setAlertControl = function(option, value, componentId) {
        const state = initAlertPreviewState(componentId);
        
        if (option === 'type') {
          state.type = value;
          // Actualizar mensaje según tipo
          state.message = alertMessages[value] || state.message;
          // Actualizar botones activos de tipo
          document.querySelectorAll(`[data-component="${componentId}"][data-option="type"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          // Actualizar input de mensaje
          const messageInput = document.getElementById(`alert-message-input-${componentId}`);
          if (messageInput) messageInput.value = state.message;
        } else if (option === 'message') {
          state.message = value || alertMessages[state.type];
          const input = document.getElementById(`alert-message-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'closable') {
          state.closable = value;
          const toggle = document.getElementById(`alert-closable-toggle-${componentId}`);
          if (toggle) toggle.checked = value;
        }
        
        // Actualizar preview
        updateAlertPreview(componentId);
      };
      
      // Inicializar preview de Alert cuando se carga el componente
      function initializeAlertPreview(componentId) {
        setTimeout(() => {
          const preview = document.getElementById(`alert-preview-${componentId}`);
          if (preview && preview.innerHTML.trim() === '') {
            updateAlertPreview(componentId);
          }
        }, 100);
        
        // Observer para cuando el preview se vuelve visible
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              updateAlertPreview(componentId);
              observer.unobserve(entry.target);
            }
          });
        }, { threshold: 0.1 });
        
        setTimeout(() => {
          const preview = document.getElementById(`alert-preview-${componentId}`);
          if (preview) observer.observe(preview);
        }, 200);
      }
      
      // ========================================
      // TOAST PREVIEW FUNCTIONS
      // ========================================
      
      // Mensajes por defecto por tipo (con texto largo de ejemplo)
      const toastTitles = {
        success: 'Operación completada',
        info: 'Información',
        warning: 'Advertencia',
        error: 'Error'
      };

      const toastMessages = {
        success: 'Los cambios se han guardado correctamente. Este ejemplo de texto es más largo para demostrar cómo funciona el espaciado y el botón de acción debajo del texto.',
        info: 'Esta es una notificación informativa del sistema. Este mensaje contiene varias líneas de texto para mostrar cómo el botón de acción se posiciona correctamente en la parte inferior derecha del contenido.',
        warning: 'Por favor, revisa los datos antes de continuar. Este mensaje de advertencia es más extenso para demostrar la disposición del componente con múltiples líneas de texto y el botón de acción debajo.',
        error: 'Ha ocurrido un error al procesar la solicitud. Este mensaje de error contiene texto adicional para mostrar cómo el botón de acción se alinea correctamente cuando hay contenido largo en el toast.'
      };
      
      // Estado del preview del Toast
      const toastPreviewState = {};
      
      // Inicializar estado del Toast
      function initToastPreviewState(componentId) {
        if (!toastPreviewState[componentId]) {
          toastPreviewState[componentId] = {
            action: false // Botón de acción desactivado por defecto
          };
        }
        return toastPreviewState[componentId];
      }
      
      // Función para manejar controles del Toast
      window.setToastControl = function(option, value, componentId) {
        const state = initToastPreviewState(componentId);
        
        if (option === 'action') {
          state.action = value;
          const toggle = document.getElementById(`toast-action-toggle-${componentId}`);
          const statusSpan = document.getElementById(`toast-action-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
      };
      
      // Asegurar que el container existe (declarar primero)
      function ensureToastContainer() {
        let container = document.getElementById('ubits-toast-container');
        if (!container) {
          container = document.createElement('div');
          container.id = 'ubits-toast-container';
          // Aplicar estilos inline como respaldo
          container.style.cssText = `
            position: fixed !important;
            top: 16px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            gap: 12px !important;
            width: 100% !important;
            max-width: 560px !important;
            min-width: 320px !important;
            padding: 0 16px !important;
            box-sizing: border-box !important;
            z-index: 10000 !important;
            pointer-events: none !important;
          `;
          document.body.appendChild(container);
          console.log('✅ Container de toast creado:', container);
        } else {
          console.log('✅ Container de toast ya existe:', container);
        }
        return container;
      }
      
      // Función simple para renderizar toast (para preview en playground)
      function renderToastSimple(type, message, options = {}) {
        const container = ensureToastContainer();
        const noClose = options.noClose || false;
        const action = options.action; // Puede ser un objeto {label, onClick} o false/undefined
        const title = options.title || ''; // Título opcional
        
        console.log('🔔 Mostrando toast:', { type, title, message, container: container.id, action });
        
        const iconMap = {
          success: 'fa-check-circle',
          info: 'fa-info-circle',
          warning: 'fa-exclamation-triangle',
          error: 'fa-times-circle'
        };
        
        const iconClass = iconMap[type] || iconMap.info;
        const role = (type === 'warning' || type === 'error') ? 'alert' : 'status';
        const ariaLive = (type === 'warning' || type === 'error') ? 'assertive' : 'polite';
        
        // Colores por variante (respaldo si los tokens no cargan)
        const variantColors = {
          success: { bg: '#f0fdf4', color: '#166534', border: '#16a34a' },
          info: { bg: '#eff6ff', color: '#1e40af', border: '#3b82f6' },
          warning: { bg: '#fffbeb', color: '#854d0e', border: '#f59e0b' },
          error: { bg: '#fef2f2', color: '#991b1b', border: '#ef4444' }
        };
        
        const colors = variantColors[type] || variantColors.info;
        
        const toast = document.createElement('div');
        toast.className = `ubits-toast ubits-toast--${type}`;
        toast.setAttribute('role', role);
        toast.setAttribute('aria-live', ariaLive);
        
        // Asegurar que el toast sea visible con estilos inline como respaldo
        toast.style.cssText = `
          display: flex !important;
          gap: 8px !important;
          align-items: flex-start !important;
          padding: 16px !important;
          border-radius: 10px !important;
          position: relative !important;
          width: 100% !important;
          max-width: 560px !important;
          min-width: 320px !important;
          z-index: 10001 !important;
          pointer-events: auto !important;
          opacity: 1 !important;
          transform: translateY(0) !important;
          background-color: ${colors.bg} !important;
          color: ${colors.color} !important;
          border: 1px solid ${colors.border} !important;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
        `;
        
        // Header con icono, título y botón cerrar alineados
        const headerHTML = `
          <div class="ubits-toast__header" style="display: flex; align-items: center; width: 100%; gap: 8px;">
            <div class="ubits-toast__icon" style="flex-shrink: 0; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-size: 18px; line-height: 1;">
              <i class="far ${iconClass}"></i>
            </div>
            <div class="ubits-toast__title" style="font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); font-weight: var(--weight-bold); color: inherit; flex: 1; min-width: 0;">${title || ''}</div>
            ${!noClose ? `
              <button class="ubits-button ubits-button--tertiary ubits-button--sm ubits-toast__close" aria-label="Cerrar notificación" style="padding: 0 10px; color: ${colors.border};" onclick="this.closest('.ubits-toast').classList.add('ubits-toast--exit'); setTimeout(() => this.closest('.ubits-toast')?.remove(), 180);">
                <i class="far fa-times"></i>
              </button>
            ` : ''}
          </div>
        `;
        
        // Botón de acción opcional
        const hasAction = action && typeof action === 'object' && action.label;
        const actionButtonHTML = hasAction ? `
          <div class="ubits-toast__actions" style="display: flex; justify-content: flex-end; align-items: center; width: 100%; margin-top: 4px;">
            <button class="ubits-toast__action ubits-toast__action--${type}" type="button" data-toast-action style="display: inline-flex; align-items: center; justify-content: center; height: 32px; min-height: 32px; padding: 10px 14px; border: none; border-radius: 6px; font-family: var(--font-sans); font-size: var(--font-body-sm-size); font-weight: var(--weight-semibold); line-height: var(--font-body-sm-line); cursor: pointer; color: white; background-color: ${colors.border}; box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);">
              <span>${action.label}</span>
            </button>
          </div>
        ` : '';
        
        toast.innerHTML = `
          <div class="ubits-toast__content" style="display: flex; flex-direction: column; gap: 2px; align-items: flex-start; min-width: 0; flex: 1;">
            ${headerHTML}
            <div class="ubits-toast__body" style="font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); font-weight: var(--weight-regular); color: inherit; width: 100%; word-wrap: break-word;">${message}</div>
            ${actionButtonHTML}
          </div>
        `;
        
        // Agregar event listener al botón de acción si existe
        if (hasAction && action.onClick) {
          const actionBtn = toast.querySelector('[data-toast-action]');
          if (actionBtn) {
            actionBtn.addEventListener('click', (e) => {
              e.stopPropagation();
              action.onClick();
            });
          }
        }
        
        container.appendChild(toast);
        
        console.log('✅ Toast agregado al DOM:', {
          container: container.id,
          toast: toast.className,
          containerChildren: container.children.length
        });
        
        // Animación de entrada
        requestAnimationFrame(() => {
          toast.classList.add('ubits-toast--enter');
          console.log('✅ Animación de entrada aplicada');
        });
        
        // Auto-cierre
        const duration = options.duration || (type === 'success' || type === 'info' ? 3500 : type === 'warning' ? 5000 : 6500);
        if (duration > 0) {
          setTimeout(() => {
            toast.classList.add('ubits-toast--exit');
            setTimeout(() => toast.remove(), 180);
          }, duration);
        }
        
        // Limitar apilado (máximo 3)
        const toasts = container.querySelectorAll('.ubits-toast');
        if (toasts.length > 3) {
          const oldest = toasts[0];
          oldest.classList.add('ubits-toast--exit');
          setTimeout(() => oldest.remove(), 180);
        }
        
        return toast;
      }
      
      // Exponer showToast globalmente
      window.showToast = function(type, message, options = {}) {
        return renderToastSimple(type, message, options);
      };
      
      // Función para mostrar toast preview
      window.showToastPreview = function(type, componentId) {
        console.log('🎯 showToastPreview llamado:', { type, componentId });
        
        const state = initToastPreviewState(componentId);
        const messageInput = document.getElementById(`toast-message-input-${componentId}`);
        const message = messageInput ? messageInput.value || toastMessages[type] : toastMessages[type];
        const title = toastTitles[type] || '';
        
        console.log('📝 Título y mensaje obtenidos:', { title, message });
        
        // Actualizar botones activos
        document.querySelectorAll(`[data-component="${componentId}"][data-option="type"]`).forEach(btn => {
          btn.classList.toggle('active', btn.getAttribute('data-value') === type);
        });
        
        // Verificar que showToast existe
        if (typeof window.showToast !== 'function') {
          console.error('❌ window.showToast no está disponible');
          alert('Error: La función showToast no está disponible. Por favor, recarga la página.');
          return;
        }
        
        console.log('✅ Llamando a showToast...');
        
        // Mostrar toast con botón de acción si está activado
        try {
          const toastOptions = {
            title: title,
            duration: type === 'success' || type === 'info' ? 3500 : type === 'warning' ? 5000 : 6500,
            pauseOnHover: true
          };
          
          // Agregar botón de acción si está activado
          if (state.action) {
            toastOptions.action = {
              label: 'Action',
              onClick: () => {
                alert(`Acción ejecutada: ${type}`);
              }
            };
          }
          
          const toast = window.showToast(type, message, toastOptions);
          
          if (!toast) {
            console.error('❌ showToast no devolvió un elemento toast');
          } else {
            console.log('✅ Toast creado:', toast);
          }
        } catch (error) {
          console.error('❌ Error al mostrar toast:', error);
          alert('Error al mostrar toast: ' + error.message);
        }
      };
      
      // Función para establecer mensaje del toast
      window.setToastMessage = function(message, componentId) {
        // El mensaje se usará la próxima vez que se muestre un toast
        console.log('📝 Mensaje de toast actualizado:', message);
      };
      
      // Inicializar container cuando se carga la página
      ensureToastContainer();
      
      // ========================================
      // INPUT PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Input
      const inputPreviewState = {};
      
      // Inicializar estado por componente
      function initInputPreviewState(componentId) {
        if (!inputPreviewState[componentId]) {
          inputPreviewState[componentId] = {
            label: 'Label',
            showLabel: true,
            mandatory: false,
            mandatoryType: 'opcional',
            helperText: 'Helper text',
            showHelper: true,
            showCounter: true,
            maxLength: 50,
            leftIcon: 'user',
            rightIcon: 'check',
            size: 'md',
            state: 'default',
            type: 'text',
            placeholder: 'Placeholder text'
          };
        }
        return inputPreviewState[componentId];
      }
      
      // Función para renderizar Input (versión simplificada para playground)
      function renderInputSimple(state, componentId) {
        const {
          label,
          showLabel,
          mandatory,
          mandatoryType,
          helperText,
          showHelper,
          showCounter,
          maxLength,
          leftIcon,
          rightIcon,
          size,
          state: inputState,
          type,
          placeholder
        } = state;
        
        // Calcular padding según iconos y tamaño
        const hasLeftIcon = leftIcon && leftIcon.trim() !== '';
        const hasRightIcon = rightIcon && rightIcon.trim() !== '';
        
        // Padding base sin iconos
        const paddingBaseMap = {
          xs: { left: '8px', right: '8px' },
          sm: { left: '10px', right: '10px' },
          md: { left: '12px', right: '12px' },
          lg: { left: '16px', right: '16px' }
        };
        
        // Padding con iconos (icono 12px desde el borde + 8px espacio + 12px icono = 32px+)
        const paddingWithIconMap = {
          xs: { left: '32px', right: '32px' },
          sm: { left: '36px', right: '36px' },
          md: { left: '40px', right: '40px' },
          lg: { left: '44px', right: '44px' }
        };
        
        let paddingLeft = hasLeftIcon ? paddingWithIconMap[size].left : paddingBaseMap[size].left;
        let paddingRight = hasRightIcon ? paddingWithIconMap[size].right : paddingBaseMap[size].right;
        
        // Clases CSS
        const inputClasses = ['ubits-input', `ubits-input--${size}`];
        if (inputState !== 'default') {
          inputClasses.push(`ubits-input--${inputState}`);
        }
        
        // Altura según tamaño
        const heightMap = { xs: '28px', sm: '32px', md: '40px', lg: '48px' };
        const fontSizeMap = { xs: 'var(--font-body-xs-size)', sm: 'var(--font-body-sm-size)', md: 'var(--font-body-md-size)', lg: 'var(--font-body-lg-size)' };
        
        let inputHTML = '';
        
        // Label
        if (showLabel && label) {
          const mandatoryText = mandatory ? ` <span class="ubits-input-mandatory">(${mandatoryType})</span>` : '';
          inputHTML += `<label class="ubits-input-label">${label}${mandatoryText}</label>`;
        }
        
        // Input wrapper
        inputHTML += `<div style="position: relative; display: inline-block; width: 100%;">`;
        
        // Icono izquierdo (solo para tipos que permiten icono personalizado)
        // Search, autocomplete, email, tel, url tienen su propio icono automático
        if (hasLeftIcon && type !== 'search' && type !== 'autocomplete' && type !== 'email' && type !== 'tel' && type !== 'url') {
          const leftIconClass = leftIcon.startsWith('fa-') ? `far ${leftIcon}` : `far fa-${leftIcon}`;
          // Ajustar posición del icono según el tamaño
          const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="${leftIconClass}" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1; width: 14px; text-align: center;"></i>`;
        }
        
        // Input según tipo
        const disabledAttr = inputState === 'disabled' ? ' disabled' : '';
        const maxLengthAttr = showCounter ? ` maxlength="${maxLength}"` : '';
        
        if (type === 'textarea') {
          let textareaStyle = `width: 100%; min-height: 80px; resize: vertical; font-family: var(--font-sans); font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            textareaStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<textarea class="${inputClasses.join(' ')}" style="${textareaStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}></textarea>`;
        } else if (type === 'select') {
          // Select siempre tiene icono chevron a la derecha
          const selectPaddingRight = paddingWithIconMap[size].right;
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="select" style="width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${selectPaddingRight} !important; cursor: pointer;" value="" readonly placeholder="${placeholder}">`;
          // Forzar rightIcon a chevron
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-chevron-down" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
        } else if (type === 'password') {
          const passwordPaddingRight = hasRightIcon ? paddingRight : paddingWithIconMap[size].right;
          let passwordStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${passwordPaddingRight} !important;`;
          if (inputState === 'disabled') {
            passwordStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="password" class="${inputClasses.join(' ')}" data-input-type="password" style="${passwordStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de ojo automático (siempre presente en password)
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-eye ubits-password-toggle" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: auto; cursor: pointer; z-index: 1;"></i>`;
        } else if (type === 'search') {
          const searchPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          const searchPaddingRight = hasRightIcon ? paddingRight : paddingWithIconMap[size].right;
          let searchStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${searchPaddingLeft} !important; padding-right: ${searchPaddingRight} !important;`;
          if (inputState === 'disabled') {
            searchStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="search" style="${searchStyle}" placeholder="${placeholder}" autocomplete="off"${disabledAttr}${maxLengthAttr}>`;
          // Iconos automáticos para search
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-search" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-times ubits-search-clear" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: auto; cursor: pointer; z-index: 1; display: none;"></i>`;
        } else if (type === 'calendar') {
          // Calendar siempre tiene icono de calendario a la derecha
          const calendarPaddingRight = paddingWithIconMap[size].right;
          let calendarStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${calendarPaddingRight} !important; cursor: pointer;`;
          if (inputState === 'disabled') {
            calendarStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="calendar" style="${calendarStyle}" placeholder="${placeholder}" value="" readonly${disabledAttr}>`;
          // Icono de calendario automático
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-calendar" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
        } else if (type === 'email') {
          // Email: siempre tiene icono de email a la izquierda
          const emailPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          let emailStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${emailPaddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            emailStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="email" class="${inputClasses.join(' ')}" data-input-type="email" style="${emailStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de email automático si no hay icono personalizado
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-envelope" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
        } else if (type === 'tel') {
          // Tel: siempre tiene icono de teléfono a la izquierda
          const telPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          let telStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${telPaddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            telStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="tel" class="${inputClasses.join(' ')}" data-input-type="tel" style="${telStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de teléfono automático si no hay icono personalizado
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-phone" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
        } else if (type === 'url') {
          // URL: siempre tiene icono de link a la izquierda
          const urlPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          let urlStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${urlPaddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            urlStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="url" class="${inputClasses.join(' ')}" data-input-type="url" style="${urlStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de link automático si no hay icono personalizado
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-link" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
        } else if (type === 'autocomplete') {
          // Autocomplete: siempre tiene icono de búsqueda a la izquierda y clear a la derecha
          const autocompletePaddingLeft = paddingWithIconMap[size].left;
          const autocompletePaddingRight = paddingWithIconMap[size].right;
          let autocompleteStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${autocompletePaddingLeft} !important; padding-right: ${autocompletePaddingRight} !important;`;
          if (inputState === 'disabled') {
            autocompleteStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="autocomplete" style="${autocompleteStyle}" placeholder="${placeholder}" autocomplete="off"${disabledAttr}${maxLengthAttr}>`;
          // Icono de búsqueda automático a la izquierda
          const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-search" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          // Icono X para borrar a la derecha
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-times ubits-input-clear" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: auto; cursor: pointer; z-index: 1; display: none;"></i>`;
        } else {
          // Input normal (text, number)
          let inputStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            inputStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="${type}" class="${inputClasses.join(' ')}" data-input-type="${type}" style="${inputStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
        }
        
        // Icono derecho (si no se agregó automáticamente)
        // No agregar icono derecho personalizado si el tipo ya tiene su icono automático
        if (hasRightIcon && !(type === 'password' || type === 'search' || type === 'autocomplete' || type === 'select' || type === 'calendar')) {
          const rightIconClass = rightIcon.startsWith('fa-') ? `far ${rightIcon}` : `far fa-${rightIcon}`;
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="${rightIconClass}" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1; width: 14px; text-align: center;"></i>`;
        }
        
        // Icono izquierdo personalizado (no se agrega si el tipo tiene icono automático)
        if (hasLeftIcon && !(type === 'search' || type === 'autocomplete')) {
          // Ya se agregó arriba, no hacer nada
        }
        
        inputHTML += '</div>';
        
        // Helper text y counter
        if (showHelper || showCounter) {
          inputHTML += '<div class="ubits-input-helper">';
          if (showHelper && helperText) {
            inputHTML += `<span>${helperText}</span>`;
          }
          if (showCounter) {
            inputHTML += `<span class="ubits-input-counter">0/${maxLength}</span>`;
          }
          inputHTML += '</div>';
        }
        
        return inputHTML;
      }
      
      // Función para actualizar el preview del Input
      window.updateInputPreview = function(componentId) {
        const state = initInputPreviewState(componentId);
        const preview = document.getElementById(`input-preview-${componentId}`);
        
        if (!preview) {
          console.error('❌ Preview no encontrado:', `input-preview-${componentId}`);
          return;
        }
        
        const inputHTML = renderInputSimple(state, componentId);
        preview.innerHTML = inputHTML;
        
        // Obtener elementos del DOM
        const wrapper = preview.querySelector('div[style*="position: relative"]');
        const inputElement = preview.querySelector('.ubits-input');
        const counterElement = preview.querySelector('.ubits-input-counter');
        
        if (!inputElement || !wrapper) {
          console.error('❌ No se pudo encontrar input o wrapper');
          return;
        }
        
        // Asegurar que el wrapper tenga position relative para los dropdowns
        if (wrapper && getComputedStyle(wrapper).position !== 'relative') {
          wrapper.style.position = 'relative';
        }
        
        // Inicializar funcionalidades específicas según el tipo
        const inputType = inputElement.getAttribute('data-input-type') || state.type;
        
        // Password toggle
        if (inputType === 'password' && inputElement instanceof HTMLInputElement) {
          const toggleIcon = preview.querySelector('.ubits-password-toggle');
          if (toggleIcon) {
            let isPasswordVisible = false;
            toggleIcon.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              isPasswordVisible = !isPasswordVisible;
              inputElement.type = isPasswordVisible ? 'text' : 'password';
              toggleIcon.className = isPasswordVisible ? 'far fa-eye-slash ubits-password-toggle' : 'far fa-eye ubits-password-toggle';
              toggleIcon.setAttribute('style', toggleIcon.getAttribute('style') || '');
            });
          }
        }
        
        // Search clear
        if (inputType === 'search' && inputElement instanceof HTMLInputElement) {
          const clearIcon = preview.querySelector('.ubits-search-clear');
          if (clearIcon) {
            const toggleClearIcon = () => {
              clearIcon.style.display = inputElement.value.length > 0 ? 'block' : 'none';
            };
            inputElement.addEventListener('input', toggleClearIcon);
            clearIcon.addEventListener('click', (e) => {
              e.preventDefault();
              inputElement.value = '';
              inputElement.focus();
              toggleClearIcon();
            });
            toggleClearIcon();
          }
        }
        
        // Autocomplete dropdown - usando componente List
        if (inputType === 'autocomplete' && inputElement instanceof HTMLInputElement) {
          const clearIcon = preview.querySelector('.ubits-input-clear');
          if (clearIcon) {
            const toggleClearIcon = () => {
              clearIcon.style.display = inputElement.value.length > 0 ? 'block' : 'none';
            };
            inputElement.addEventListener('input', toggleClearIcon);
            clearIcon.addEventListener('click', (e) => {
              e.preventDefault();
              inputElement.value = '';
              inputElement.focus();
              toggleClearIcon();
              const listContainer = preview.querySelector('.ubits-autocomplete-list-container');
              if (listContainer) listContainer.style.display = 'none';
            });
            toggleClearIcon();
          }
          
          // Crear contenedor para el List
          const listContainer = document.createElement('div');
          listContainer.className = 'ubits-autocomplete-list-container';
          listContainer.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1000;
            margin-top: 4px;
            display: none;
          `;
          wrapper.appendChild(listContainer);
          
          // Opciones de ejemplo para autocomplete (lista más realista)
          const autocompleteOptions = [
            { value: 'apple', text: 'Manzana' },
            { value: 'banana', text: 'Banana' },
            { value: 'orange', text: 'Naranja' },
            { value: 'grape', text: 'Uva' },
            { value: 'strawberry', text: 'Fresa' },
            { value: 'watermelon', text: 'Sandía' },
            { value: 'pineapple', text: 'Piña' },
            { value: 'mango', text: 'Mango' },
            { value: 'kiwi', text: 'Kiwi' },
            { value: 'peach', text: 'Durazno' },
            { value: 'cherry', text: 'Cereza' },
            { value: 'blueberry', text: 'Arándano' },
            { value: 'papaya', text: 'Papaya' },
            { value: 'coconut', text: 'Coco' },
            { value: 'avocado', text: 'Aguacate' }
          ];
          
          // Obtener el tamaño del List basado en el tamaño del Input
          const listSize = state.size === 'xs' ? 'xs' : state.size === 'sm' ? 'sm' : state.size === 'md' ? 'md' : 'lg';
          
          // Función para actualizar el dropdown
          const updateDropdown = (showAll = false) => {
            const searchText = inputElement.value.toLowerCase();
            
            let filtered;
            if (showAll || searchText.length < 1) {
              // Mostrar todas las opciones cuando se activa el input o no hay texto
              filtered = autocompleteOptions.slice(0, 8);
            } else {
              // Filtrar según el texto ingresado
              filtered = autocompleteOptions
                .filter(opt => opt.text.toLowerCase().includes(searchText))
                .slice(0, 8);
            }
            
            if (filtered.length === 0) {
              listContainer.style.display = 'none';
              return;
            }
            
            // Convertir opciones a items de List
            const listItems = filtered.map(option => ({
              label: option.text,
              state: 'default',
              value: option.value,
              selected: false
            }));
            
            // Generar HTML del List manualmente
            const listId = `ubits-autocomplete-list-${wrapper.id || 'default'}`;
            listContainer.id = listId;
            listContainer.innerHTML = '';
            
            let listHTML = `<div class="ubits-list" role="list" style="max-height: 200px;">`;
            listItems.forEach((item) => {
              let label = item.label;
              // Resaltar texto buscado
              if (searchText.length > 0) {
                const regex = new RegExp(`(${searchText})`, 'gi');
                label = item.label.replace(regex, '<strong>$1</strong>');
              }
              listHTML += `
                <div class="ubits-list-item ubits-list-item--${listSize}" role="listitem" tabindex="0" data-value="${item.value}">
                  ${label}
                </div>
              `;
            });
            listHTML += '</div>';
            
            listContainer.innerHTML = listHTML;
            
            // Agregar event listeners a los items
            const listItemsElements = listContainer.querySelectorAll('.ubits-list-item');
            listItemsElements.forEach((itemEl, idx) => {
              const item = listItems[idx];
              if (item) {
                itemEl.addEventListener('click', () => {
                  inputElement.value = item.label;
                  listContainer.style.display = 'none';
                  if (clearIcon) clearIcon.style.display = 'block';
                });
              }
            });
            
            listContainer.style.display = 'block';
          };
          
          // Mostrar dropdown al activar el input (focus)
          inputElement.addEventListener('focus', () => {
            updateDropdown(true);
          });
          
          // Actualizar dropdown mientras se escribe
          inputElement.addEventListener('input', () => {
            updateDropdown(false);
          });
          
          // Ocultar dropdown al desactivar el input (blur)
          inputElement.addEventListener('blur', () => {
            setTimeout(() => listContainer.style.display = 'none', 150);
          });
        }
        
        // Select dropdown - usando componente List
        if (inputType === 'select' && inputElement instanceof HTMLInputElement) {
          // Crear contenedor para el List
          const listContainer = document.createElement('div');
          listContainer.className = 'ubits-select-list-container';
          listContainer.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1000;
            margin-top: 4px;
            display: none;
          `;
          wrapper.appendChild(listContainer);
          
          // Opciones de ejemplo para select
          const selectOptions = Array.from({length: 20}, (_, i) => ({
            value: `opt-${i + 1}`,
            text: `Opción ${i + 1}`
          }));
          
          // Obtener el tamaño del List basado en el tamaño del Input
          const listSize = state.size === 'xs' ? 'xs' : state.size === 'sm' ? 'sm' : state.size === 'md' ? 'md' : 'lg';
          
          const itemsPerPage = 50; // Más items ya que List tiene scroll
          let currentPage = 0;
          let allLoadedItems = [];
          let isLoading = false;
          
          const loadOptions = (page = 0) => {
            if (isLoading) return;
            isLoading = true;
            
            setTimeout(() => {
              const startIndex = page * itemsPerPage;
              const endIndex = Math.min(startIndex + itemsPerPage, selectOptions.length);
              const pageOptions = selectOptions.slice(startIndex, endIndex);
              
              // Convertir opciones a items de List
              const newItems = pageOptions.map(option => ({
                label: option.text,
                state: 'default',
                value: option.value,
                selected: false
              }));
              
              // Si es la primera página, reemplazar todos los items
              if (page === 0) {
                allLoadedItems = newItems;
              } else {
                // Agregar items nuevos
                allLoadedItems = allLoadedItems.concat(newItems);
              }
              
              // Crear la lista usando renderListSimple del componente List
              const listId = `ubits-select-list-${wrapper.id || 'default'}`;
              listContainer.id = listId;
              listContainer.innerHTML = '';
              
              // Generar HTML del List manualmente (sin usar createList para evitar dependencias)
              let listHTML = `<div class="ubits-list" role="list" style="max-height: 200px;">`;
              allLoadedItems.forEach((item) => {
                listHTML += `
                  <div class="ubits-list-item ubits-list-item--${listSize}" role="listitem" tabindex="0" data-value="${item.value}">
                    ${item.label}
                  </div>
                `;
              });
              listHTML += '</div>';
              
              listContainer.innerHTML = listHTML;
              
              // Agregar event listeners a los items
              const listItems = listContainer.querySelectorAll('.ubits-list-item');
              listItems.forEach((itemEl, idx) => {
                const item = allLoadedItems[idx];
                if (item) {
                  itemEl.addEventListener('click', () => {
                    inputElement.value = item.label;
                    listContainer.style.display = 'none';
                  });
                }
              });
              
              // Scroll infinito: cargar más items cuando se acerque al final
              if (endIndex < selectOptions.length) {
                const listElement = listContainer.querySelector('.ubits-list');
                if (listElement) {
                  const observer = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting && !isLoading && endIndex < selectOptions.length) {
                      currentPage++;
                      loadOptions(currentPage);
                    }
                  }, { root: listElement, rootMargin: '50px' });
                  
                  // Observar el último item
                  const lastItem = listContainer.querySelector('.ubits-list-item:last-child');
                  if (lastItem) {
                    observer.observe(lastItem);
                  }
                }
              }
              
              isLoading = false;
            }, 150);
          };
          
          inputElement.addEventListener('click', () => {
            const isVisible = listContainer.style.display === 'block';
            if (!isVisible) {
              currentPage = 0;
              allLoadedItems = [];
              loadOptions(0);
              listContainer.style.display = 'block';
            } else {
              listContainer.style.display = 'none';
            }
          });
          
          document.addEventListener('click', (e) => {
            if (!wrapper.contains(e.target)) {
              listContainer.style.display = 'none';
            }
          });
        }
        
        // Calendar picker
        if (inputType === 'calendar' && inputElement instanceof HTMLInputElement) {
          const calendar = document.createElement('div');
          calendar.className = 'ubits-calendar-picker';
          wrapper.appendChild(calendar);
          
          let currentDate = new Date();
          let selectedDate = null;
          
          const formatDate = (date) => {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
          };
          
          const renderCalendar = () => {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            const dayNames = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            let calendarHTML = `
              <div class="ubits-calendar-header">
                <button class="ubits-calendar-prev" type="button"><i class="far fa-chevron-left"></i></button>
                <div class="ubits-calendar-selectors">
                  <select class="ubits-calendar-month-select">
                    ${monthNames.map((name, index) => `<option value="${index}" ${index === month ? 'selected' : ''}>${name}</option>`).join('')}
                  </select>
                  <select class="ubits-calendar-year-select">
                    ${Array.from({length: 100}, (_, i) => {
                      const yearOption = currentDate.getFullYear() - 50 + i;
                      return `<option value="${yearOption}" ${yearOption === year ? 'selected' : ''}>${yearOption}</option>`;
                    }).join('')}
                  </select>
                </div>
                <button class="ubits-calendar-next" type="button"><i class="far fa-chevron-right"></i></button>
              </div>
              <div class="ubits-calendar-weekdays">
                ${dayNames.map(day => `<div class="ubits-calendar-weekday">${day}</div>`).join('')}
              </div>
              <div class="ubits-calendar-days">
            `;
            
            for (let i = 0; i < startingDay; i++) {
              calendarHTML += '<div class="ubits-calendar-day ubits-calendar-day--empty"></div>';
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
              const date = new Date(year, month, day);
              const isToday = date.toDateString() === new Date().toDateString();
              const isSelected = selectedDate && date.toDateString() === selectedDate.toDateString();
              
              let dayClass = 'ubits-calendar-day';
              if (isToday) dayClass += ' ubits-calendar-day--today';
              if (isSelected) dayClass += ' ubits-calendar-day--selected';
              
              calendarHTML += `<div class="${dayClass}" data-date="${formatDate(date)}">${day}</div>`;
            }
            
            calendarHTML += '</div>';
            calendar.innerHTML = calendarHTML;
            
            // Event listeners
            const prevBtn = calendar.querySelector('.ubits-calendar-prev');
            const nextBtn = calendar.querySelector('.ubits-calendar-next');
            const monthSelect = calendar.querySelector('.ubits-calendar-month-select');
            const yearSelect = calendar.querySelector('.ubits-calendar-year-select');
            
            if (prevBtn) {
              prevBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
              });
            }
            
            if (nextBtn) {
              nextBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
              });
            }
            
            if (monthSelect) {
              monthSelect.addEventListener('change', (e) => {
                const target = e.target || e.currentTarget;
                currentDate.setMonth(parseInt(target.value || '0'));
                renderCalendar();
              });
            }
            
            if (yearSelect) {
              yearSelect.addEventListener('change', (e) => {
                const target = e.target || e.currentTarget;
                currentDate.setFullYear(parseInt(target.value || '0'));
                renderCalendar();
              });
            }
            
            calendar.querySelectorAll('.ubits-calendar-day:not(.ubits-calendar-day--empty)').forEach(dayEl => {
              dayEl.addEventListener('click', () => {
                const dateStr = dayEl.dataset.date || '';
                const [day, month, year] = dateStr.split('/');
                selectedDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
                inputElement.value = dateStr;
                calendar.style.display = 'none';
              });
            });
          };
          
          inputElement.addEventListener('click', () => {
            if (calendar.style.display === 'none' || !calendar.style.display) {
              calendar.style.display = 'block';
              renderCalendar();
            } else {
              calendar.style.display = 'none';
            }
          });
          
          document.addEventListener('click', (e) => {
            if (!wrapper.contains(e.target)) {
              calendar.style.display = 'none';
            }
          });
        }
        
        // Validación para teléfono (solo números)
        if (inputType === 'tel' && inputElement instanceof HTMLInputElement) {
          inputElement.addEventListener('input', (e) => {
            // Eliminar cualquier carácter que no sea número
            const target = e.target || e.currentTarget;
            const value = target.value.replace(/[^0-9]/g, '');
            if (target.value !== value) {
              target.value = value;
            }
          });
          
          // Prevenir pegado de texto no numérico
          inputElement.addEventListener('paste', (e) => {
            e.preventDefault();
            const paste = (e.clipboardData || window.clipboardData).getData('text');
            const numericPaste = paste.replace(/[^0-9]/g, '');
            inputElement.value = numericPaste;
          });
        }
        
        // Agregar event listener para actualizar contador si existe
        if (inputElement && counterElement && state.showCounter) {
          const updateCounter = () => {
            const length = inputElement.value.length;
            counterElement.textContent = `${length}/${state.maxLength}`;
            if (length >= state.maxLength) {
              counterElement.classList.add('ubits-input-counter--limit');
            } else {
              counterElement.classList.remove('ubits-input-counter--limit');
            }
          };
          inputElement.addEventListener('input', updateCounter);
          updateCounter();
        }
        
        console.log('✅ Preview de Input actualizado:', state);
      };
      
      // ========================================
      // LIST PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const listPreviewState = {};
      
      function initListPreviewState(componentId) {
        if (!listPreviewState[componentId]) {
          listPreviewState[componentId] = {
            size: 'md',
            item1State: 'default',
            item2State: 'active',
            item3State: 'disabled',
            item4State: 'default',
            maxHeight: '400px'
          };
        }
        return listPreviewState[componentId];
      }
      
      // Función para renderizar List (versión simplificada para playground)
      function renderListSimple(state, componentId) {
        const { size, item1State, item2State, item3State, item4State, maxHeight } = state;
        
        const items = [
          { label: 'Label', state: item1State },
          { label: 'Label', state: item2State },
          { label: 'Label', state: item3State },
          { label: 'Label', state: item4State }
        ];
        
        let listHTML = `<div class="ubits-list" role="list" style="max-height: ${maxHeight};">`;
        
        items.forEach((item, index) => {
          const itemState = item.state || 'default';
          const itemClasses = [
            'ubits-list-item',
            `ubits-list-item--${size}`,
            itemState !== 'default' ? `ubits-list-item--${itemState}` : ''
          ].filter(Boolean).join(' ');
          
          const itemAttrs = [];
          if (itemState === 'active') {
            itemAttrs.push('aria-selected="true"');
          }
          if (itemState === 'disabled') {
            itemAttrs.push('aria-disabled="true"');
          } else {
            itemAttrs.push('tabindex="0"');
          }
          
          listHTML += `
            <div class="${itemClasses}" role="listitem" ${itemAttrs.join(' ')}>
              ${item.label}
            </div>
          `;
        });
        
        listHTML += '</div>';
        return listHTML;
      }
      
      // Función para actualizar el preview del List
      window.updateListPreview = function(componentId) {
        const state = initListPreviewState(componentId);
        const preview = document.getElementById(`list-preview-${componentId}`);
        
        if (!preview) {
          console.error('❌ Preview no encontrado:', `list-preview-${componentId}`);
          return;
        }
        
        const listHTML = renderListSimple(state, componentId);
        preview.innerHTML = listHTML;
        
        console.log('✅ Preview de List actualizado:', state);
      };
      
      // Función para manejar controles del List
      window.setListControl = function(option, value, componentId) {
        const state = initListPreviewState(componentId);
        
        // Actualizar estado según la opción
        if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`list-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item1State') {
          state.item1State = value;
          const select = document.getElementById(`list-item1-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item2State') {
          state.item2State = value;
          const select = document.getElementById(`list-item2-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item3State') {
          state.item3State = value;
          const select = document.getElementById(`list-item3-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item4State') {
          state.item4State = value;
          const select = document.getElementById(`list-item4-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'maxHeight') {
          state.maxHeight = value;
          const input = document.getElementById(`list-maxheight-input-${componentId}`);
          if (input) input.value = value;
        }
        
        // Actualizar preview
        window.updateListPreview(componentId);
      };
      
      // Función para manejar controles del Input
      window.setInputControl = function(option, value, componentId) {
        const state = initInputPreviewState(componentId);
        
        // Actualizar estado según la opción
        if (option === 'label') {
          state.label = value;
          const input = document.getElementById(`input-label-input-${componentId}`);
          if (input) input.value = value;
        } else if (option === 'showLabel') {
          state.showLabel = value;
          const toggle = document.getElementById(`input-label-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-label-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'mandatory') {
          state.mandatory = value;
          const toggle = document.getElementById(`input-mandatory-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-mandatory-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'mandatoryType') {
          state.mandatoryType = value;
          const select = document.getElementById(`input-mandatory-type-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'helperText') {
          state.helperText = value;
          const input = document.getElementById(`input-helper-input-${componentId}`);
          if (input) input.value = value;
        } else if (option === 'showHelper') {
          state.showHelper = value;
          const toggle = document.getElementById(`input-helper-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-helper-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showCounter') {
          state.showCounter = value;
          const toggle = document.getElementById(`input-counter-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-counter-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'maxLength') {
          state.maxLength = parseInt(value) || 50;
          const input = document.getElementById(`input-maxlength-input-${componentId}`);
          if (input) input.value = state.maxLength;
        } else if (option === 'leftIcon') {
          state.leftIcon = value;
          const input = document.getElementById(`input-lefticon-input-${componentId}`);
          const toggle = document.getElementById(`input-lefticon-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
          if (toggle) {
            toggle.checked = value !== '';
            if (input) input.value = value || 'user';
          }
          if (statusSpan) {
            statusSpan.textContent = value !== '' ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'rightIcon') {
          state.rightIcon = value;
          const input = document.getElementById(`input-righticon-input-${componentId}`);
          const toggle = document.getElementById(`input-righticon-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-righticon-status-${componentId}`);
          if (toggle) {
            toggle.checked = value !== '';
            if (input) input.value = value || 'check';
          }
          if (statusSpan) {
            statusSpan.textContent = value !== '' ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`input-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'state') {
          state.state = value;
          const select = document.getElementById(`input-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'type') {
          state.type = value;
          const select = document.getElementById(`input-type-select-${componentId}`);
          if (select) {
            select.value = value;
            console.log('✅ Tipo cambiado a:', value);
          }
          
          // Ajustar controles según el tipo
          const leftIconToggle = document.getElementById(`input-lefticon-toggle-${componentId}`);
          const rightIconToggle = document.getElementById(`input-righticon-toggle-${componentId}`);
          const leftIconInput = document.getElementById(`input-lefticon-input-${componentId}`);
          const rightIconInput = document.getElementById(`input-righticon-input-${componentId}`);
          
          // Tipos que tienen iconos automáticos fijos
          if (value === 'password') {
            // Password: siempre tiene icono de ojo a la derecha, no se puede cambiar
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
            if (leftIconToggle) leftIconToggle.disabled = false;
          } else if (value === 'search') {
            // Search: siempre tiene icono de búsqueda a la izquierda y clear a la derecha
            if (leftIconToggle) {
              leftIconToggle.checked = false;
              leftIconToggle.disabled = true;
              const leftStatusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
              if (leftStatusSpan) leftStatusSpan.textContent = 'Desactivado';
            }
            if (leftIconInput) leftIconInput.value = '';
            state.leftIcon = ''; // Limpiar estado
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
          } else if (value === 'autocomplete') {
            // Autocomplete: siempre tiene icono de búsqueda a la izquierda y clear a la derecha
            if (leftIconToggle) {
              leftIconToggle.checked = false;
              leftIconToggle.disabled = true;
              const leftStatusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
              if (leftStatusSpan) leftStatusSpan.textContent = 'Desactivado';
            }
            if (leftIconInput) leftIconInput.value = '';
            state.leftIcon = ''; // Limpiar estado
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
          } else if (value === 'select') {
            // Select: siempre tiene chevron a la derecha, no se puede cambiar
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
            if (leftIconToggle) leftIconToggle.disabled = false;
          } else if (value === 'calendar') {
            // Calendar: siempre tiene icono de calendario a la derecha, no se puede cambiar
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
            if (leftIconToggle) leftIconToggle.disabled = false;
          } else if (value === 'email' || value === 'tel' || value === 'url') {
            // Email, Tel, URL: siempre tienen icono a la izquierda, no se puede cambiar
            if (leftIconToggle) {
              leftIconToggle.checked = false;
              leftIconToggle.disabled = true;
              const leftStatusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
              if (leftStatusSpan) leftStatusSpan.textContent = 'Desactivado';
            }
            if (leftIconInput) leftIconInput.value = '';
            state.leftIcon = ''; // Limpiar estado
            if (rightIconToggle) rightIconToggle.disabled = false;
          } else {
            // Otros tipos: permitir cambiar iconos libremente
            if (leftIconToggle) leftIconToggle.disabled = false;
            if (rightIconToggle) rightIconToggle.disabled = false;
          }
          
          // Actualizar preview inmediatamente cuando cambia el tipo
          updateInputPreview(componentId);
          return; // Return early ya que updateInputPreview se llama aquí
        } else if (option === 'placeholder') {
          state.placeholder = value;
          const input = document.getElementById(`input-placeholder-input-${componentId}`);
          const toggle = document.getElementById(`input-placeholder-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-placeholder-status-${componentId}`);
          if (toggle) {
            toggle.checked = value !== '';
            if (input) input.value = value || 'Placeholder text';
          }
          if (statusSpan) {
            statusSpan.textContent = value !== '' ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        updateInputPreview(componentId);
      };
      
      // Estilos para switches y botones de control
      const style = document.createElement('style');
      style.textContent = `
        .preview-control-btn.active {
          background: var(--ubits-accent-brand) !important;
          color: white !important;
          border-color: var(--ubits-accent-brand) !important;
        }
        .preview-control-btn.active span {
          color: white !important;
        }
        .switch input:checked + .slider {
          background-color: var(--ubits-accent-brand) !important;
        }
        .switch input:checked + .slider span {
          transform: translateX(20px) !important;
        }
      `;
      document.head.appendChild(style);
      
      // Inicializar preview del Button cuando se renderice o cuando se active la sección
      function initializeButtonPreview() {
        console.log('🚀 initializeButtonPreview llamado');
        const buttonPreview = document.getElementById('button-preview-button');
        
        if (buttonPreview) {
          const hasContent = buttonPreview.innerHTML.trim() !== '' && buttonPreview.querySelector('.ubits-button');
          console.log('📋 Preview estado:', { exists: true, hasContent });
          
          if (!hasContent) {
            console.log('🔄 Inicializando preview de Button...');
            if (typeof window.updateButtonPreview === 'function') {
              window.updateButtonPreview('button');
            } else {
              console.error('❌ window.updateButtonPreview no está disponible');
            }
          } else {
            console.log('✅ Preview ya tiene contenido');
          }
        } else {
          console.warn('⚠️ button-preview-button no encontrado');
        }
      }
      
      // Intentar inicializar múltiples veces para asegurar que funcione
      setTimeout(initializeButtonPreview, 100);
      setTimeout(initializeButtonPreview, 500);
      setTimeout(initializeButtonPreview, 1000);
      
      // También verificar cuando se rendericen los componentes
      const checkButtonInterval = setInterval(() => {
        const buttonPreview = document.getElementById('button-preview-button');
        const componentButton = document.getElementById('component-button');
        
        if (componentButton && buttonPreview && buttonPreview.innerHTML.trim() === '') {
          console.log('🔄 Detectado componente Button sin preview, inicializando...');
          initializeButtonPreview();
          clearInterval(checkButtonInterval);
        }
      }, 500);
      
      // Limpiar después de 10 segundos
      setTimeout(() => {
        clearInterval(checkButtonInterval);
        console.log('⏱️ Interval de verificación de Button finalizado');
      }, 10000);
      
      // Observador de intersección para detectar cuando Button es visible
      const buttonObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const buttonPreview = document.getElementById('button-preview-button');
            if (buttonPreview && buttonPreview.innerHTML.trim() === '') {
              console.log('👁️ Componente Button visible en viewport, inicializando preview...');
              setTimeout(() => {
                initializeButtonPreview();
              }, 200);
            }
          }
        });
      }, { threshold: 0.1 });
      
      // Observar el componente Button cuando se renderice
      setTimeout(() => {
        const buttonComponent = document.getElementById('component-button');
        if (buttonComponent) {
          buttonObserver.observe(buttonComponent);
          console.log('👁️ Observador de visibilidad activado para Button');
        }
      }, 1000);
      
      // También inicializar cuando se hace scroll
      let scrollTimeout;
      const scrollHandler = () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
          const buttonPreview = document.getElementById('button-preview-button');
          const buttonComponent = document.getElementById('component-button');
          
          if (buttonComponent && buttonPreview && buttonPreview.innerHTML.trim() === '') {
            const rect = buttonComponent.getBoundingClientRect();
            if (rect.top < window.innerHeight && rect.bottom > 0) {
              console.log('👁️ Componente Button visible en scroll, inicializando preview...');
              initializeButtonPreview();
            }
          }
        }, 100);
      };
      window.addEventListener('scroll', scrollHandler, { passive: true });
      
      // ========================================
      // SIDEBAR PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const sidebarPreviewState = {};
      
      // Configuraciones de botones para cada variante
      const defaultBodyButtons = [
        { section: 'admin', icon: 'fa-laptop', tooltip: 'Administrador', state: 'default' },
        { section: 'aprendizaje', icon: 'fa-graduation-cap', tooltip: 'Aprendizaje', state: 'default' },
        { section: 'diagnóstico', icon: 'fa-chart-mixed', tooltip: 'Diagnóstico', state: 'default' },
        { section: 'desempeño', icon: 'fa-bars-progress', tooltip: 'Desempeño', state: 'default' },
        { section: 'encuestas', icon: 'fa-clipboard', tooltip: 'Encuestas', state: 'default' },
        { section: 'reclutamiento', icon: 'fa-users', tooltip: 'Reclutamiento', state: 'default' },
        { section: 'tareas', icon: 'fa-layer-group', tooltip: 'Tareas', state: 'default' },
        { section: 'ubits-ai', icon: 'fa-sparkles', tooltip: 'UBITS AI', state: 'default' }
      ];
      
      const adminBodyButtons = [
        { section: 'inicio', icon: 'fa-house', tooltip: 'Inicio', state: 'default' },
        { section: 'empresa', icon: 'fa-building', tooltip: 'Empresa', state: 'default' },
        { section: 'aprendizaje', icon: 'fa-graduation-cap', tooltip: 'Aprendizaje', state: 'default' },
        { section: 'diagnóstico', icon: 'fa-chart-mixed', tooltip: 'Diagnóstico', state: 'default' },
        { section: 'desempeño', icon: 'fa-bars-progress', tooltip: 'Desempeño', state: 'default' },
        { section: 'encuestas', icon: 'fa-clipboard', tooltip: 'Encuestas', state: 'default' }
      ];
      
      const adminFooterButtons = [
        { section: 'api', icon: 'fa-code', tooltip: 'API', id: 'api-button', state: 'default' },
        { section: 'centro-de-ayuda', icon: 'fa-circle-question', tooltip: 'Centro de ayuda', id: 'help-center-button', state: 'default' }
      ];
      
      const defaultProfileMenuItems = [
        { icon: 'fa-user', label: 'Ver mi perfil', divider: false },
        { divider: true },
        { icon: 'fa-laptop', label: 'Modo Administrador', divider: false },
        { divider: true },
        { icon: 'fa-key', label: 'Cambio de contraseña', divider: false },
        { icon: 'fa-sign-out', label: 'Cerrar sesión', divider: false }
      ];
      
      const adminProfileMenuItems = [
        { icon: 'fa-user', label: 'Ver mi perfil', divider: false },
        { divider: true },
        { icon: 'fa-user-gear', label: 'Modo colaborador', divider: false },
        { divider: true },
        { icon: 'fa-key', label: 'Cambio de contraseña', divider: false },
        { icon: 'fa-sign-out', label: 'Cerrar sesión', divider: false }
      ];
      
      function initSidebarPreviewState(componentId) {
        if (!sidebarPreviewState[componentId]) {
          sidebarPreviewState[componentId] = {
            variant: 'default',
            activeButton: ''
          };
        }
        return sidebarPreviewState[componentId];
      }
      
      // Función para actualizar el preview del Sidebar
      window.updateSidebarPreview = function(componentId) {
        const state = initSidebarPreviewState(componentId);
        const preview = document.getElementById(`sidebar-preview-${componentId}`);
        
        if (!preview) {
          console.error('❌ Preview de Sidebar no encontrado:', `sidebar-preview-${componentId}`);
          return;
        }
        
        console.log('🔄 Actualizando preview de Sidebar:', state);
        
        // Limpiar preview anterior
        preview.innerHTML = '';
        
        // Obtener botones según la variante
        let bodyButtons = state.variant === 'admin' ? JSON.parse(JSON.stringify(adminBodyButtons)) : JSON.parse(JSON.stringify(defaultBodyButtons));
        let footerButtons = state.variant === 'admin' ? JSON.parse(JSON.stringify(adminFooterButtons)) : [];
        const profileMenuItems = state.variant === 'admin' ? adminProfileMenuItems : defaultProfileMenuItems;
        
        // Marcar botón activo
        if (state.activeButton) {
          bodyButtons.forEach(btn => {
            if (btn.section === state.activeButton) {
              btn.state = 'active';
            } else {
              btn.state = 'default';
            }
          });
        }
        
        // Renderizar directamente HTML estático (siempre usar este método en playground)
        renderSidebarStatic(preview, state, bodyButtons, footerButtons, profileMenuItems);
        
        console.log('✅ Preview de Sidebar actualizado:', state);
      };
      
      // Función para renderizar Sidebar estático (fallback)
      function renderSidebarStatic(container, state, bodyButtons, footerButtons, profileMenuItems) {
        const variant = state.variant || 'default';
        
        console.log('🎨 Renderizando Sidebar estático:', {
          variant,
          bodyButtonsCount: bodyButtons.length,
          footerButtonsCount: footerButtons.length,
          activeButton: state.activeButton
        });
        
        // Helper para renderizar iconos
        function renderIcon(iconName) {
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          return `<i class="far ${name}"></i>`;
        }
        
        let sidebarHTML = `
          <aside class="ubits-sidebar" style="position: relative !important; width: 96px !important; height: 650px !important; top: 0 !important; left: 0 !important; margin: 0 !important;">
            <div class="ubits-sidebar-main">
              <div class="ubits-sidebar-header">
                <div class="ubits-sidebar-logo">
                  <img src="../../../../template-ubits/images/Ubits-logo.svg" alt="UBITS Logo" style="width: 24px; height: 25px;" />
                </div>
              </div>
              <div class="ubits-sidebar-body">
                ${bodyButtons.map(btn => `
                  <button 
                    class="ubits-sidebar-nav-button ${btn.state === 'active' ? 'active' : ''}" 
                    data-section="${btn.section}" 
                    data-tooltip="${btn.tooltip}">
                    ${renderIcon(btn.icon)}
                  </button>
                `).join('')}
              </div>
            </div>
            <div class="ubits-sidebar-footer">
              ${footerButtons.map(btn => `
                <button 
                  class="ubits-sidebar-nav-button" 
                  ${btn.id ? `id="ubits-${btn.id}"` : ''}
                  data-section="${btn.section}" 
                  data-tooltip="${btn.tooltip}">
                  ${renderIcon(btn.icon)}
                </button>
              `).join('')}
              <button class="ubits-sidebar-nav-button" id="ubits-darkmode-toggle" data-tooltip="Modo oscuro" data-theme="light">
                ${renderIcon('fa-moon')}
              </button>
              <div class="ubits-sidebar-user-avatar-container">
                <div class="ubits-sidebar-user-avatar">
                  <img src="../../../../template-ubits/images/Profile-image.jpg" alt="Usuario" class="ubits-sidebar-avatar-image" />
                </div>
              </div>
            </div>
          </aside>
          <div class="ubits-sidebar-profile-menu" id="ubits-sidebar-profile-menu">
            ${profileMenuItems.map(item => {
              if (item.divider) {
                return '<div class="ubits-sidebar-profile-menu-divider"></div>';
              }
              return `
                <div class="ubits-sidebar-profile-menu-item">
                  ${renderIcon(item.icon)}
                  <span>${item.label}</span>
                </div>
              `;
            }).join('')}
          </div>
        `;
        
        // Insertar HTML directamente en el contenedor
        container.innerHTML = sidebarHTML;
        
        const sidebarElement = container.querySelector('.ubits-sidebar');
        
        // Inicializar tooltips básicos
        if (sidebarElement) {
          console.log('✅ Sidebar renderizado, inicializando tooltips...');
          initSidebarTooltipsBasic(sidebarElement);
          
          // Inicializar menú de perfil
          initSidebarProfileMenuBasic(container, sidebarElement);
        } else {
          console.error('❌ No se encontró el elemento .ubits-sidebar después de renderizar');
        }
      }
      
      // Función básica para inicializar menú de perfil
      function initSidebarProfileMenuBasic(container, sidebarElement) {
        const avatarElement = sidebarElement.querySelector('.ubits-sidebar-user-avatar');
        const menuElement = container.querySelector('.ubits-sidebar-profile-menu');
        
        if (!avatarElement || !menuElement) return;
        
        let showTimeout = null;
        let hideTimeout = null;
        
        const showMenu = () => {
          if (hideTimeout) {
            clearTimeout(hideTimeout);
            hideTimeout = null;
          }
          if (showTimeout) clearTimeout(showTimeout);
          showTimeout = window.setTimeout(() => {
            menuElement.classList.add('show');
          }, 100);
        };
        
        const hideMenu = () => {
          if (showTimeout) {
            clearTimeout(showTimeout);
            showTimeout = null;
          }
          hideTimeout = window.setTimeout(() => {
            menuElement.classList.remove('show');
          }, 200);
        };
        
        avatarElement.addEventListener('mouseenter', showMenu);
        avatarElement.addEventListener('mouseleave', hideMenu);
        menuElement.addEventListener('mouseenter', showMenu);
        menuElement.addEventListener('mouseleave', hideMenu);
      }
      
      // Función básica para inicializar tooltips
      function initSidebarTooltipsBasic(sidebarElement) {
        if (!sidebarElement) return;
        
        const tooltip = document.getElementById('ubits-sidebar-tooltip') || (() => {
          const tt = document.createElement('div');
          tt.className = 'ubits-sidebar-tooltip';
          tt.id = 'ubits-sidebar-tooltip';
          document.body.appendChild(tt);
          return tt;
        })();
        
        const buttons = sidebarElement.querySelectorAll('[data-tooltip]');
        buttons.forEach(button => {
          button.addEventListener('mouseenter', (e) => {
            const rect = e.target.getBoundingClientRect();
            tooltip.textContent = e.target.getAttribute('data-tooltip');
            tooltip.classList.add('show');
            tooltip.style.left = `${rect.right + 12}px`;
            tooltip.style.top = `${rect.top + (rect.height / 2) - (tooltip.offsetHeight / 2)}px`;
          });
          
          button.addEventListener('mouseleave', () => {
            tooltip.classList.remove('show');
          });
        });
      }
      
      // Función unificada para controles del Sidebar
      window.setSidebarControl = function(option, value, componentId) {
        const state = initSidebarPreviewState(componentId);
        
        if (option === 'variant') {
          state.variant = value;
          state.activeButton = ''; // Resetear botón activo al cambiar variante
          
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          
          // Mostrar/ocultar selects de botón activo según variante
          const defaultSelect = document.getElementById(`sidebar-active-default-${componentId}`);
          const adminSelect = document.getElementById(`sidebar-active-admin-${componentId}`);
          if (defaultSelect) defaultSelect.style.display = value === 'default' ? 'flex' : 'none';
          if (adminSelect) adminSelect.style.display = value === 'admin' ? 'flex' : 'none';
        } else if (option === 'activeButton') {
          state.activeButton = value || '';
          
          // Actualizar selects
          const variant = state.variant;
          const selectDefault = document.getElementById(`sidebar-active-button-default-${componentId}`);
          const selectAdmin = document.getElementById(`sidebar-active-button-admin-${componentId}`);
          if (selectDefault && variant === 'default') selectDefault.value = value || '';
          if (selectAdmin && variant === 'admin') selectAdmin.value = value || '';
        }
        
        // Actualizar preview
        updateSidebarPreview(componentId);
      };
      
      // Helper global para createSidebar (wrapper para usar en el preview)
      window.createSidebarHelper = function(options) {
        // Intentar importar dinámicamente si es posible
        if (typeof window.UBITS !== 'undefined' && window.UBITS.Sidebar && window.UBITS.Sidebar.createSidebar) {
          return window.UBITS.Sidebar.createSidebar(options);
        }
        // Si no está disponible, usar el fallback estático
        return null;
      };
      
      // ========================================
      // BADGE PREVIEW INITIALIZATION
      // ========================================
      
      function initializeBadgePreview() {
        console.log('🚀 initializeBadgePreview llamado');
        const badgePreview = document.getElementById('badge-preview-badge');
        
        if (badgePreview) {
          const hasContent = badgePreview.innerHTML.trim() !== '' && badgePreview.querySelector('.ubits-badge');
          console.log('📋 Badge Preview estado:', { exists: true, hasContent });
          
          if (!hasContent && typeof window.updateBadgePreview === 'function') {
            console.log('✅ Inicializando preview de Badge...');
            window.updateBadgePreview('badge');
          }
        } else {
          console.log('⚠️ badge-preview-badge no encontrado aún');
        }
      }
      
      // Inicializar Badge preview cuando el componente esté visible
      setTimeout(initializeBadgePreview, 100);
      setTimeout(initializeBadgePreview, 500);
      
      // Verificar cuando se rendericen los componentes
      const checkBadgeInterval = setInterval(() => {
        const badgePreview = document.getElementById('badge-preview-badge');
        const componentBadge = document.getElementById('component-badge');
        
        if (badgePreview && componentBadge && componentBadge.offsetHeight > 0) {
          initializeBadgePreview();
          clearInterval(checkBadgeInterval);
        }
      }, 500);
      
      // Limpiar después de 10 segundos
      setTimeout(() => clearInterval(checkBadgeInterval), 10000);
      
      // Usar IntersectionObserver para Badge
      if (typeof IntersectionObserver !== 'undefined') {
        const badgeObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              setTimeout(() => {
                initializeBadgePreview();
              }, 200);
            }
          });
        }, { threshold: 0.1 });
        
        const badgeComponent = document.getElementById('component-badge');
        if (badgeComponent) {
          badgeObserver.observe(badgeComponent);
          console.log('👁️ Observador de visibilidad activado para Badge');
        }
      }
      
      // ========================================
      // LIST PREVIEW INITIALIZATION
      // ========================================
      
      function initializeListPreview() {
        console.log('🚀 initializeListPreview llamado');
        const listPreview = document.getElementById('list-preview-list');
        
        if (listPreview) {
          const hasContent = listPreview.innerHTML.trim() !== '' && listPreview.querySelector('.ubits-list');
          console.log('📋 List Preview estado:', { exists: true, hasContent });
          
          if (!hasContent && typeof window.updateListPreview === 'function') {
            console.log('✅ Inicializando preview de List...');
            window.updateListPreview('list');
          }
        } else {
          console.log('⚠️ list-preview-list no encontrado aún');
        }
      }
      
      // Inicializar List preview cuando el componente esté visible
      setTimeout(initializeListPreview, 100);
      setTimeout(initializeListPreview, 500);
      
      // Verificar cuando se rendericen los componentes
      const checkListInterval = setInterval(() => {
        const listPreview = document.getElementById('list-preview-list');
        const componentList = document.getElementById('component-list');
        
        if (listPreview && componentList && componentList.offsetHeight > 0) {
          initializeListPreview();
          clearInterval(checkListInterval);
        }
      }, 500);
      
      // Limpiar después de 10 segundos
      setTimeout(() => clearInterval(checkListInterval), 10000);
      
      // Usar IntersectionObserver para List
      if (typeof IntersectionObserver !== 'undefined') {
        const listObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              setTimeout(() => {
                initializeListPreview();
              }, 200);
            }
          });
        }, { threshold: 0.1 });
        
        const listComponent = document.getElementById('component-list');
        if (listComponent) {
          listObserver.observe(listComponent);
          console.log('👁️ Observador de visibilidad activado para List');
        }
      }
    </script>
  </body>
</html>
